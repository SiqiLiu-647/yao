=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fd3c280fd10,layerfrac=0x7fd3c280f490,
 layerspeed=0x7fd3c280fd98,layeralt=0x7fd3c30d8278,winddir=0x7fd3c30d7ec0,
 _layeralt=0x7fd3c280ffb8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=2,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fd3c30eee70,
 lgs_prof_alt=0x7fd3c30eedc8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=1,_svipc_subok=0x7fd3c303f898,_fork_subs=0x7fd3c1e2ed50,
 _fork_subs2=0x7fd3c1e31fb0,_validsubs=0x7fd3c281a528,_origpixsize=0.2,
 _rebinfactor=6,_gsalt=0,_gsdepth=0,_nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,
 _nsind=0x0,_cxdef=0x0,_sxdef=0x0,_tiltsh=0x103442030,_masks=0x0,_fluxpersub=
 0x7fd3c303f370,_rayleighflux=0x0,_sodiumflux=0x0,_raylfluxpersub=
 0x7fd3c303f478,_skyfluxpersub=0x7fd3c303f160,_nphotons=70721.4,_skynphotons=0,
 _tt=[0.00126719,-0.000856056],_lastvalidtt=[0.00126719,-0.000856056],
 _upttcommand=[0,0],_refmes=0x7fd3c1c422f0,_tiprefv=0x7fd3c1c43230,_tiltrefv=
 0x7fd3c1d0bad0,_tiprefvn=0x7fd3c1c43470,_tiltrefvn=0x7fd3c1d0bd10,_reordervec=
 0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,_istart=0x7fd3c2819ce8,
 _jstart=0x7fd3c2819ef8,_binindices=0x7fd3c286dc30,_binxy=10,_centroidw=
 0x7fd3c30d7f48,_fimage=0x7fd3c21b2e30,_fimage2=0x0,_imistart=0x7fd3c303f580,
 _imjstart=0x7fd3c303ee48,_imistart2=0x7fd3c28193a0,_imjstart2=0x7fd3c303ed40,
 _unittip=0x7fd3c20a2a30,_unittilt=0x7fd3c214d430,_lgs_defocuses=0x7fd3c30f19b8,
 _unitdefocus=0x1040a6030,_fimnx=60,_fimny=60,_fimny2=0x7fd3c31796d8,_yoffset=
 0x7fd3c3179940,_bias=0x7fd3c313d830,_flat=0x7fd3c31a1630,_domask=1,_submask=
 0x7fd3c284e030,_kernel=0x7fd3c2140230,_kernels=0x103fe2030,_kerfftr=
 0x103792030,_kerffti=0x103692030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fd3c21bea30,_x=0x7fd3c1d03e90,_y=0x7fd3c1d0b890,_centroidgain=1,_rayleigh=
 0x7fd3c30f1980,_bckgrdcalib=0x7fd3c31a5030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fd3c31799b0,_ctrlden=0x7fd3c3172ae0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fd3c303f790,_xlast=0x7fd3c303f268,_ylast=[0x7fd3c1e34d40,0x7fd3c1e34d40,
 0x7fd3c1e34d40],_y0=0x7fd3c1e2a830,_signus=0x7fd3c1e34fa0,_puppixoffset=[0,0],
 _nact=45,_def=0x10f33e030,_x=0x7fd3c281a000,_y=0x7fd3c303f688,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x103914030,_ex=0x7fd3c30eefc0,_ey=0x7fd3c3179898,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7fd3c2818c68,_flat_command=0x0,_extrapcmat=
 0x7fd3c315f430,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7fd3c30f1b78,_ctrlden=0x7fd3c30f1b08,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7fd3c30eeee0,_xlast=0x7fd3c3172b18,_ylast=
 [0x7fd3c30d88d8,0x7fd3c30d88d8,0x7fd3c30d88d8],_y0=0x7fd3c30d8f38,_signus=
 0x7fd3c30ef030,_puppixoffset=[0,0],_nact=2,_def=0x103e17030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fd3c30f1910,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fd3c30ee9a0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fd3c30eeff8,xposition=0x7fd3c30f1868,yposition=
 0x7fd3c30f1cc8,dispzoom=0x7fd3c30d28d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d10,layerfrac=0x7f8a15870c88,
 layerspeed=0x7f8a15870d98,layeralt=0x7f8a158df2e0,winddir=0x7f8a158df0c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14012e88,
 lgs_prof_alt=0x7f8a14845660,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956990,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cddc030,_masks=0x0,_fluxpersub=0x7f8a1595f3b0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15956258,_skyfluxpersub=0x7f8a15956780,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000734853,-0.000802187],_lastvalidtt=
 [0.000734853,-0.000802187],_upttcommand=[0,0],_refmes=0x7f8a13c0fe60,_tiprefv=
 0x7f8a13c13870,_tiltrefv=0x7f8a13c14060,_tiprefvn=0x7f8a13c142a0,_tiltrefvn=
 0x7f8a13c144e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a14810908,_jstart=0x7f8a1595ff08,_binindices=0x7f8a15995030,
 _binxy=10,_centroidw=0x7f8a158df3f0,_fimage=0x7f8a15a11c30,_fimage2=0x0,
 _imistart=0x7f8a1595f8d8,_imjstart=0x7f8a15955f40,_imistart2=0x7f8a15956468,
 _imjstart2=0x7f8a15084bf0,_unittip=0x7f8a15981430,_unittilt=0x7f8a15976030,
 _lgs_defocuses=0x7f8a14845548,_unitdefocus=0x10da3d030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a1501ee30,_flat=0x7f8a140d3c30,_domask=1,
 _submask=0x7f8a15010830,_kernel=0x7f8a15a0e230,_kernels=0x10cb39030,_kerfftr=
 0x10d9af030,_kerffti=0x10dad1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a1598de30,_x=0x7f8a13f54fd0,_y=0x7f8a13f55940,_centroidgain=1,_rayleigh=
 0x7f8a148454a0,_bckgrdcalib=0x7f8a14108e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a148455f0,_ctrlden=0x7f8a14013588,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15956048,_xlast=0x7f8a1595fbf0,_ylast=[0x7f8a13d0cca0,0x7f8a13d0cca0,
 0x7f8a13d0cca0],_y0=0x7f8a13d0d6f0,_signus=0x7f8a13d0cf00,_puppixoffset=[0,0],
 _nact=45,_def=0x10fe1f030,_x=0x7f8a15960220,_y=0x7f8a15960118,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d45c030,_ex=0x7f8a140131d0,_ey=0x7f8a148454d8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a1595fae8,_flat_command=0x0,_extrapcmat=
 0x7f8a1403ac30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a148459a8,_ctrlden=0x7f8a158d3af8,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a14845580,_xlast=0x7f8a14013550,_ylast=
 [0x7f8a158c9d28,0x7f8a158c9d28,0x7f8a158c9d28],_y0=0x7f8a158e01c0,_signus=
 0x7f8a140134a8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a158f6c80,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a158d9c60,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158de180,xposition=0x7f8a14845858,yposition=
 0x7f8a158d3b68,dispzoom=0x7f8a14013320,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870c88,layerfrac=0x7f8a15870d98,
 layerspeed=0x7f8a15870d10,layeralt=0x7f8a158df3f0,winddir=0x7f8a158e01c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a140131d0,
 lgs_prof_alt=0x7f8a148454d8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a14810908,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a1595f7d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cd9b030,_masks=0x0,_fluxpersub=0x7f8a1595fae8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15960118,_skyfluxpersub=0x7f8a15960220,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00111353,-0.00089309],_lastvalidtt=
 [0.00111353,-0.00089309],_upttcommand=[0,0],_refmes=0x7f8a13e04e60,_tiprefv=
 0x7f8a13f549c0,_tiltrefv=0x7f8a13d0cca0,_tiprefvn=0x7f8a13f55e10,_tiltrefvn=
 0x7f8a13d0cee0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a1595f8d8,_jstart=0x7f8a1595ff08,_binindices=0x7f8a159f3630,
 _binxy=10,_centroidw=0x7f8a158e08a8,_fimage=0x7f8a159f7030,_fimage2=0x0,
 _imistart=0x7f8a1595f1a0,_imjstart=0x7f8a1595f3b0,_imistart2=0x7f8a15956990,
 _imjstart2=0x7f8a15956678,_unittip=0x7f8a14034430,_unittilt=0x7f8a14061830,
 _lgs_defocuses=0x7f8a14845468,_unitdefocus=0x10d675030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a148a4a30,_flat=0x7f8a1487c630,_domask=1,
 _submask=0x7f8a148a1030,_kernel=0x7f8a159faa30,_kernels=0x10d8c2030,_kerfftr=
 0x10dad1030,_kerffti=0x10ceb4030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a1597a030,_x=0x7f8a13c11540,_y=0x7f8a13c11800,_centroidgain=1,_rayleigh=
 0x7f8a148455b8,_bckgrdcalib=0x7f8a14880030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845698,_ctrlden=0x7f8a158d9b10,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595ea68,_xlast=0x7f8a15956048,_ylast=[0x7f8a13c13160,0x7f8a13c13160,
 0x7f8a13c13160],_y0=0x7f8a13c12570,_signus=0x7f8a13c133c0,_puppixoffset=[0,0],
 _nact=45,_def=0x10fe1f030,_x=0x7f8a15960328,_y=0x7f8a1595fbf0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x118f62030,_ex=0x7f8a148456d0,_ey=0x7f8a158d3a88,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15960010,_flat_command=0x0,_extrapcmat=
 0x7f8a14890a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14012fd8,_ctrlden=0x7f8a14845740,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a140132e8,_xlast=0x7f8a148459a8,_ylast=
 [0x7f8a158dfb60,0x7f8a158dfb60,0x7f8a158dfb60],_y0=0x7f8a158dfe08,_signus=
 0x7f8a158d9bb8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a158f6d60,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14013550,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158d3af8,xposition=0x7f8a14845580,yposition=
 0x7f8a14013518,dispzoom=0x7f8a140134a8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d10,layerfrac=0x7f8a15870c88,
 layerspeed=0x7f8a15870d98,layeralt=0x7f8a158df148,winddir=0x7f8a158e01c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a158d9bb8,
 lgs_prof_alt=0x7f8a140132e8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a1595f8d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956048,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d4b1030,_masks=0x0,_fluxpersub=0x7f8a15956258,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15956990,_skyfluxpersub=0x7f8a1595f3b0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000479749,-0.000697791],_lastvalidtt=
 [0.000479749,-0.000697791],_upttcommand=[0,0],_refmes=0x7f8a13c12b60,_tiprefv=
 0x7f8a13c16e60,_tiltrefv=0x7f8a13f561a0,_tiprefvn=0x7f8a13c13160,_tiltrefvn=
 0x7f8a13f563e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15956678,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a15979830,
 _binxy=10,_centroidw=0x7f8a158dfe08,_fimage=0x7f8a15998a30,_fimage2=0x0,
 _imistart=0x7f8a1595ff08,_imjstart=0x7f8a15956fc0,_imistart2=0x7f8a159570c8,
 _imjstart2=0x7f8a1595ea68,_unittip=0x7f8a15980230,_unittilt=0x7f8a1592c430,
 _lgs_defocuses=0x7f8a14013518,_unitdefocus=0x10d7b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a140dae30,_flat=0x7f8a140bdc30,_domask=1,
 _submask=0x7f8a140fde30,_kernel=0x7f8a15995030,_kernels=0x10d666030,_kerfftr=
 0x10dad1030,_kerffti=0x10d863030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a140e2230,_x=0x7f8a13f55b40,_y=0x7f8a13f54e70,_centroidgain=1,_rayleigh=
 0x7f8a148457b0,_bckgrdcalib=0x7f8a140d3c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845660,_ctrlden=0x7f8a14012fd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15960220,_xlast=0x7f8a15960118,_ylast=[0x7f8a13c169c0,0x7f8a13c169c0,
 0x7f8a13c169c0],_y0=0x7f8a13c16760,_signus=0x7f8a13c16c20,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a1595fae8,_y=0x7f8a1595f1a0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a14012f30,_ey=0x7f8a14012e88,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15956468,_flat_command=0x0,_extrapcmat=
 0x7f8a1403ac30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14093990,_ctrlden=0x7f8a14093958,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a148454a0,_xlast=0x7f8a158d9c60,_ylast=
 [0x7f8a158e03e0,0x7f8a158e03e0,0x7f8a158e03e0],_y0=0x7f8a158e04f0,_signus=
 0x7f8a14013588,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14845b30,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14012ef8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158d9b10,xposition=0x7f8a148455f0,yposition=
 0x7f8a14845628,dispzoom=0x7f8a148456d0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868e28,layerfrac=0x7ffb4c868c08,
 layerspeed=0x7ffb4c8689e8,layeralt=0x7ffb4c868c90,winddir=0x7ffb4c869158,
 _layeralt=0x7ffb4c868fc0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0cf508,
 lgs_prof_alt=0x7ffb4c0cf578,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84b108,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c01fb80,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c9b4030,_masks=0x0,_fluxpersub=0x7ffb4c155438,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c155540,_skyfluxpersub=0x7ffb4c155648,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000807999,-0.000672297],_lastvalidtt=
 [0.000807999,-0.000672297],_upttcommand=[0,0],_refmes=0x7ffb4bc3e0a0,_tiprefv=
 0x7ffb4bc42480,_tiltrefv=0x7ffb4bd1f9a0,_tiprefvn=0x7ffb4bc426c0,_tiltrefvn=
 0x7ffb4bd1fbe0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c84aef8,_jstart=0x7ffb4c84b000,_binindices=0x7ffb4c1be830,
 _binxy=10,_centroidw=0x7ffb4c869400,_fimage=0x7ffb4c14e030,_fimage2=0x0,
 _imistart=0x7ffb4c155d80,_imjstart=0x7ffb4c84b420,_imistart2=0x7ffb4c84b528,
 _imjstart2=0x7ffb4c84b630,_unittip=0x7ffb4c82d430,_unittilt=0x7ffb4c86ec30,
 _lgs_defocuses=0x7ffb4c0cfe38,_unitdefocus=0x10d271030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c17fa30,_flat=0x7ffb4c174c30,_domask=1,
 _submask=0x7ffb4c17c030,_kernel=0x7ffb4c178630,_kernels=0x10d371030,_kerfftr=
 0x10ccac030,_kerffti=0x10c871030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c13fc30,_x=0x7ffb4bc42a60,_y=0x7ffb4bc42bc0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cfe70,_bckgrdcalib=0x7ffb4c125430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c0cfa10,_ctrlden=0x7ffb4c0cff88,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c155960,_xlast=0x7ffb4c155a68,_ylast=[0x7ffb4bd1ec90,0x7ffb4bd1ec90,
 0x7ffb4bd1ec90],_y0=0x7ffb4bd1f470,_signus=0x7ffb4bd1eef0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b210,_y=0x7ffb4c155750,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10dc7c030,_ex=0x7ffb4c0cfa80,_ey=0x7ffb4c0cfce8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c155b70,_flat_command=0x0,_extrapcmat=
 0x7ffb4d842a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4d847878,_ctrlden=0x7ffb4c0cf3f0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cfc40,_xlast=0x7ffb4c0cf658,_ylast=
 [0x7ffb4c869b70,0x7ffb4c869b70,0x7ffb4c869b70],_y0=0x7ffb4c0d13d0,_signus=
 0x7ffb4c0cf8c0,_puppixoffset=[0,0],_nact=2,_def=0x10da9d030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cfcb0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cf540,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c89d2f8,xposition=0x7ffb4c0cf380,yposition=
 0x7ffb4c89d368,dispzoom=0x7ffb4c0cf690,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870c88,layerfrac=0x7f8a15870d98,
 layerspeed=0x7f8a15870d10,layeralt=0x7f8a158dfe08,winddir=0x7f8a158e04f0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14012f30,
 lgs_prof_alt=0x7f8a14012e88,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15084bf0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d12f030,_masks=0x0,_fluxpersub=0x7f8a15956468,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a1595f1a0,_skyfluxpersub=0x7f8a1595fae8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000708901,-0.000301518],_lastvalidtt=
 [0.000708901,-0.000301518],_upttcommand=[0,0],_refmes=0x7f8a13e05570,_tiprefv=
 0x7f8a13c13160,_tiltrefv=0x7f8a13f54e70,_tiprefvn=0x7f8a13c14340,_tiltrefvn=
 0x7f8a13f55a20,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a1595ff08,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a140ea430,
 _binxy=10,_centroidw=0x7f8a15870af0,_fimage=0x7f8a15979830,_fimage2=0x0,
 _imistart=0x7f8a15960010,_imjstart=0x7f8a15956258,_imistart2=0x7f8a15956048,
 _imjstart2=0x7f8a1595f8d8,_unittip=0x7f8a1488ae30,_unittilt=0x7f8a1484e830,
 _lgs_defocuses=0x7f8a140134a8,_unitdefocus=0x10ce64030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a1598de30,_flat=0x7f8a15a33a30,_domask=1,
 _submask=0x7f8a15a08c30,_kernel=0x7f8a140f5230,_kernels=0x10d0ae030,_kerfftr=
 0x10d863030,_kerffti=0x10dad1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a15995030,_x=0x7f8a13f56230,_y=0x7f8a13f56390,_centroidgain=1,_rayleigh=
 0x7f8a14093a38,_bckgrdcalib=0x7f8a1597d230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14012ef8,_ctrlden=0x7f8a14012fd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15956eb8,_xlast=0x7f8a15960220,_ylast=[0x7f8a13e14240,0x7f8a13e14240,
 0x7f8a13e14240],_y0=0x7f8a13e13fe0,_signus=0x7f8a13e144a0,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a1595fbf0,_y=0x7f8a15960118,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d4b1030,_ex=0x7f8a14845740,_ey=0x7f8a14093a70,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15956ca8,_flat_command=0x0,_extrapcmat=
 0x7f8a15073830,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a158d3a88,_ctrlden=0x7f8a140133c8,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a14845580,_xlast=0x7f8a14093990,_ylast=
 [0x7f8a158df258,0x7f8a158df258,0x7f8a158df258],_y0=0x7f8a15870fb8,_signus=
 0x7f8a14093aa8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14013128,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a158d9c60,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a14093958,xposition=0x7f8a148454a0,yposition=
 0x7f8a148455b8,dispzoom=0x7f8a14013588,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868c08,layerfrac=0x7ffb4c8689e8,
 layerspeed=0x7ffb4c868e28,layeralt=0x7ffb4c869400,winddir=0x7ffb4c0d13d0,
 _layeralt=0x7ffb4c868fc0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0cfa80,
 lgs_prof_alt=0x7ffb4c0cfce8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84aef8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c155c78,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c973030,_masks=0x0,_fluxpersub=0x7ffb4c155b70,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c155750,_skyfluxpersub=0x7ffb4c84b210,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00077367,-0.00053507],_lastvalidtt=
 [0.00077367,-0.00053507],_upttcommand=[0,0],_refmes=0x7ffb4bf07940,_tiprefv=
 0x7ffb4bd1ec90,_tiltrefv=0x7ffb4bc42290,_tiprefvn=0x7ffb4bd1f9a0,_tiltrefvn=
 0x7ffb4bc424d0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c155d80,_jstart=0x7ffb4c84b000,_binindices=0x7ffb4c146e30,
 _binxy=10,_centroidw=0x7ffb4c0d1810,_fimage=0x7ffb4c14e030,_fimage2=0x0,
 _imistart=0x7ffb4c155e88,_imjstart=0x7ffb4c155438,_imistart2=0x7ffb4c01fb80,
 _imjstart2=0x7ffb4c84b108,_unittip=0x7ffb4c8cc030,_unittilt=0x7ffb4c815430,
 _lgs_defocuses=0x7ffb4c0cfab8,_unitdefocus=0x10d2f1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c8d5230,_flat=0x7ffb4c810830,_domask=1,
 _submask=0x7ffb4c92c630,_kernel=0x7ffb4c12c630,_kernels=0x10cdaa030,_kerfftr=
 0x10cd2b030,_kerffti=0x10ccac030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c130030,_x=0x7ffb4bd0ebd0,_y=0x7ffb4bd1aac0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cfaf0,_bckgrdcalib=0x7ffb4c8ce030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4d847958,_ctrlden=0x7ffb4c0cfc08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84aad8,_xlast=0x7ffb4c155960,_ylast=[0x7ffb4bd1fe70,0x7ffb4bd1fe70,
 0x7ffb4bd1fe70],_y0=0x7ffb4bd1f420,_signus=0x7ffb4bd1fbe0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b318,_y=0x7ffb4c155a68,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10dc2e030,_ex=0x7ffb4c0cf460,_ey=0x7ffb4c0cf968,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c84abe0,_flat_command=0x0,_extrapcmat=
 0x7ffb4c86ee30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cfee0,_ctrlden=0x7ffb4d847b50,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf818,_xlast=0x7ffb4d847878,_ylast=
 [0x7ffb4c8699d8,0x7ffb4c8699d8,0x7ffb4c8699d8],_y0=0x7ffb4c0d1a30,_signus=
 0x7ffb4c0cf9d8,_puppixoffset=[0,0],_nact=2,_def=0x10da9d030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cf850,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cf658,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cf3f0,xposition=0x7ffb4c0cfc40,yposition=
 0x7ffb4c0cf4d0,dispzoom=0x7ffb4c0cf8c0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c8689e8,layerfrac=0x7ffb4c868e28,
 layerspeed=0x7ffb4c868c08,layeralt=0x7ffb4c89fc98,winddir=0x7ffb4c0d1a30,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c8bb538,
 lgs_prof_alt=0x7ffb4d847920,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c155c78,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c84a9d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c9b4030,_masks=0x0,_fluxpersub=0x7ffb4c155540,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84aef8,_skyfluxpersub=0x7ffb4c155960,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00101712,-0.000568743],_lastvalidtt=
 [0.00101712,-0.000568743],_upttcommand=[0,0],_refmes=0x7ffb4bd05c60,_tiprefv=
 0x7ffb4bd1fe60,_tiltrefv=0x7ffb4bc441a0,_tiprefvn=0x7ffb4bd30970,_tiltrefvn=
 0x7ffb4bc443e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4d039838,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c950830,
 _binxy=10,_centroidw=0x7ffb4c869d08,_fimage=0x7ffb4c828030,_fimage2=0x0,
 _imistart=0x7ffb4c84b000,_imjstart=0x7ffb4c156f08,_imistart2=0x7ffb4c84b210,
 _imjstart2=0x7ffb4c84abe0,_unittip=0x7ffb4c141630,_unittilt=0x7ffb4c149a30,
 _lgs_defocuses=0x7ffb4c0cffc0,_unitdefocus=0x10cc34030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c1c8230,_flat=0x7ffb4c1c4830,_domask=1,
 _submask=0x7ffb4c12c630,_kernel=0x7ffb4c8e7430,_kernels=0x10cdaa030,_kerfftr=
 0x10cd2b030,_kerffti=0x10d2f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c95da30,_x=0x7ffb4bc43160,_y=0x7ffb4bc499e0,_centroidgain=1,_rayleigh=
 0x7ffb4c89d2c0,_bckgrdcalib=0x7ffb4c17d230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c0cf7a8,_ctrlden=0x7ffb4c8bb768,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84b528,_xlast=0x7ffb4c84b630,_ylast=[0x7ffb4bc447e0,0x7ffb4bc447e0,
 0x7ffb4bc447e0],_y0=0x7ffb4bc42bb0,_signus=0x7ffb4bc44a40,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c157118,_y=0x7ffb4c84aad8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4c0d0030,_ey=0x7ffb4c0cf7e0,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c157328,_flat_command=0x0,_extrapcmat=
 0x7ffb4c157630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cfb98,_ctrlden=0x7ffb4c0cfbd0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf5b0,_xlast=0x7ffb4c0cfee0,_ylast=
 [0x7ffb4c8a00d8,0x7ffb4c8a00d8,0x7ffb4c8a00d8],_y0=0x7ffb4c8a0738,_signus=
 0x7ffb4d8478b0,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c8bb7a0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4d847878,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4d847b50,xposition=0x7ffb4c0cf818,yposition=
 0x7ffb4c0cfc40,dispzoom=0x7ffb4c0cf9d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868e28,layerfrac=0x7ffb4c868c08,
 layerspeed=0x7ffb4c8689e8,layeralt=0x7ffb4c869d08,winddir=0x7ffb4c8a0738,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0d0030,
 lgs_prof_alt=0x7ffb4c0cf7e0,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4d039838,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4d039e68,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10dd6d030,_masks=0x0,_fluxpersub=0x7ffb4c157328,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84aad8,_skyfluxpersub=0x7ffb4c157118,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00103852,-0.000994034],_lastvalidtt=
 [0.00103852,-0.000994034],_upttcommand=[0,0],_refmes=0x7ffb4be09b40,_tiprefv=
 0x7ffb4bf062c0,_tiltrefv=0x7ffb4bc49510,_tiprefvn=0x7ffb4bf06500,_tiltrefvn=
 0x7ffb4bc49750,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c84b000,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c14e030,
 _binxy=10,_centroidw=0x7ffb4c8a0b78,_fimage=0x7ffb4c8e7430,_fimage2=0x0,
 _imistart=0x7ffb4c155e88,_imjstart=0x7ffb4c155540,_imistart2=0x7ffb4c84a9d0,
 _imjstart2=0x7ffb4c155c78,_unittip=0x7ffb4c0e8230,_unittilt=0x7ffb4c0e4a30,
 _lgs_defocuses=0x7ffb4c8bb5e0,_unitdefocus=0x10cb59030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c1bc830,_flat=0x7ffb4c1ebc30,_domask=1,
 _submask=0x7ffb4c144430,_kernel=0x7ffb4c8ce030,_kernels=0x10c8f2030,_kerfftr=
 0x10d2f1030,_kerffti=0x10cd2b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c950830,_x=0x7ffb4bc47870,_y=0x7ffb4bc47b30,_centroidgain=1,_rayleigh=
 0x7ffb4c0cf460,_bckgrdcalib=0x7ffb4c1c0230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c8bb8f0,_ctrlden=0x7ffb4c0cfce8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c01fb80,_xlast=0x7ffb4c84b528,_ylast=[0x7ffb4bc49990,0x7ffb4bc49990,
 0x7ffb4bc49990],_y0=0x7ffb4bc42bb0,_signus=0x7ffb4bc49bf0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b108,_y=0x7ffb4c84b630,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4d847958,_ey=0x7ffb4c0cfaf0,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c155438,_flat_command=0x0,_extrapcmat=
 0x7ffb4c0e8a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cf850,_ctrlden=0x7ffb4c0cfa80,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf6c8,_xlast=0x7ffb4c0cfb98,_ylast=
 [0x7ffb4c89fb88,0x7ffb4c89fb88,0x7ffb4c89fb88],_y0=0x7ffb4c8a02f8,_signus=
 0x7ffb4c8b87c0,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cfe70,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cfee0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cfbd0,xposition=0x7ffb4c0cf5b0,yposition=
 0x7ffb4c0cff18,dispzoom=0x7ffb4d8478b0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868c08,layerfrac=0x7ffb4c8689e8,
 layerspeed=0x7ffb4c868e28,layeralt=0x7ffb4c8a0b78,winddir=0x7ffb4c8a02f8,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4d847958,
 lgs_prof_alt=0x7ffb4c0cfaf0,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84b000,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c84b318,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c830030,_masks=0x0,_fluxpersub=0x7ffb4c155438,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84b630,_skyfluxpersub=0x7ffb4c84b108,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000433113,-0.00100216],_lastvalidtt=
 [0.000433113,-0.00100216],_upttcommand=[0,0],_refmes=0x7ffb4bd05df0,_tiprefv=
 0x7ffb4bc42bb0,_tiltrefv=0x7ffb4bc42290,_tiprefvn=0x7ffb4bc42880,_tiltrefvn=
 0x7ffb4bc45b10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c155e88,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c8ce030,
 _binxy=10,_centroidw=0x7ffb4c8a09e0,_fimage=0x7ffb4d026c30,_fimage2=0x0,
 _imistart=0x7ffb4d039d60,_imjstart=0x7ffb4c157328,_imistart2=0x7ffb4d039e68,
 _imjstart2=0x7ffb4d039838,_unittip=0x7ffb4c808430,_unittilt=0x7ffb4c86d230,
 _lgs_defocuses=0x7ffb4c0cffc0,_unitdefocus=0x10dcd1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c982430,_flat=0x7ffb4d86f630,_domask=1,
 _submask=0x7ffb4c977830,_kernel=0x7ffb4c810830,_kernels=0x10c7af030,_kerfftr=
 0x10d2f1030,_kerffti=0x10cd2b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4d01fa30,_x=0x7ffb4bd0ebd0,_y=0x7ffb4bd2e1b0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cf3f0,_bckgrdcalib=0x7ffb4d851030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c8b87f8,_ctrlden=0x7ffb4c8bb7a0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84abe0,_xlast=0x7ffb4c01fb80,_ylast=[0x7ffb4bd1ec90,0x7ffb4bd1ec90,
 0x7ffb4bd1ec90],_y0=0x7ffb4bd1f9a0,_signus=0x7ffb4bd2f740,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84aef8,_y=0x7ffb4c84b528,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4c0cf7a8,_ey=0x7ffb4c0cfa10,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c84b210,_flat_command=0x0,_extrapcmat=
 0x7ffb4c8cc630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cf8f8,_ctrlden=0x7ffb4c0cf658,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cfe38,_xlast=0x7ffb4c0cf850,_ylast=
 [0x7ffb4c8a0958,0x7ffb4c8a0958,0x7ffb4c8a0958],_y0=0x7ffb4c8a0848,_signus=
 0x7ffb4c8bb570,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c8bb730,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cfb98,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cfa80,xposition=0x7ffb4c0cf6c8,yposition=
 0x7ffb4d847920,dispzoom=0x7ffb4c8b87c0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d98,layerfrac=0x7f8a15870d10,
 layerspeed=0x7f8a15870c88,layeralt=0x7f8a15870af0,winddir=0x7f8a15870fb8,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14845740,
 lgs_prof_alt=0x7f8a14093a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a1595ff08,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956ba0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d271030,_masks=0x0,_fluxpersub=0x7f8a15956ca8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15960118,_skyfluxpersub=0x7f8a1595fbf0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000608085,-0.000781249],_lastvalidtt=
 [0.000608085,-0.000781249],_upttcommand=[0,0],_refmes=0x7f8a13f54e70,_tiprefv=
 0x7f8a13d0de30,_tiltrefv=0x7f8a13c17320,_tiprefvn=0x7f8a13d0e070,_tiltrefvn=
 0x7f8a13c17560,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15960010,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a140c5830,
 _binxy=10,_centroidw=0x7f8a158df940,_fimage=0x7f8a15a24430,_fimage2=0x0,
 _imistart=0x7f8a15955f40,_imjstart=0x7f8a15956468,_imistart2=0x7f8a15084bf0,
 _imjstart2=0x7f8a15956678,_unittip=0x7f8a15998030,_unittilt=0x7f8a1599f430,
 _lgs_defocuses=0x7f8a14013518,_unitdefocus=0x10d063030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a159fe630,_flat=0x7f8a1598de30,_domask=1,
 _submask=0x7f8a159f3630,_kernel=0x7f8a14113830,_kernels=0x118f62030,_kerfftr=
 0x10dad1030,_kerffti=0x10d863030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a15a05a30,_x=0x7f8a13f54fb0,_y=0x7f8a13f56120,_centroidgain=1,_rayleigh=
 0x7f8a158d3af8,_bckgrdcalib=0x7f8a15a02030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a140938e8,_ctrlden=0x7f8a14093648,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595ea68,_xlast=0x7f8a15956eb8,_ylast=[0x7f8a13f55a40,0x7f8a13f55a40,
 0x7f8a13f55a40],_y0=0x7f8a13f557e0,_signus=0x7f8a13f55e10,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a15956990,_y=0x7f8a15960220,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a14845660,_ey=0x7f8a14845820,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a159570c8,_flat_command=0x0,_extrapcmat=
 0x7f8a15976230,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14013400,_ctrlden=0x7f8a14845a18,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a158f6c80,_xlast=0x7f8a158d3a88,_ylast=
 [0x7f8a158711d8,0x7f8a158711d8,0x7f8a158711d8],_y0=0x7f8a158dfd80,_signus=
 0x7f8a14013550,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14013320,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14093990,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a140133c8,xposition=0x7f8a14845580,yposition=
 0x7f8a140132e8,dispzoom=0x7f8a14093aa8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d98,layerfrac=0x7f8a15870d10,
 layerspeed=0x7f8a15870c88,layeralt=0x7f8a15870af0,winddir=0x7f8a15870fb8,
 _layeralt=0x7f8a158df830)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14845740,
 lgs_prof_alt=0x7f8a14093a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956eb8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956150,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d271030,_masks=0x0,_fluxpersub=0x7f8a15956ca8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a1595ff08,_skyfluxpersub=0x7f8a15960328,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00045132,-0.000505076],_lastvalidtt=
 [0.00045132,-0.000505076],_upttcommand=[0,0],_refmes=0x7f8a13d046b0,_tiprefv=
 0x7f8a13c159f0,_tiltrefv=0x7f8a13c12b10,_tiprefvn=0x7f8a13c133c0,_tiltrefvn=
 0x7f8a13c12570,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15956570,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a148c1630,
 _binxy=10,_centroidw=0x7f8a158df500,_fimage=0x7f8a14117030,_fimage2=0x0,
 _imistart=0x7f8a15960220,_imjstart=0x7f8a15956258,_imistart2=0x7f8a14810908,
 _imjstart2=0x7f8a15956a98,_unittip=0x7f8a15082430,_unittilt=0x7f8a15055430,
 _lgs_defocuses=0x7f8a148457b0,_unitdefocus=0x10ce64030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a159f3630,_flat=0x7f8a15a06830,_domask=1,
 _submask=0x7f8a15979830,_kernel=0x7f8a15022a30,_kernels=0x10dad1030,_kerfftr=
 0x10d8e2030,_kerffti=0x10d1a7030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a140c1e30,_x=0x7f8a13e03730,_y=0x7f8a13e05540,_centroidgain=1,_rayleigh=
 0x7f8a14093878,_bckgrdcalib=0x7f8a15995630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845820,_ctrlden=0x7f8a140134e0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595f1a0,_xlast=0x7f8a15956990,_ylast=[0x7f8a13c13160,0x7f8a13c13160,
 0x7f8a13c13160],_y0=0x7f8a13c15400,_signus=0x7f8a13c14060,_puppixoffset=[0,0],
 _nact=45,_def=0x1107a5030,_x=0x7f8a15956360,_y=0x7f8a1595fbf0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a158d3a88,_ey=0x7f8a148454d8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a1595ea68,_flat_command=0x0,_extrapcmat=
 0x7f8a1404e030,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a158f6d60,_ctrlden=0x7f8a148454a0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a140939c8,_xlast=0x7f8a14013400,_ylast=
 [0x7f8a158e0468,0x7f8a158e0468,0x7f8a158e0468],_y0=0x7f8a158df2e0,_signus=
 0x7f8a14845a18,_puppixoffset=[0,0],_nact=2,_def=0x10cdf8030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14012e88,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14093990,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a140133c8,xposition=0x7f8a148456d0,yposition=
 0x7f8a14093760,dispzoom=0x7f8a14093aa8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077998,layerfrac=0x7ffe9d077910,
 layerspeed=0x7ffe9d077888,layeralt=0x7ffe9d077bb8,winddir=0x7ffe9d0776f0,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=0,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d863798,
 lgs_prof_alt=0x7ffe9d863760,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d896d18,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d896c10,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110799030,_masks=0x0,_fluxpersub=0x7ffe9d8963d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d8964d8,_skyfluxpersub=0x7ffe9d8965e0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000759772,-0.000268126],_lastvalidtt=
 [0.000759772,-0.000268126],_upttcommand=[0,0],_refmes=0x7ffe9bf09640,_tiprefv=
 0x7ffe9bc40630,_tiltrefv=0x7ffe9bc40870,_tiprefvn=0x7ffe9bc40af0,_tiltrefvn=
 0x7ffe9bc410b0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9d895b90,_jstart=0x7ffe9d895c98,_binindices=0x7ffe9c14e630,
 _binxy=10,_centroidw=0x7ffe9d84e278,_fimage=0x7ffe9d0c4230,_fimage2=0x0,
 _imistart=0x7ffe9d895980,_imjstart=0x7ffe9d8960b8,_imistart2=0x7ffe9d8961c0,
 _imjstart2=0x7ffe9d8962c8,_unittip=0x7ffe9c0e5230,_unittilt=0x7ffe9c157430,
 _lgs_defocuses=0x7ffe9d8667b0,_unitdefocus=0x104358030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9c847a30,_flat=0x7ffe9c826430,_domask=1,
 _submask=0x7ffe9c80aa30,_kernel=0x7ffe9c175230,_kernels=0x104f7a030,_kerfftr=
 0x104467030,_kerffti=0x110656030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9d0f8a30,_x=0x7ffe9bc415b0,_y=0x7ffe9bc41870,_centroidgain=1,_rayleigh=
 0x7ffe9d8667e8,_bckgrdcalib=0x7ffe9c81dc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866a18,_ctrlden=0x7ffe9d8639c8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d8967f0,_xlast=0x7ffe9d041048,_ylast=[0x7ffe9bd0dcc0,0x7ffe9bd0dcc0,
 0x7ffe9bd0dcc0],_y0=0x7ffe9bd0e6b0,_signus=0x7ffe9bd08970,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d896e20,_y=0x7ffe9d895ea8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bc42030,_indext=0x7ffe9d84e300,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x104200030,_ex=0x7ffe9d863b50,_ey=0x7ffe9d863a70,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d895fb0,_flat_command=0x0,
 _extrapcmat=0x7ffe9c10c230,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d8404f8,_ctrlden=
 0x7ffe9d863990,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d866510,_xlast=0x7ffe9d846698,_ylast=[0x7ffe9d84df48,0x7ffe9d84df48,
 0x7ffe9d84df48],_y0=0x7ffe9d84e388,_signus=0x7ffe9d863920,_puppixoffset=[0,0],
 _nact=2,_def=0x1114ad030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d846510,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d846660,xposition=0x7ffe9d863530,yposition=
 0x7ffe9d863680,dispzoom=0x7ffe9d8464d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077910,layerfrac=0x7ffe9d077888,
 layerspeed=0x7ffe9d077998,layeralt=0x7ffe9d84e278,winddir=0x7ffe9d84e388,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d863b50,
 lgs_prof_alt=0x7ffe9d863a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d041678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d896a00,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110758030,_masks=0x0,_fluxpersub=0x7ffe9d041db0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d041468,_skyfluxpersub=0x7ffe9d8966e8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000376457,2.21453e-05],_lastvalidtt=
 [0.000376457,2.21453e-05],_upttcommand=[0,0],_refmes=0x7ffe9bc24c90,_tiprefv=
 0x7ffe9bc44340,_tiltrefv=0x7ffe9bc40230,_tiprefvn=0x7ffe9bc40630,_tiltrefvn=
 0x7ffe9bc40ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9c80a308,_jstart=0x7ffe9d041ca8,_binindices=0x7ffe9c826430,
 _binxy=10,_centroidw=0x7ffe9d84dec0,_fimage=0x7ffe9c86f830,_fimage2=0x0,
 _imistart=0x7ffe9d0424e8,_imjstart=0x7ffe9d041888,_imistart2=0x7ffe9d041150,
 _imjstart2=0x7ffe9d0420c8,_unittip=0x7ffe9c81aa30,_unittilt=0x7ffe9c83e630,
 _lgs_defocuses=0x7ffe9d8665b8,_unitdefocus=0x104efa030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9c8c8e30,_flat=0x7ffe9c868430,_domask=1,
 _submask=0x7ffe9c864a30,_kernel=0x7ffe9c861030,_kernels=0x104296030,_kerfftr=
 0x1044e6030,_kerffti=0x104467030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9c847a30,_x=0x7ffe9bd08470,_y=0x7ffe9bd08730,_centroidgain=1,_rayleigh=
 0x7ffe9d8465b8,_bckgrdcalib=0x7ffe9c86be30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866468,_ctrlden=0x7ffe9d8635a0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d041a98,_xlast=0x7ffe9d896c10,_ylast=[0x7ffe9bf1bad0,0x7ffe9bf1bad0,
 0x7ffe9bf1bad0],_y0=0x7ffe9bf1c820,_signus=0x7ffe9bf1ac60,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d895c98,_y=0x7ffe9d896b08,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bc41f60,_indext=0x7ffe9d84de38,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x1041b2030,_ex=0x7ffe9d866858,_ey=0x7ffe9d863958,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d041570,_flat_command=0x0,
 _extrapcmat=0x7ffe9c855630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d863c30,_ctrlden=
 0x7ffe9d866938,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d863728,_xlast=0x7ffe9d8404f8,_ylast=[0x7ffe9d077800,0x7ffe9d077800,
 0x7ffe9d077800],_y0=0x7ffe9d84ec90,_signus=0x7ffe9d846660,_puppixoffset=[0,0],
 _nact=2,_def=0x104db8030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d846698,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d863990,xposition=0x7ffe9d866510,yposition=
 0x7ffe9d866820,dispzoom=0x7ffe9d863920,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077888,layerfrac=0x7ffe9d077998,
 layerspeed=0x7ffe9d077910,layeralt=0x7ffe9d84dec0,winddir=0x7ffe9d84ec90,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d866858,
 lgs_prof_alt=0x7ffe9d863958,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d041048,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d895980,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110615030,_masks=0x0,_fluxpersub=0x7ffe9d0423e0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d895ea8,_skyfluxpersub=0x7ffe9d897030,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000591495,-0.000439936],_lastvalidtt=
 [0.000591495,-0.000439936],_upttcommand=[0,0],_refmes=0x7ffe9bf191d0,_tiprefv=
 0x7ffe9bf1ca30,_tiltrefv=0x7ffe9bc40870,_tiprefvn=0x7ffe9bf1cc70,_tiltrefvn=
 0x7ffe9bc40ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9d8963d0,_jstart=0x7ffe9d895da0,_binindices=0x7ffe9c834a30,
 _binxy=10,_centroidw=0x7ffe9d84e300,_fimage=0x7ffe9c188830,_fimage2=0x0,
 _imistart=0x7ffe9d041258,_imjstart=0x7ffe9d05d1f0,_imistart2=0x7ffe9d895b90,
 _imjstart2=0x7ffe9d0426f8,_unittip=0x7ffe9c83e630,_unittilt=0x7ffe9c81aa30,
 _lgs_defocuses=0x7ffe9d863bf8,_unitdefocus=0x104317030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9d0d1630,_flat=0x7ffe9d0cdc30,_domask=1,
 _submask=0x7ffe9d046a30,_kernel=0x7ffe9c882c30,_kernels=0x110656030,_kerfftr=
 0x104467030,_kerffti=0x1044e6030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9c129030,_x=0x7ffe9bd07bc0,_y=0x7ffe9bd07e80,_centroidgain=1,_rayleigh=
 0x7ffe9d8667e8,_bckgrdcalib=0x7ffe9d037830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866510,_ctrlden=0x7ffe9d8668c8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d896f28,_xlast=0x7ffe9d896a00,_ylast=[0x7ffe9bf1b470,0x7ffe9bf1b470,
 0x7ffe9bf1b470],_y0=0x7ffe9bf1ef50,_signus=0x7ffe9bf1ac60,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d041ca8,_y=0x7ffe9d041eb8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bd0db90,_indext=0x7ffe9d84e6b8,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x1041b2030,_ex=0x7ffe9d866778,_ey=0x7ffe9d8669a8,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d896e20,_flat_command=0x0,
 _extrapcmat=0x7ffe9d099030,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d863798,_ctrlden=
 0x7ffe9d866740,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d866548,_xlast=0x7ffe9d863c30,_ylast=[0x7ffe9d077bb8,0x7ffe9d077bb8,
 0x7ffe9d077bb8],_y0=0x7ffe9d84eaf8,_signus=0x7ffe9d863990,_puppixoffset=[0,0],
 _nact=2,_def=0x104b1e030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d8404f8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d866938,xposition=0x7ffe9d863728,yposition=
 0x7ffe9d863760,dispzoom=0x7ffe9d846660,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fa46c034f98,layerfrac=0x7fa46c034f10,
 layerspeed=0x7fa46c034e88,layeralt=0x7fa46c0351b8,winddir=0x7fa46c034cf0,
 _layeralt=0x7fa46b8c3898)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=0,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fa46b8daf60,
 lgs_prof_alt=0x7fa46b8bde98,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fa46a84d298,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fa46a84e528,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x115e10030,_masks=0x0,_fluxpersub=0x7fa46a84d6b8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fa46a84d7c0,_skyfluxpersub=0x7fa46a84d8c8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000770909,-0.00045811],_lastvalidtt=
 [0.000770909,-0.00045811],_upttcommand=[0,0],_refmes=0x7fa46a506520,_tiprefv=
 0x7fa46a7161f0,_tiltrefv=0x7fa46a51f710,_tiprefvn=0x7fa46a716430,_tiltrefvn=
 0x7fa46a51f4d0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fa46a84d3a0,_jstart=0x7fa46a84def8,_binindices=0x7fa46c082c30,
 _binxy=10,_centroidw=0x7fa46b8c3348,_fimage=0x7fa46b0b2e30,_fimage2=0x0,
 _imistart=0x7fa46a84e420,_imjstart=0x7fa46b906570,_imistart2=0x7fa46a811508,
 _imjstart2=0x7fa46a84d4a8,_unittip=0x7fa46a877030,_unittilt=0x7fa46a84e830,
 _lgs_defocuses=0x7fa46b8ddd80,_unitdefocus=0x10a5b2030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fa46b957230,_flat=0x7fa46b927830,_domask=1,
 _submask=0x7fa46b902430,_kernel=0x7fa46a86b430,_kernels=0x10a6b3030,_kerfftr=
 0x115d8f030,_kerffti=0x109a10030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fa46b106e30,_x=0x7fa46a413db0,_y=0x7fa46a4083c0,_centroidgain=1,_rayleigh=
 0x7fa46b8ddd10,_bckgrdcalib=0x7fa46b909430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fa46b8db270,_ctrlden=0x7fa46b8de2c0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fa46a84d5b0,_xlast=0x7fa46a84cf80,_ylast=[0x7fa46a715c90,0x7fa46a715c90,
 0x7fa46a715c90],_y0=0x7fa46a716840,_signus=0x7fa46a7154c0,_puppixoffset=[0,0],
 _nact=45,_def=0x10a222030,_x=0x7fa46a84e000,_y=0x7fa46a84e318,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7fa46a520720,_indext=0x7fa46b8c3700,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x10986a030,_ex=0x7fa46b8db3c0,_ey=0x7fa46b8db238,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7fa46b906258,_flat_command=0x0,
 _extrapcmat=0x7fa46c02da30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7fa46b8de1a8,_ctrlden=
 0x7fa46b8de090,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fa46b8ddf40,_xlast=0x7fa46b8db3f8,_ylast=[0x7fa46b8c4910,0x7fa46b8c4910,
 0x7fa46b8c4910],_y0=0x7fa46b8c44d0,_signus=0x7fa46b8ddc68,_puppixoffset=[0,0],
 _nact=2,_def=0x10a1fc030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7fa46b8dafd0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fa46b8bdcd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fa46b8dad30,xposition=0x7fa46b8de0c8,yposition=
 0x7fa46b8b7d68,dispzoom=0x7fa46b8bdd80,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ff52b011420,layerfrac=0x7ff52b011398,
 layerspeed=0x7ff52b011310,layeralt=0x7ff52b011640,winddir=0x7ff52b011178,
 _layeralt=0x7ff52b0107e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ff52c0af148,lgs_prof_alt=
 0x7ff52c0af730,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ff52a840c10,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ff52c148a38,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x117dfa030,_masks=0x0,_fluxpersub=0x7ff52a8402c8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ff52a8403d0,_skyfluxpersub=0x7ff52a8404d8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00093676,8.45903e-05],_lastvalidtt=
 [0.00093676,8.45903e-05],_upttcommand=[0,0],_refmes=0x7ff52a501440,_tiprefv=
 0x7ff52a704520,_tiltrefv=0x7ff52a631610,_tiprefvn=0x7ff52a704760,_tiltrefvn=
 0x7ff52a631850,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ff52a83fb90,_jstart=0x7ff52a83fc98,_binindices=0x7ff52c0fa630,
 _binxy=10,_centroidw=0x7ff52a917348,_fimage=0x7ff52aa20c30,_fimage2=0x0,
 _imistart=0x7ff52a840e20,_imjstart=0x7ff52a83fea8,_imistart2=0x7ff52a8400b8,
 _imjstart2=0x7ff52a8401c0,_unittip=0x7ff52c0b9830,_unittilt=0x7ff52c110030,
 _lgs_defocuses=0x7ff52a9065e8,_unitdefocus=0x10beb6030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ff52aa14c30,_flat=0x7ff52c0f3430,_domask=1,
 _submask=0x7ff52c128e30,_kernel=0x7ff52c141c30,_kernels=0x10bc31030,_kerfftr=
 0x118ab5030,_kerffti=0x117cb7030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ff52aa2ec30,_x=0x7ff52a6303c0,_y=0x7ff52a61c690,_centroidgain=1,_rayleigh=
 0x7ff52a906620,_bckgrdcalib=0x7ff52c107830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7ff52c0af538)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ff52a906968,_ctrlden=0x7ff52a906850,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7ff52c148b40,_xlast=0x7ff52a8406e8,_ylast=[0x7ff52a44c440,
 0x7ff52a44c440,0x7ff52a44c440],_y0=0x7ff52a44b9e0,_signus=0x7ff52a44c100,
 _puppixoffset=[0,0],_nact=45,_def=0x10b7cc030,_x=0x7ff52a840d18,_y=
 0x7ff52a83ffb0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7ff52a44bd90,
 _indext=0x7ff52a917788,_eiffile="sh6x6-if1-ext.fits",_edef=0x117bf5030,_ex=
 0x7ff52a905f50,_ey=0x7ff52a905ea8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7ff52a8405e0,_flat_command=0x0,_extrapcmat=0x7ff52a96c630,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7ff52a9066c8,_ctrlden=0x7ff52a9069a0,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7ff52c0af500,_xlast=0x7ff52a906348,_ylast=
 [0x7ff52a9173d0,0x7ff52a9173d0,0x7ff52a9173d0],_y0=0x7ff52a917810,_signus=
 0x7ff52c0af768,_puppixoffset=[0,0],_nact=2,_def=0x118ddd030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ff52a906578,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ff52a8f0588,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ff52c0af4c8,xposition=0x7ff52c0b3e10,yposition=
 0x7ff52c0c1950,xspeed=0x0,yspeed=0x0,dispzoom=0x7ff52a8f0630,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fedfd051910,layerfrac=0x7fedfd051a20,
 layerspeed=0x7fedfd051888,layeralt=0x7fedfc84dd40,winddir=0x7fedfc84e758,
 _layeralt=0x7fedfc84da10)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fedfc866aa0,lgs_prof_alt=
 0x7fedfc866d40,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fedfc1e7688,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fedfc1e7058,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x1022e4030,_masks=0x0,_fluxpersub=0x7fedfd083ae8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fedfd0836c8,_skyfluxpersub=0x7fedfd084010,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00061392,-0.000956741],_lastvalidtt=
 [0.00061392,-0.000956741],_upttcommand=[0,0],_refmes=0x7fedfbc36410,_tiprefv=
 0x7fedfbc36a40,_tiltrefv=0x7fedfbe3d970,_tiprefvn=0x7fedfbc36c80,_tiltrefvn=
 0x7fedfbe4ba10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fedfd0835c0,_jstart=0x7fedfd0831a0,_binindices=0x7fedfd0d7430,
 _binxy=10,_centroidw=0x7fedfc84df60,_fimage=0x7fedfd0dbe30,_fimage2=0x0,
 _imistart=0x7fedfd083f08,_imjstart=0x7fedfd084430,_imistart2=0x7fedfc1e7580,
 _imjstart2=0x7fedfc1e6f50,_unittip=0x7fedfc04e030,_unittilt=0x7fedfc168630,
 _lgs_defocuses=0x7fedfc8401c0,_unitdefocus=0x102515030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fedfd0e2230,_flat=0x7fedfc125c30,_domask=1,
 _submask=0x7fedfc179c30,_kernel=0x7fedfd0c3e30,_kernels=0x102615030,_kerfftr=
 0x102347030,_kerffti=0x10281b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fedfd0d0230,_x=0x7fedfbc352c0,_y=0x7fedfbc2e590,_centroidgain=1,_rayleigh=
 0x7fedfc845f00,_bckgrdcalib=0x7fedfc118a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fedfc866e20)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fedfc866ec8,_ctrlden=0x7fedfc8667c0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fedfd083e00,_xlast=0x7fedfc1e7370,_ylast=[0x7fedfbe42720,
 0x7fedfbe42720,0x7fedfbe42720],_y0=0x7fedfbe45270,_signus=0x7fedfbe4b540,
 _puppixoffset=[0,0],_nact=45,_def=0x105767030,_x=0x7fedfd083098,_y=
 0x7fedfc1e7160,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fedfbc35780,
 _indext=0x7fedfc84d7f0,_eiffile="sh6x6-if1-ext.fits",_edef=0x102787030,_ex=
 0x7fedfc866d78,_ey=0x7fedfc866db0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fedfc1e6c38,_flat_command=0x0,_extrapcmat=0x7fedfc88b630,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fedfc866de8,_ctrlden=0x7fedfc846130,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fedfc866c28,_xlast=0x7fedfc866b48,_ylast=
 [0x7fedfc84dba8,0x7fedfc84dba8,0x7fedfc84dba8],_y0=0x7fedfc84d6e0,_signus=
 0x7fedfc866718,_puppixoffset=[0,0],_nact=2,_def=0x101dea030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fedfc83c7c0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fedfc866c98,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fedfc8460f8,xposition=0x7fedfc866670,yposition=
 0x7fedfc866f70,xspeed=0x0,yspeed=0x0,dispzoom=0x7fedfc866bb8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fedfd051888,layerfrac=0x7fedfd051910,
 layerspeed=0x7fedfd051a20,layeralt=0x7fedfc84d7f0,winddir=0x7fedfd051228,
 _layeralt=0x7fedfc84da10)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fedfc866b48,lgs_prof_alt=
 0x7fedfc866d40,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fedfc1e7fd0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fedfd084010,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x1023e9030,_masks=0x0,_fluxpersub=0x7fedfd0832a8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fedfc1e7478,_skyfluxpersub=0x7fedfd084328,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00109655,-0.000205848],_lastvalidtt=
 [0.00109655,-0.000205848],_upttcommand=[0,0],_refmes=0x7fedfbc3b160,_tiprefv=
 0x7fedfbd08b70,_tiltrefv=0x7fedfbd0e650,_tiprefvn=0x7fedfbd0e890,_tiltrefvn=
 0x7fedfbd0ee50,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fedfd0835c0,_jstart=0x7fedfd084430,_binindices=0x7fedfc118a30,
 _binxy=10,_centroidw=0x7fedfc84dba8,_fimage=0x7fedfd0c3e30,_fimage2=0x0,
 _imistart=0x7fedfc1e7aa8,_imjstart=0x7fedfd084220,_imistart2=0x7fedfd083ae8,
 _imjstart2=0x7fedfc1e81e0,_unittip=0x7fedfd0d7830,_unittilt=0x7fedfd0f8630,
 _lgs_defocuses=0x7fedfc866750,_unitdefocus=0x102515030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fedfc130a30,_flat=0x7fedfc12d030,_domask=1,
 _submask=0x7fedfc1e8e30,_kernel=0x7fedfc129630,_kernels=0x10281b030,_kerfftr=
 0x102695030,_kerffti=0x102595030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fedfd0ebc30,_x=0x7fedfbe4bc90,_y=0x7fedfbe4dfa0,_centroidgain=1,_rayleigh=
 0x7fedfc867210,_bckgrdcalib=0x7fedfc1ec830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fedfc8667f8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fedfc866e90,_ctrlden=0x7fedfc866718,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fedfd082a68,_xlast=0x7fedfc1e80d8,_ylast=[0x7fedfbe42720,
 0x7fedfbe42720,0x7fedfbe42720],_y0=0x7fedfbe4ba30,_signus=0x7fedfbe4be80,
 _puppixoffset=[0,0],_nact=45,_def=0x10566e030,_x=0x7fedfd083098,_y=
 0x7fedfd0833b0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fedfbc36410,
 _indext=0x7fedfc84d988,_eiffile="sh6x6-if1-ext.fits",_edef=0x10273c030,_ex=
 0x7fedfc8670c0,_ey=0x7fedfc866f70,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fedfc1e7688,_flat_command=0x0,_extrapcmat=0x7fedfd0d8e30,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fedfc845f00,_ctrlden=0x7fedfc866c60,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fedfc866b80,_xlast=0x7fedfc867050,_ylast=
 [0x7fedfc84e758,0x7fedfc84e758,0x7fedfc84e758],_y0=0x7fedfc84e538,_signus=
 0x7fedfc866f00,_puppixoffset=[0,0],_nact=2,_def=0x101d38030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fedfc867130,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fedfc866d78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fedfc866fa8,xposition=0x7fedfc8672b8,yposition=
 0x7fedfc846130,xspeed=0x0,yspeed=0x0,dispzoom=0x7fedfc867398,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fee59873310,layerfrac=0x7fee59873288,
 layerspeed=0x7fee59873398,layeralt=0x7fee598728f8,winddir=0x7fee59873200,
 _layeralt=0x7fee598727e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fee5916bdb8,lgs_prof_alt=
 0x7fee5916b800,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fee591fc620,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fee591fb9c0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x11e5d9030,_masks=0x0,_fluxpersub=0x7fee591fb8b8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fee591fbac8,_skyfluxpersub=0x7fee591fbcd8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000724527,-0.000834329],_lastvalidtt=
 [0.000724527,-0.000834329],_upttcommand=[0,0],_refmes=0x7fee58f029d0,_tiprefv=
 0x7fee58f06760,_tiltrefv=0x7fee58c56d70,_tiprefvn=0x7fee58f03fc0,_tiltrefvn=
 0x7fee58c5cb20,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fee591fbbd0,_jstart=0x7fee591fc410,_binindices=0x7fee598f9e30,
 _binxy=10,_centroidw=0x7fee591541e8,_fimage=0x7fee59901630,_fimage2=0x0,
 _imistart=0x7fee591fc200,_imjstart=0x7fee591fc830,_imistart2=0x7fee591fc518,
 _imjstart2=0x7fee591fc0f8,_unittip=0x7fee59278030,_unittilt=0x7fee59278830,
 _lgs_defocuses=0x7fee5916b8a8,_unitdefocus=0x10f11a030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fee59928e30,_flat=0x7fee5991e230,_domask=1,
 _submask=0x7fee5991a830,_kernel=0x7fee59916e30,_kernels=0x10f3ac030,_kerfftr=
 0x10eccf030,_kerffti=0x1125dd030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fee59908830,_x=0x7fee58c57370,_y=0x7fee58c57630,_centroidgain=1,_rayleigh=
 0x7fee5914c3a0,_bckgrdcalib=0x7fee59921c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fee5916bfb0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fee5914c0c8,_ctrlden=0x7fee5916bfe8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fee591fb5a0,_xlast=0x7fee591fbff0,_ylast=[0x7fee58c56fb0,
 0x7fee58c56fb0,0x7fee58c56fb0],_y0=0x7fee58c564a0,_signus=0x7fee58c50a70,
 _puppixoffset=[0,0],_nact=45,_def=0x114227030,_x=0x7fee591fb498,_y=
 0x7fee591fbee8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fee58f04200,
 _indext=0x7fee59153748,_eiffile="sh6x6-if1-ext.fits",_edef=0x10eee9030,_ex=
 0x7fee5916c330,_ey=0x7fee5916c250,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fee591fb180,_flat_command=0x0,_extrapcmat=0x7fee598b8030,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fee5916b790,_ctrlden=0x7fee591429c0,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fee5916bd48,_xlast=0x7fee5914c218,_ylast=
 [0x7fee59154408,0x7fee59154408,0x7fee59154408],_y0=0x7fee59154518,_signus=
 0x7fee5916c448,_puppixoffset=[0,0],_nact=2,_def=0x10f03a030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fee5914c100,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fee5916c2f8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fee5914c2f8,xposition=0x7fee5914c410,yposition=
 0x7fee5916bd80,xspeed=0x0,yspeed=0x0,dispzoom=0x7fee5916c480,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.029      328.8
Field Avg  1.65                    200.0   0.029      328.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111f50,winddir=0x7f7f51112948,
 _layeralt=0x7f7f51112bf0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ea18,lgs_prof_alt=
 0x7f7f520022c0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019a48,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a078,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bda8030,_masks=0x0,_fluxpersub=0x7f7f51808150,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a7b0,_skyfluxpersub=0x7f7f51808990,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00508875,-0.00682499],_lastvalidtt=
 [-0.00508875,-0.00682499],_upttcommand=[0,0],_refmes=0x7f7f506292d0,_tiprefv=
 0x7f7f52936370,_tiltrefv=0x7f7f507018e0,_tiprefvn=0x7f7f529365b0,_tiltrefvn=
 0x7f7f50701b20,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b410,_jstart=0x7f7f5100e908,_binindices=0x7f7f5182aa30,
 _binxy=10,_centroidw=0x7f7f51112308,_fimage=0x7f7f509c8430,_fimage2=0x0,
 _imistart=0x7f7f52019e68,_imjstart=0x7f7f51807f40,_imistart2=0x7f7f51808ba0,
 _imjstart2=0x7f7f52019b50,_unittip=0x7f7f51156830,_unittilt=0x7f7f51158030,
 _lgs_defocuses=0x7f7f51104b40,_unitdefocus=0x10c459030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5094e630,_flat=0x7f7f5094ac30,_domask=1,
 _submask=0x7f7f509c1030,_kernel=0x7f7f50947230,_kernels=0x10c95c030,_kerfftr=
 0x10c572030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509ce630,_x=0x7f7f528afae0,_y=0x7f7f52864990,_centroidgain=1,_rayleigh=
 0x7f7f51104fa0,_bckgrdcalib=0x7f7f509c4a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51105630)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104ad0,_ctrlden=0x7f7f52001fe8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201abd0,_xlast=0x7f7f51808468,_ylast=[0x7f7f52936c60,
 0x7f7f52936c60,0x7f7f52936c60],_y0=0x7f7f52921660,_signus=0x7f7f52937d50,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201aee8,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f52002170,_ey=
 0x7f7f5110e4d8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808678,
 _flat_command=0x0,_extrapcmat=0x7f7f5095ce30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002218,_ctrlden=0x7f7f51105868,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002138,_xlast=0x7f7f5110edd0,_ylast=[0x7f7f51112060,0x7f7f51112060,
 0x7f7f51112060],_y0=0x7f7f51113718,_signus=0x7f7f52002410,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e660,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110eba0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e5f0,xposition=0x7f7f52002448,yposition=
 0x7f7f5110bc30,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520021a8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.029      328.8
Field Avg  1.65                    200.0   0.029      328.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511129d0,winddir=0x7f7f51113140,
 _layeralt=0x7f7f51113cf0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002058,lgs_prof_alt=
 0x7f7f51104b08,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b518,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51022b80,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c6ef030,_masks=0x0,_fluxpersub=0x7f7f518092d8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081a20,_skyfluxpersub=0x7f7f51808888,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00452039,-0.0068567],_lastvalidtt=
 [-0.00452039,-0.0068567],_upttcommand=[0,0],_refmes=0x7f7f5062b3e0,_tiprefv=
 0x7f7f5062c9b0,_tiltrefv=0x7f7f5062c770,_tiprefvn=0x7f7f5062d3b0,_tiltrefvn=
 0x7f7f5062d830,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808990,_jstart=0x7f7f51081708,_binindices=0x7f7f5200d830,
 _binxy=10,_centroidw=0x7f7f51111ca8,_fimage=0x7f7f51264830,_fimage2=0x0,
 _imistart=0x7f7f5201b620,_imjstart=0x7f7f51808678,_imistart2=0x7f7f52019a48,
 _imjstart2=0x7f7f5201a078,_unittip=0x7f7f52008630,_unittilt=0x7f7f52015830,
 _lgs_defocuses=0x7f7f51104d00,_unitdefocus=0x10c2ea030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52091430,_flat=0x7f7f52009e30,_domask=1,
 _submask=0x7f7f52064630,_kernel=0x7f7f5208da30,_kernels=0x10c4d9030,_kerfftr=
 0x10c572030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5123ec30,_x=0x7f7f50739040,_y=0x7f7f50701540,_centroidgain=1,_rayleigh=
 0x7f7f511101c0,_bckgrdcalib=0x7f7f52094e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e660)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51105588,_ctrlden=0x7f7f51105630,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201aee8,_xlast=0x7f7f51081810,_ylast=[0x7f7f528b3440,
 0x7f7f528b3440,0x7f7f528b3440],_y0=0x7f7f528b1870,_signus=0x7f7f528ade50,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201b410,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f5110eba0,_ey=
 0x7f7f5110ed60,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808a98,
 _flat_command=0x0,_extrapcmat=0x7f7f50933830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ecb8,_ctrlden=0x7f7f52001f40,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002448,_xlast=0x7f7f52002020,_ylast=[0x7f7f51112c78,0x7f7f51112c78,
 0x7f7f51112c78],_y0=0x7f7f51111fd8,_signus=0x7f7f51104b78,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001cd8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110bc30,xposition=0x7f7f52002138,yposition=
 0x7f7f5110e5f0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f51104980,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.029      328.8
Field Avg  1.65                    200.0   0.029      328.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112c78)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5100e908,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808db0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c6ef030,_masks=0x0,_fluxpersub=0x7f7f51022b80,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b518,_skyfluxpersub=0x7f7f51808a98,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.0043278,-0.00649572],_lastvalidtt=
 [-0.0043278,-0.00649572],_upttcommand=[0,0],_refmes=0x7f7f5062c450,_tiprefv=
 0x7f7f5062c9b0,_tiltrefv=0x7f7f52933c10,_tiprefvn=0x7f7f5062cbf0,_tiltrefvn=
 0x7f7f52921e80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808678,_jstart=0x7f7f5201b620,_binindices=0x7f7f50970230,
 _binxy=10,_centroidw=0x7f7f51112ae0,_fimage=0x7f7f511a4630,_fimage2=0x0,
 _imistart=0x7f7f52019e68,_imjstart=0x7f7f51808888,_imistart2=0x7f7f51081a20,
 _imjstart2=0x7f7f518092d8,_unittip=0x7f7f5114ea30,_unittilt=0x7f7f5114da30,
 _lgs_defocuses=0x7f7f5110fc48,_unitdefocus=0x10c418030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50977630,_flat=0x7f7f5096c830,_domask=1,
 _submask=0x7f7f50968e30,_kernel=0x7f7f50989430,_kernels=0x10c459030,_kerfftr=
 0x10c572030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511a9630,_x=0x7f7f528af960,_y=0x7f7f528b25e0,_centroidgain=1,_rayleigh=
 0x7f7f5110ff90,_bckgrdcalib=0x7f7f50982230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ee08,_ctrlden=0x7f7f5110ea50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081810,_xlast=0x7f7f5201b410,_ylast=[0x7f7f529368b0,
 0x7f7f529368b0,0x7f7f529368b0],_y0=0x7f7f529377b0,_signus=0x7f7f529372a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201a288,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f52002410,_ey=
 0x7f7f51107160,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808fc0,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001db8,_ctrlden=0x7f7f51110038,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e5f0,_xlast=0x7f7f51104ad0,_ylast=[0x7f7f511131c8,0x7f7f511131c8,
 0x7f7f511131c8],_y0=0x7f7f51113030,_signus=0x7f7f52002288,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520029c0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f5110bc30,yposition=
 0x7f7f52002138,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.0   0.356      192.2
Field Avg  1.65                     47.0   0.356      192.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112d00)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a9c0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808780,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c243030,_masks=0x0,_fluxpersub=0x7f7f51081a20,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518092d8,_skyfluxpersub=0x7f7f51022b80,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00330771,0.00102059],_lastvalidtt=
 [-0.00330771,0.00102059],_upttcommand=[0,0],_refmes=0x7f7f528afaa0,_tiprefv=
 0x7f7f528b2dc0,_tiltrefv=0x7f7f505539d0,_tiprefvn=0x7f7f528b3000,_tiltrefvn=
 0x7f7f528b3480,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aff0,_jstart=0x7f7f51808db0,_binindices=0x7f7f51279c30,
 _binxy=10,_centroidw=0x7f7f511134f8,_fimage=0x7f7f50968230,_fimage2=0x0,
 _imistart=0x7f7f5201b518,_imjstart=0x7f7f51808eb8,_imistart2=0x7f7f52019e68,
 _imjstart2=0x7f7f51808888,_unittip=0x7f7f5114ea30,_unittilt=0x7f7f51158030,
 _lgs_defocuses=0x7f7f5110fc10,_unitdefocus=0x10c284030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5125a630,_flat=0x7f7f51256c30,_domask=1,
 _submask=0x7f7f51264830,_kernel=0x7f7f5126ba30,_kernels=0x10c4d9030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c95c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5095e230,_x=0x7f7f528b2c10,_y=0x7f7f528b1870,_centroidgain=1,_rayleigh=
 0x7f7f5110fc48,_bckgrdcalib=0x7f7f511aba30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002410,_ctrlden=0x7f7f5110ec80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a8b8,_xlast=0x7f7f51081810,_ylast=[0x7f7f529360a0,
 0x7f7f529360a0,0x7f7f529360a0],_y0=0x7f7f52933c10,_signus=0x7f7f52921a80,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f51808990,_y=
 0x7f7f5201a288,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f51104e18,_ey=
 0x7f7f52002170,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b410,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002218,_ctrlden=0x7f7f51107198,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51110038,_xlast=0x7f7f5110ee08,_ylast=[0x7f7f51113a48,0x7f7f51113a48,
 0x7f7f51113a48],_y0=0x7f7f51113938,_signus=0x7f7f5110e5f0,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51104ad0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f52001ed0,yposition=
 0x7f7f51104ec0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.556      141.6
Field Avg  1.65                     44.5   0.556      141.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51113580)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a7b0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51807e38,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c2ea030,_masks=0x0,_fluxpersub=0x7f7f52019e68,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808888,_skyfluxpersub=0x7f7f51081a20,
 _nphotons=28154.7,_skynphotons=0,_tt=[0.00019493,-0.000517335],_lastvalidtt=
 [0.00019493,-0.000517335],_upttcommand=[0,0],_refmes=0x7f7f50700860,_tiprefv=
 0x7f7f528b1870,_tiltrefv=0x7f7f50418390,_tiprefvn=0x7f7f528af960,_tiltrefvn=
 0x7f7f52936540,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a498,_jstart=0x7f7f51808780,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f511131c8,_fimage=0x7f7f51279230,_fimage2=0x0,
 _imistart=0x7f7f518092d8,_imjstart=0x7f7f5201b308,_imistart2=0x7f7f5201b518,
 _imjstart2=0x7f7f51808eb8,_unittip=0x7f7f5114e230,_unittilt=0x7f7f51159c30,
 _lgs_defocuses=0x7f7f52001d10,_unitdefocus=0x10c350030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50951e30,_flat=0x7f7f50947230,_domask=1,
 _submask=0x7f7f5095e230,_kernel=0x7f7f50943830,_kernels=0x10c459030,_kerfftr=
 0x10c399030,_kerffti=0x10c572030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511d9c30,_x=0x7f7f52864990,_y=0x7f7f528b25e0,_centroidgain=1,_rayleigh=
 0x7f7f5110fc10,_bckgrdcalib=0x7f7f5094ac30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104e18,_ctrlden=0x7f7f51110000,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a288,_xlast=0x7f7f5201a8b8,_ylast=[0x7f7f52933c10,
 0x7f7f52933c10,0x7f7f52933c10],_y0=0x7f7f52936940,_signus=0x7f7f52938010,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201b830,_y=
 0x7f7f51808990,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f5110bc30,_ey=
 0x7f7f5110eac0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f50979030,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e970,_ctrlden=0x7f7f52001db8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51107198,_xlast=0x7f7f52002410,_ylast=[0x7f7f511139c0,0x7f7f511139c0,
 0x7f7f511139c0],_y0=0x7f7f51113470,_signus=0x7f7f51110038,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110ee08,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f5110fac0,yposition=
 0x7f7f520029c0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       58.7   0.089      404.7
Field Avg  1.65                     58.7   0.089      404.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51113828)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518091d0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b200,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bda8030,_masks=0x0,_fluxpersub=0x7f7f5201b518,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808eb8,_skyfluxpersub=0x7f7f52019e68,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.0232019,0.00048027],_lastvalidtt=
 [-0.0232019,0.00048027],_upttcommand=[0,0],_refmes=0x7f7f528b25e0,_tiprefv=
 0x7f7f528f5f60,_tiltrefv=0x7f7f528f5900,_tiprefvn=0x7f7f528b1870,_tiltrefvn=
 0x7f7f528f61a0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019c58,_jstart=0x7f7f51807e38,_binindices=0x7f7f5096c830,
 _binxy=10,_centroidw=0x7f7f51113a48,_fimage=0x7f7f50a6a630,_fimage2=0x0,
 _imistart=0x7f7f51808888,_imjstart=0x7f7f5201a5a0,_imistart2=0x7f7f518092d8,
 _imjstart2=0x7f7f5201b308,_unittip=0x7f7f50957e30,_unittilt=0x7f7f5093b230,
 _lgs_defocuses=0x7f7f5110fe08,_unitdefocus=0x10c16f030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50977630,_flat=0x7f7f50943830,_domask=1,
 _submask=0x7f7f50973c30,_kernel=0x7f7f50a48030,_kernels=0x10c4d9030,_kerfftr=
 0x10c95c030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5118ce30,_x=0x7f7f52933c10,_y=0x7f7f52992930,_centroidgain=1,_rayleigh=
 0x7f7f52001d10,_bckgrdcalib=0x7f7f509ef630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ec80,_ctrlden=0x7f7f520021e0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808990,_xlast=0x7f7f5201a288,_ylast=[0x7f7f52936870,
 0x7f7f52936870,0x7f7f52936870],_y0=0x7f7f5298eaa0,_signus=0x7f7f5298f8f0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f51808fc0,_y=
 0x7f7f5201b830,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f52001ed0,_ey=
 0x7f7f511055c0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a8b8,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fd28,_ctrlden=0x7f7f5110bc30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001db8,_xlast=0x7f7f51104e18,_ylast=[0x7f7f51113e88,0x7f7f51113e88,
 0x7f7f51113e88],_y0=0x7f7f51113c68,_signus=0x7f7f51107198,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002410,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f52001ca0,yposition=
 0x7f7f51104ad0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      206.3   0.028      333.9
Field Avg  1.65                    206.3   0.028      333.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f511121f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019d60,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808a98,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c418030,_masks=0x0,_fluxpersub=0x7f7f518092d8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b308,_skyfluxpersub=0x7f7f5201b518,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00356307,-0.00714037],_lastvalidtt=
 [-0.00356307,-0.00714037],_upttcommand=[0,0],_refmes=0x7f7f52a6c580,_tiprefv=
 0x7f7f52a6ccd0,_tiltrefv=0x7f7f52b33480,_tiprefvn=0x7f7f528f5ef0,_tiltrefvn=
 0x7f7f52b336c0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019940,_jstart=0x7f7f5201b200,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f511139c0,_fimage=0x7f7f5095e230,_fimage2=0x0,
 _imistart=0x7f7f51808eb8,_imjstart=0x7f7f5201ade0,_imistart2=0x7f7f51808888,
 _imjstart2=0x7f7f5201a5a0,_unittip=0x7f7f51158030,_unittilt=0x7f7f51159c30,
 _lgs_defocuses=0x7f7f5110ea50,_unitdefocus=0x10c002030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5094e430,_flat=0x7f7f50943830,_domask=1,
 _submask=0x7f7f50973c30,_kernel=0x7f7f5097ae30,_kernels=0x10c459030,_kerfftr=
 0x10c572030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50969430,_x=0x7f7f528f63f0,_y=0x7f7f52a6c9c0,_centroidgain=1,_rayleigh=
 0x7f7f5110fe08,_bckgrdcalib=0x7f7f50951e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002170,_ctrlden=0x7f7f5110ed60,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b830,_xlast=0x7f7f51808990,_ylast=[0x7f7f5298ea20,
 0x7f7f5298ea20,0x7f7f5298ea20],_y0=0x7f7f52b32c90,_signus=0x7f7f52b344a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201b410,_y=
 0x7f7f51808fc0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110fac0,_ey=
 0x7f7f520029f8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a288,
 _flat_command=0x0,_extrapcmat=0x7f7f52064630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fbd8,_ctrlden=0x7f7f51107160,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110bc30,_xlast=0x7f7f5110ec80,_ylast=[0x7f7f51111db8,0x7f7f51111db8,
 0x7f7f51111db8],_y0=0x7f7f51111d30,_signus=0x7f7f52001db8,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51104e18,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f51104a60,yposition=
 0x7f7f5110ee08,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.333      197.3
Field Avg  1.65                     47.3   0.333      197.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112838)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f510814f8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51022b80,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bd06030,_masks=0x0,_fluxpersub=0x7f7f51808888,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a5a0,_skyfluxpersub=0x7f7f518092d8,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00542527,0.000967243],_lastvalidtt=
 [-0.00542527,0.000967243],_upttcommand=[0,0],_refmes=0x7f7f52bc8ce0,_tiprefv=
 0x7f7f52bc97d0,_tiltrefv=0x7f7f52bc9590,_tiprefvn=0x7f7f52bc9a10,_tiltrefvn=
 0x7f7f52b33470,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019e68,_jstart=0x7f7f51808a98,_binindices=0x7f7f50985a30,
 _binxy=10,_centroidw=0x7f7f51113e88,_fimage=0x7f7f51273a30,_fimage2=0x0,
 _imistart=0x7f7f5201b308,_imjstart=0x7f7f518091d0,_imistart2=0x7f7f51808eb8,
 _imjstart2=0x7f7f5201ade0,_unittip=0x7f7f50961c30,_unittilt=0x7f7f5092ea30,
 _lgs_defocuses=0x7f7f52002218,_unitdefocus=0x10bf36030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5094e430,_flat=0x7f7f50943830,_domask=1,
 _submask=0x7f7f50962e30,_kernel=0x7f7f509cea30,_kernels=0x10c4d9030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c95c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5095e230,_x=0x7f7f52bcbab0,_y=0x7f7f5298eb80,_centroidgain=1,_rayleigh=
 0x7f7f5110ea50,_bckgrdcalib=0x7f7f50947230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fd28,_ctrlden=0x7f7f5110fc80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808fc0,_xlast=0x7f7f5201b830,_ylast=[0x7f7f52b32c90,
 0x7f7f52b32c90,0x7f7f52b32c90],_y0=0x7f7f52bc92b0,_signus=0x7f7f52bc81b0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f51081810,_y=
 0x7f7f5201b410,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f52001ca0,_ey=
 0x7f7f52001df0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808990,
 _flat_command=0x0,_extrapcmat=0x7f7f5095d430,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ec10,_ctrlden=0x7f7f5110e468,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51107160,_xlast=0x7f7f52002170,_ylast=[0x7f7f51112a58,0x7f7f51112a58,
 0x7f7f51112a58],_y0=0x7f7f51112390,_signus=0x7f7f5110bc30,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110ec80,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f511049b8,yposition=
 0x7f7f52002410,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.544      146.7
Field Avg  1.65                     44.5   0.544      146.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f511133e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201acd8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081a20,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c350030,_masks=0x0,_fluxpersub=0x7f7f51808eb8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201ade0,_skyfluxpersub=0x7f7f51808888,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00152059,-0.0006883],_lastvalidtt=
 [-0.00152059,-0.0006883],_upttcommand=[0,0],_refmes=0x7f7f52ae5e50,_tiprefv=
 0x7f7f52c69d40,_tiltrefv=0x7f7f52bc97d0,_tiprefvn=0x7f7f52c69f80,_tiltrefvn=
 0x7f7f52bc9a10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808360,_jstart=0x7f7f51022b80,_binindices=0x7f7f50943830,
 _binxy=10,_centroidw=0x7f7f51111db8,_fimage=0x7f7f5094c230,_fimage2=0x0,
 _imistart=0x7f7f5201a5a0,_imjstart=0x7f7f5201a7b0,_imistart2=0x7f7f5201b308,
 _imjstart2=0x7f7f518091d0,_unittip=0x7f7f5092ea30,_unittilt=0x7f7f50958030,
 _lgs_defocuses=0x7f7f52002138,_unitdefocus=0x10d132030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5126ba30,_flat=0x7f7f511e2030,_domask=1,
 _submask=0x7f7f511de630,_kernel=0x7f7f51279a30,_kernels=0x10c459030,_kerfftr=
 0x10c399030,_kerffti=0x10c572030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50950c30,_x=0x7f7f52bc81b0,_y=0x7f7f52b32c90,_centroidgain=1,_rayleigh=
 0x7f7f52002218,_bckgrdcalib=0x7f7f5126f430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f52001fb0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b410,_xlast=0x7f7f51808fc0,_ylast=[0x7f7f5064eed0,
 0x7f7f5064eed0,0x7f7f5064eed0],_y0=0x7f7f5064ea40,_signus=0x7f7f5064f130,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f51808ca8,_y=
 0x7f7f51081810,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f51104a60,_ey=
 0x7f7f5110faf8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b830,
 _flat_command=0x0,_extrapcmat=0x7f7f5117c230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f52001d80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e468,_xlast=0x7f7f5110fd28,_ylast=[0x7f7f51112948,0x7f7f51112948,
 0x7f7f51112948],_y0=0x7f7f51111f50,_signus=0x7f7f51107160,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002170,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f5110fba0,yposition=
 0x7f7f51104e18,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.323      217.5
Field Avg  1.65                     47.3   0.323      217.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112308)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081b28,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5100e908,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c16f030,_masks=0x0,_fluxpersub=0x7f7f5201b308,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518091d0,_skyfluxpersub=0x7f7f51808eb8,
 _nphotons=1776.44,_skynphotons=0,_tt=[0.00891897,0.00225075],_lastvalidtt=
 [0.00891897,0.00225075],_upttcommand=[0,0],_refmes=0x7f7f5065b720,_tiprefv=
 0x7f7f52deadd0,_tiltrefv=0x7f7f52deab90,_tiprefvn=0x7f7f52deb010,_tiltrefvn=
 0x7f7f52bc97a0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518090c8,_jstart=0x7f7f51081a20,_binindices=0x7f7f52064630,
 _binxy=10,_centroidw=0x7f7f51112a58,_fimage=0x7f7f511e2030,_fimage2=0x0,
 _imistart=0x7f7f5201ade0,_imjstart=0x7f7f518093e0,_imistart2=0x7f7f5201a5a0,
 _imjstart2=0x7f7f5201a7b0,_unittip=0x7f7f511a1030,_unittilt=0x7f7f51156030,
 _lgs_defocuses=0x7f7f52001f78,_unitdefocus=0x10cadb030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f520b4c30,_flat=0x7f7f520b1230,_domask=1,
 _submask=0x7f7f52078230,_kernel=0x7f7f5207f430,_kernels=0x10c4d9030,_kerfftr=
 0x10c95c030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51279230,_x=0x7f7f52c69f80,_y=0x7f7f52ce7de0,_centroidgain=1,_rayleigh=
 0x7f7f52002138,_bckgrdcalib=0x7f7f5209f830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e5f0,_ctrlden=0x7f7f5110ea50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081810,_xlast=0x7f7f5201b410,_ylast=[0x7f7f52dea260,
 0x7f7f52dea260,0x7f7f52dea260],_y0=0x7f7f52decba0,_signus=0x7f7f52bc8c70,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201a288,_y=
 0x7f7f51808ca8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f511049b8,_ey=
 0x7f7f52002058,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808fc0,
 _flat_command=0x0,_extrapcmat=0x7f7f50957e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001df0,_ctrlden=0x7f7f51104a60,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001d80,_xlast=0x7f7f52002a30,_ylast=[0x7f7f5100b450,0x7f7f5100b450,
 0x7f7f5100b450],_y0=0x7f7f51113360,_signus=0x7f7f5110e468,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fd28,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f52001c68,yposition=
 0x7f7f5110ec80,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      243.3   0.022      369.3
Field Avg  1.65                    243.3   0.022      369.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51113d78)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808048,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b518,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f5201a5a0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a7b0,_skyfluxpersub=0x7f7f5201b308,
 _nphotons=112.086,_skynphotons=0,_tt=[0.0262605,0.0061036],_lastvalidtt=
 [0.0262605,0.0061036],_upttcommand=[0,0],_refmes=0x7f7f5076c4b0,_tiprefv=
 0x7f7f5076caf0,_tiltrefv=0x7f7f5076c770,_tiprefvn=0x7f7f5076cd30,_tiltrefvn=
 0x7f7f5076d1b0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51081600,_jstart=0x7f7f5100e908,_binindices=0x7f7f52064630,
 _binxy=10,_centroidw=0x7f7f51112948,_fimage=0x7f7f50a42c30,_fimage2=0x0,
 _imistart=0x7f7f518091d0,_imjstart=0x7f7f5201a9c0,_imistart2=0x7f7f5201ade0,
 _imjstart2=0x7f7f518093e0,_unittip=0x7f7f50932c30,_unittilt=0x7f7f50930230,
 _lgs_defocuses=0x7f7f5110eb30,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51268230,_flat=0x7f7f5180a030,_domask=1,
 _submask=0x7f7f51279c30,_kernel=0x7f7f511e1e30,_kernels=0x10c459030,_kerfftr=
 0x10c572030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509c1030,_x=0x7f7f52f7dab0,_y=0x7f7f52f7cf40,_centroidgain=1,_rayleigh=
 0x7f7f52001f78,_bckgrdcalib=0x7f7f51868030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc48,_ctrlden=0x7f7f5110faf8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ca8,_xlast=0x7f7f51081810,_ylast=[0x7f7f52e7a510,
 0x7f7f52e7a510,0x7f7f52e7a510],_y0=0x7f7f52e78e30,_signus=0x7f7f52e799d0,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f51808990,_y=
 0x7f7f5201a288,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f5110fba0,_ey=
 0x7f7f511055f8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b410,
 _flat_command=0x0,_extrapcmat=0x7f7f509bf630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f5110fbd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104a60,_xlast=0x7f7f5110e5f0,_ylast=[0x7f7f51112f20,0x7f7f51112f20,
 0x7f7f51112f20],_y0=0x7f7f51113608,_signus=0x7f7f52001d80,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002a30,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f52001f08,yposition=
 0x7f7f52002170,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       76.0   0.093      268.1
Field Avg  1.65                     76.0   0.093      268.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112e98)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019b50,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518092d8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bf36030,_masks=0x0,_fluxpersub=0x7f7f5201ade0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518093e0,_skyfluxpersub=0x7f7f5201a5a0,
 _nphotons=112.086,_skynphotons=0,_tt=[0.000390722,-0.0156406],_lastvalidtt=
 [0.000390722,-0.0156406],_upttcommand=[0,0],_refmes=0x7f7f52ef30d0,_tiprefv=
 0x7f7f52ef3710,_tiltrefv=0x7f7f50675ee0,_tiprefvn=0x7f7f52ef3950,_tiltrefvn=
 0x7f7f506763a0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808eb8,_jstart=0x7f7f5201b518,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f5100b450,_fimage=0x7f7f511f9430,_fimage2=0x0,
 _imistart=0x7f7f5201a7b0,_imjstart=0x7f7f51081b28,_imistart2=0x7f7f518091d0,
 _imjstart2=0x7f7f5201a9c0,_unittip=0x7f7f50934e30,_unittilt=0x7f7f5092f230,
 _lgs_defocuses=0x7f7f5110ec10,_unitdefocus=0x10c6ef030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50943830,_flat=0x7f7f509af830,_domask=1,
 _submask=0x7f7f509abe30,_kernel=0x7f7f509ebc30,_kernels=0x10c4d9030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c95c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51258e30,_x=0x7f7f53014930,_y=0x7f7f53016950,_centroidgain=1,_rayleigh=
 0x7f7f5110eb30,_bckgrdcalib=0x7f7f509b3230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520023d8,_ctrlden=0x7f7f52002058,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a288,_xlast=0x7f7f51808ca8,_ylast=[0x7f7f53012ae0,
 0x7f7f53012ae0,0x7f7f53012ae0],_y0=0x7f7f52f7d8f0,_signus=0x7f7f53015ae0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201b830,_y=
 0x7f7f51808990,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f52001c68,_ey=
 0x7f7f5110fc10,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f50930230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fba0,_ctrlden=0x7f7f52002138,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fbd8,_xlast=0x7f7f5110fc48,_ylast=[0x7f7f51112fa8,0x7f7f51112fa8,
 0x7f7f51112fa8],_y0=0x7f7f51113690,_signus=0x7f7f51104a60,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e5f0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f5110ff90,yposition=
 0x7f7f5110fd28,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       51.6   0.222      247.9
Field Avg  1.65                     51.6   0.222      247.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f511128c0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b620,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808888,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d132030,_masks=0x0,_fluxpersub=0x7f7f518091d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a9c0,_skyfluxpersub=0x7f7f5201ade0,
 _nphotons=112.086,_skynphotons=0,_tt=[-0.0069469,-0.00205521],_lastvalidtt=
 [-0.0069469,-0.00205521],_upttcommand=[0,0],_refmes=0x7f7f53184790,_tiprefv=
 0x7f7f53188750,_tiltrefv=0x7f7f53188510,_tiprefvn=0x7f7f53188990,_tiltrefvn=
 0x7f7f53188e10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808150,_jstart=0x7f7f518092d8,_binindices=0x7f7f51294c30,
 _binxy=10,_centroidw=0x7f7f51112f20,_fimage=0x7f7f509a7430,_fimage2=0x0,
 _imistart=0x7f7f518093e0,_imjstart=0x7f7f5201acd8,_imistart2=0x7f7f5201a7b0,
 _imjstart2=0x7f7f51081b28,_unittip=0x7f7f51159c30,_unittilt=0x7f7f5122fc30,
 _lgs_defocuses=0x7f7f5110ee08,_unitdefocus=0x10c243030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5126ba30,_flat=0x7f7f51197a30,_domask=1,
 _submask=0x7f7f51194030,_kernel=0x7f7f512bfc30,_kernels=0x10c459030,_kerfftr=
 0x10c399030,_kerffti=0x10c572030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509b9030,_x=0x7f7f52ef27f0,_y=0x7f7f530efcb0,_centroidgain=1,_rayleigh=
 0x7f7f5110ec10,_bckgrdcalib=0x7f7f51264830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001e28,_ctrlden=0x7f7f51104ad0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808990,_xlast=0x7f7f5201a288,_ylast=[0x7f7f52f7d8f0,
 0x7f7f52f7d8f0,0x7f7f52f7d8f0],_y0=0x7f7f53189050,_signus=0x7f7f53184220,
 _puppixoffset=[0,0],_nact=45,_def=0x10f1d4030,_x=0x7f7f5201b728,_y=
 0x7f7f5201b830,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f52001f08,_ey=
 0x7f7f5110fac0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f52001db8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002138,_xlast=0x7f7f520023d8,_ylast=[0x7f7f51113030,0x7f7f51113030,
 0x7f7f51113030],_y0=0x7f7f51112528,_signus=0x7f7f5110fbd8,_puppixoffset=[0,0],
 _nact=2,_def=0x10beea030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fc48,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f511049b8,yposition=
 0x7f7f52002a30,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       74.3   0.077      313.6
Field Avg  1.65                     74.3   0.077      313.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51111ca8,winddir=0x7f7f51111fd8,
 _layeralt=0x7f7f51112ae0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110ecb8,lgs_prof_alt=
 0x7f7f5110eba0,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808db0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019d60,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cadb030,_masks=0x0,_fluxpersub=0x7f7f5201a7b0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081b28,_skyfluxpersub=0x7f7f518091d0,
 _nphotons=112.086,_skynphotons=0,_tt=[0.0206947,-0.00817851],_lastvalidtt=
 [0.0206947,-0.00817851],_upttcommand=[0,0],_refmes=0x7f7f5069f210,_tiprefv=
 0x7f7f53102360,_tiltrefv=0x7f7f53187cc0,_tiprefvn=0x7f7f53188750,_tiltrefvn=
 0x7f7f53188510,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808ba0,_jstart=0x7f7f51808888,_binindices=0x7f7f5126ba30,
 _binxy=10,_centroidw=0x7f7f51112fa8,_fimage=0x7f7f5122ae30,_fimage2=0x0,
 _imistart=0x7f7f5201a9c0,_imjstart=0x7f7f5201b0f8,_imistart2=0x7f7f518093e0,
 _imjstart2=0x7f7f5201acd8,_unittip=0x7f7f5092ea30,_unittilt=0x7f7f5092f230,
 _lgs_defocuses=0x7f7f5110ed60,_unitdefocus=0x10c2ea030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5187e430,_flat=0x7f7f51815a30,_domask=1,
 _submask=0x7f7f51812030,_kernel=0x7f7f51197a30,_kernels=0x10c4d9030,_kerfftr=
 0x10c95c030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511de630,_x=0x7f7f5300fb80,_y=0x7f7f53007cf0,_centroidgain=1,_rayleigh=
 0x7f7f5110ee08,_bckgrdcalib=0x7f7f51877230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511071d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002410,_ctrlden=0x7f7f52001f08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b830,_xlast=0x7f7f51808990,_ylast=[0x7f7f5069f350,
 0x7f7f5069f350,0x7f7f5069f350],_y0=0x7f7f506a02e0,_signus=0x7f7f506a2f90,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201b410,_y=
 0x7f7f5201b728,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110ff90,_ey=
 0x7f7f52001ca0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a288,
 _flat_command=0x0,_extrapcmat=0x7f7f5119ec30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002288,_ctrlden=0x7f7f52001df0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001db8,_xlast=0x7f7f52001e28,_ylast=[0x7f7f51113938,0x7f7f51113938,
 0x7f7f51113938],_y0=0x7f7f511137a0,_signus=0x7f7f52002138,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520023d8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104b78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002448,xposition=0x7f7f51110000,yposition=
 0x7f7f5110e5f0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001cd8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.029      328.8
Field Avg  1.65                    200.0   0.029      328.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51113938)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201aac8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b308,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c8b1030,_masks=0x0,_fluxpersub=0x7f7f52019d60,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808db0,_skyfluxpersub=0x7f7f5201a288,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00484454,-0.00713454],_lastvalidtt=
 [-0.00484454,-0.00713454],_upttcommand=[0,0],_refmes=0x7f7f533e0fc0,_tiprefv=
 0x7f7f5069f0d0,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f5069f310,_tiltrefvn=
 0x7f7f506ada80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b0f8,_jstart=0x7f7f5201a9c0,_binindices=0x7f7f50943830,
 _binxy=10,_centroidw=0x7f7f51113030,_fimage=0x7f7f51279430,_fimage2=0x0,
 _imistart=0x7f7f51808780,_imjstart=0x7f7f518091d0,_imistart2=0x7f7f51081b28,
 _imjstart2=0x7f7f5201a7b0,_unittip=0x7f7f51156830,_unittilt=0x7f7f511a0830,
 _lgs_defocuses=0x7f7f5110e510,_unitdefocus=0x10bda8030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5094ac30,_flat=0x7f7f509cbc30,_domask=1,
 _submask=0x7f7f509c8230,_kernel=0x7f7f509d5830,_kernels=0x10c4d9030,_kerfftr=
 0x10c95c030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51229630,_x=0x7f7f5300fb60,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f51107198,_bckgrdcalib=0x7f7f509f0a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001d10,_ctrlden=0x7f7f5110e660,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808990,_xlast=0x7f7f5201b410,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f531022f0,_signus=0x7f7f53287320,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f51081810,_y=
 0x7f7f5201b728,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f511049b8,_ey=
 0x7f7f52001c68,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a5a0,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110eb30,_ctrlden=0x7f7f511048d8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e5f0,_xlast=0x7f7f51105588,_ylast=[0x7f7f511130b8,0x7f7f511130b8,
 0x7f7f511130b8],_y0=0x7f7f51111db8,_signus=0x7f7f5110ec10,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fe08,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f52002448,yposition=
 0x7f7f51110000,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.0   0.356      192.2
Field Avg  1.65                     47.0   0.356      192.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f511131c8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808150,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a6a8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c243030,_masks=0x0,_fluxpersub=0x7f7f51081b28,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a7b0,_skyfluxpersub=0x7f7f52019d60,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00296915,0.00133805],_lastvalidtt=
 [-0.00296915,0.00133805],_upttcommand=[0,0],_refmes=0x7f7f53281720,_tiprefv=
 0x7f7f506ad840,_tiltrefv=0x7f7f5327d980,_tiprefvn=0x7f7f5069f0d0,_tiltrefvn=
 0x7f7f5327dbc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808fc0,_jstart=0x7f7f5201b308,_binindices=0x7f7f5122f430,
 _binxy=10,_centroidw=0x7f7f51113ad0,_fimage=0x7f7f5126d230,_fimage2=0x0,
 _imistart=0x7f7f51808db0,_imjstart=0x7f7f51022b80,_imistart2=0x7f7f51808780,
 _imjstart2=0x7f7f518091d0,_unittip=0x7f7f5092ea30,_unittilt=0x7f7f5094dc30,
 _lgs_defocuses=0x7f7f511055c0,_unitdefocus=0x10c418030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51197a30,_flat=0x7f7f51194030,_domask=1,
 _submask=0x7f7f51279c30,_kernel=0x7f7f5123a230,_kernels=0x10c559030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51269830,_x=0x7f7f52934b80,_y=0x7f7f5327de00,_centroidgain=1,_rayleigh=
 0x7f7f5110e510,_bckgrdcalib=0x7f7f5118ce30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055f8,_ctrlden=0x7f7f5110ebd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b728,_xlast=0x7f7f51808990,_ylast=[0x7f7f533e0740,
 0x7f7f533e0740,0x7f7f533e0740],_y0=0x7f7f533e2010,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f51808ba0,_y=
 0x7f7f51081810,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f51104b78,_ey=
 0x7f7f51104d00,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b410,
 _flat_command=0x0,_extrapcmat=0x7f7f509bf630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001d80,_ctrlden=0x7f7f5110fcb8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511048d8,_xlast=0x7f7f52001d10,_ylast=[0x7f7f51113690,0x7f7f51113690,
 0x7f7f51113690],_y0=0x7f7f511128c0,_signus=0x7f7f5110e5f0,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51105588,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110eac0,yposition=
 0x7f7f52001e98,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.556      141.6
Field Avg  1.65                     44.5   0.556      141.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51112bf0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019a48,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808258,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c2ea030,_masks=0x0,_fluxpersub=0x7f7f51808780,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518091d0,_skyfluxpersub=0x7f7f51081b28,
 _nphotons=28154.7,_skynphotons=0,_tt=[0.000195912,-0.000702857],_lastvalidtt=
 [0.000195912,-0.000702857],_upttcommand=[0,0],_refmes=0x7f7f53281720,_tiprefv=
 0x7f7f5327ede0,_tiltrefv=0x7f7f5327de00,_tiprefvn=0x7f7f5327f020,_tiltrefvn=
 0x7f7f5327d980,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518092d8,_jstart=0x7f7f5201a6a8,_binindices=0x7f7f509dca30,
 _binxy=10,_centroidw=0x7f7f511130b8,_fimage=0x7f7f518c4a30,_fimage2=0x0,
 _imistart=0x7f7f5201a7b0,_imjstart=0x7f7f51808048,_imistart2=0x7f7f51808db0,
 _imjstart2=0x7f7f51022b80,_unittip=0x7f7f5092f230,_unittilt=0x7f7f5095be30,
 _lgs_defocuses=0x7f7f52002170,_unitdefocus=0x10c16f030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50970e30,_flat=0x7f7f5094ac30,_domask=1,
 _submask=0x7f7f5096d430,_kernel=0x7f7f50935e30,_kernels=0x10c459030,_kerfftr=
 0x10c95c030,_kerffti=0x10c670030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f518c8430,_x=0x7f7f5327f260,_y=0x7f7f53188510,_centroidgain=1,_rayleigh=
 0x7f7f511055c0,_bckgrdcalib=0x7f7f5094e630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51107198,_ctrlden=0x7f7f51110038,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081810,_xlast=0x7f7f5201b728,_ylast=[0x7f7f533e1f70,
 0x7f7f533e1f70,0x7f7f533e1f70],_y0=0x7f7f533e1d10,_signus=0x7f7f530efc20,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201a8b8,_y=
 0x7f7f51808ba0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f52002448,_ey=
 0x7f7f51104e18,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808990,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029c0,_ctrlden=0x7f7f51104b78,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fcb8,_xlast=0x7f7f511055f8,_ylast=[0x7f7f51113e00,0x7f7f51113e00,
 0x7f7f51113e00],_y0=0x7f7f51113e88,_signus=0x7f7f511048d8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001d10,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110e970,yposition=
 0x7f7f5110fe08,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       60.6   0.079      414.8
Field Avg  1.65                     60.6   0.079      414.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51112e98)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019c58,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808888,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c730030,_masks=0x0,_fluxpersub=0x7f7f51808db0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51022b80,_skyfluxpersub=0x7f7f51808780,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00378757,-0.0163035],_lastvalidtt=
 [-0.00378757,-0.0163035],_upttcommand=[0,0],_refmes=0x7f7f533df340,_tiprefv=
 0x7f7f533e05e0,_tiltrefv=0x7f7f528b28e0,_tiprefvn=0x7f7f533e0820,_tiltrefvn=
 0x7f7f533e0010,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808570,_jstart=0x7f7f51808258,_binindices=0x7f7f509dca30,
 _binxy=10,_centroidw=0x7f7f51113690,_fimage=0x7f7f51283830,_fimage2=0x0,
 _imistart=0x7f7f518091d0,_imjstart=0x7f7f5201b620,_imistart2=0x7f7f5201a7b0,
 _imjstart2=0x7f7f51808048,_unittip=0x7f7f51273a30,_unittilt=0x7f7f51274230,
 _lgs_defocuses=0x7f7f52002a30,_unitdefocus=0x10c350030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509c8230,_flat=0x7f7f5094e630,_domask=1,
 _submask=0x7f7f5094ac30,_kernel=0x7f7f50947230,_kernels=0x10c559030,_kerfftr=
 0x10c399030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51274a30,_x=0x7f7f5300fb60,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f52002170,_bckgrdcalib=0x7f7f509cbc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104d00,_ctrlden=0x7f7f5110eb30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ba0,_xlast=0x7f7f51081810,_ylast=[0x7f7f53280670,
 0x7f7f53280670,0x7f7f53280670],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f5201a5a0,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f5110eac0,_ey=
 0x7f7f5110fd28,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b728,
 _flat_command=0x0,_extrapcmat=0x7f7f5095be30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002448,_ctrlden=0x7f7f520028a8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104b78,_xlast=0x7f7f51107198,_ylast=[0x7f7f51111d30,0x7f7f51111d30,
 0x7f7f51111d30],_y0=0x7f7f51112390,_signus=0x7f7f5110fcb8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511055f8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110e6d0,yposition=
 0x7f7f51105588,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      206.3   0.028      333.9
Field Avg  1.65                    206.3   0.028      333.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51112c78)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808eb8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a288,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bda8030,_masks=0x0,_fluxpersub=0x7f7f5201a7b0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808048,_skyfluxpersub=0x7f7f51808db0,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00443481,-0.00782223],_lastvalidtt=
 [-0.00443481,-0.00782223],_upttcommand=[0,0],_refmes=0x7f7f507ac300,_tiprefv=
 0x7f7f5069f0d0,_tiltrefv=0x7f7f53287560,_tiprefvn=0x7f7f5069f310,_tiltrefvn=
 0x7f7f5327c890,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a498,_jstart=0x7f7f51808888,_binindices=0x7f7f51897630,
 _binxy=10,_centroidw=0x7f7f51113e00,_fimage=0x7f7f509c1030,_fimage2=0x0,
 _imistart=0x7f7f51022b80,_imjstart=0x7f7f5201ade0,_imistart2=0x7f7f518091d0,
 _imjstart2=0x7f7f5201b620,_unittip=0x7f7f5115b430,_unittilt=0x7f7f51156830,
 _lgs_defocuses=0x7f7f51104ec0,_unitdefocus=0x10bf36030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50935e30,_flat=0x7f7f5094e630,_domask=1,
 _submask=0x7f7f50952030,_kernel=0x7f7f5180a030,_kernels=0x10c459030,_kerfftr=
 0x10c670030,_kerffti=0x10c95c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509c4a30,_x=0x7f7f5300fb60,_y=0x7f7f533e09a0,_centroidgain=1,_rayleigh=
 0x7f7f52002a30,_bckgrdcalib=0x7f7f50943830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029c0,_ctrlden=0x7f7f52002410,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a8b8,_xlast=0x7f7f51808ba0,_ylast=[0x7f7f533e05e0,
 0x7f7f533e05e0,0x7f7f533e05e0],_y0=0x7f7f528b28e0,_signus=0x7f7f530efc20,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201b410,_y=
 0x7f7f5201a5a0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f5110e970,_ey=
 0x7f7f520021a8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f51897030,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ecb8,_ctrlden=0x7f7f5110fc10,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f520028a8,_xlast=0x7f7f51104d00,_ylast=[0x7f7f511132d8,0x7f7f511132d8,
 0x7f7f511132d8],_y0=0x7f7f51112d00,_signus=0x7f7f51104b78,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51107198,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110e858,yposition=
 0x7f7f52001d10,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.334      197.3
Field Avg  1.65                     47.3   0.334      197.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51113580)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081a20,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019d60,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c418030,_masks=0x0,_fluxpersub=0x7f7f518091d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b620,_skyfluxpersub=0x7f7f5201a7b0,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00505009,0.00124475],_lastvalidtt=
 [-0.00505009,0.00124475],_upttcommand=[0,0],_refmes=0x7f7f52934ce0,_tiprefv=
 0x7f7f533e0010,_tiltrefv=0x7f7f533e0840,_tiprefvn=0x7f7f533e0250,_tiltrefvn=
 0x7f7f533e1200,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808780,_jstart=0x7f7f5201a288,_binindices=0x7f7f5122a630,
 _binxy=10,_centroidw=0x7f7f51111d30,_fimage=0x7f7f509e3230,_fimage2=0x0,
 _imistart=0x7f7f51808048,_imjstart=0x7f7f52019c58,_imistart2=0x7f7f51022b80,
 _imjstart2=0x7f7f5201ade0,_unittip=0x7f7f51065a30,_unittilt=0x7f7f51066230,
 _lgs_defocuses=0x7f7f51104a60,_unitdefocus=0x10c002030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511f5030,_flat=0x7f7f5121bc30,_domask=1,
 _submask=0x7f7f51218230,_kernel=0x7f7f5126d030,_kernels=0x10c559030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5094d430,_x=0x7f7f5300fb60,_y=0x7f7f533e05e0,_centroidgain=1,_rayleigh=
 0x7f7f51104ec0,_bckgrdcalib=0x7f7f511ede30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520021e0,_ctrlden=0x7f7f52001d80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a5a0,_xlast=0x7f7f5201a8b8,_ylast=[0x7f7f532faec0,
 0x7f7f532faec0,0x7f7f532faec0],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f51808990,_y=
 0x7f7f5201b410,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f5110e6d0,_ey=
 0x7f7f5110fba0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ba0,
 _flat_command=0x0,_extrapcmat=0x7f7f51072c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001ca0,_ctrlden=0x7f7f52001d48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fc10,_xlast=0x7f7f520029c0,_ylast=[0x7f7f51113c68,0x7f7f51113c68,
 0x7f7f51113c68],_y0=0x7f7f51113470,_signus=0x7f7f520028a8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51104d00,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f52001ed0,yposition=
 0x7f7f511055f8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.543      146.7
Field Avg  1.65                     44.5   0.543      146.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51113b58)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b518,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081b28,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c16f030,_masks=0x0,_fluxpersub=0x7f7f51022b80,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201ade0,_skyfluxpersub=0x7f7f518091d0,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00138954,0.000728276],_lastvalidtt=
 [-0.00138954,0.000728276],_upttcommand=[0,0],_refmes=0x7f7f5300fb60,_tiprefv=
 0x7f7f533e05e0,_tiltrefv=0x7f7f533e1440,_tiprefvn=0x7f7f533e0010,_tiltrefvn=
 0x7f7f533e0820,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019838,_jstart=0x7f7f52019d60,_binindices=0x7f7f50951e30,
 _binxy=10,_centroidw=0x7f7f511132d8,_fimage=0x7f7f5094d430,_fimage2=0x0,
 _imistart=0x7f7f5201b620,_imjstart=0x7f7f52019a48,_imistart2=0x7f7f51808048,
 _imjstart2=0x7f7f52019c58,_unittip=0x7f7f5093b230,_unittilt=0x7f7f50948c30,
 _lgs_defocuses=0x7f7f51110000,_unitdefocus=0x10c6ef030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52086830,_flat=0x7f7f52064630,_domask=1,
 _submask=0x7f7f52009e30,_kernel=0x7f7f50943830,_kernels=0x10c459030,_kerfftr=
 0x10c95c030,_kerffti=0x10c670030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50935e30,_x=0x7f7f53102070,_y=0x7f7f52934ce0,_centroidgain=1,_rayleigh=
 0x7f7f51104a60,_bckgrdcalib=0x7f7f5207f630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002090,_ctrlden=0x7f7f520021a8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b410,_xlast=0x7f7f5201a5a0,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53187cc0,_signus=0x7f7f5327f200,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f5201b200,_y=
 0x7f7f51808990,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f5110e858,_ey=
 0x7f7f5110ec80,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a8b8,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f520022f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001d48,_xlast=0x7f7f520021e0,_ylast=[0x7f7f51111f50,0x7f7f51111f50,
 0x7f7f51111f50],_y0=0x7f7f51113718,_signus=0x7f7f5110fc10,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520029c0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f51110038,yposition=
 0x7f7f51107198,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.321      217.5
Field Avg  1.65                     47.3   0.321      217.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f511129d0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201abd0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201aac8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c350030,_masks=0x0,_fluxpersub=0x7f7f51808048,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019c58,_skyfluxpersub=0x7f7f51022b80,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00237091,0.00362219],_lastvalidtt=
 [-0.00237091,0.00362219],_upttcommand=[0,0],_refmes=0x7f7f507ac300,_tiprefv=
 0x7f7f507acf20,_tiltrefv=0x7f7f533e05e0,_tiprefvn=0x7f7f507ad160,_tiltrefvn=
 0x7f7f533e0fc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808360,_jstart=0x7f7f51081b28,_binindices=0x7f7f50951e30,
 _binxy=10,_centroidw=0x7f7f51113c68,_fimage=0x7f7f509cac30,_fimage2=0x0,
 _imistart=0x7f7f5201ade0,_imjstart=0x7f7f52019b50,_imistart2=0x7f7f5201b620,
 _imjstart2=0x7f7f52019a48,_unittip=0x7f7f5094cc30,_unittilt=0x7f7f5095be30,
 _lgs_defocuses=0x7f7f5110e660,_unitdefocus=0x10d132030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509ddc30,_flat=0x7f7f509d3030,_domask=1,
 _submask=0x7f7f509cf630,_kernel=0x7f7f50935e30,_kernels=0x10c559030,_kerfftr=
 0x10c399030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5096e430,_x=0x7f7f5327f110,_y=0x7f7f53280670,_centroidgain=1,_rayleigh=
 0x7f7f51110000,_bckgrdcalib=0x7f7f509d6a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110eac0,_ctrlden=0x7f7f52001ca0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808990,_xlast=0x7f7f5201b410,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f53188510,_signus=0x7f7f5327d3d0,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f51081810,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f52001ed0,_ey=
 0x7f7f51104ad0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a5a0,
 _flat_command=0x0,_extrapcmat=0x7f7f51072c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fe08,_ctrlden=0x7f7f5110e970,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f520022f8,_xlast=0x7f7f52002090,_ylast=[0x7f7f51111b10,0x7f7f51111b10,
 0x7f7f51111b10],_y0=0x7f7f51112d88,_signus=0x7f7f52001d48,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520021e0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110e4d8,yposition=
 0x7f7f51104d00,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      246.5   0.022      369.3
Field Avg  1.65                    246.5   0.022      369.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51112948)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807e38,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808db0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bf36030,_masks=0x0,_fluxpersub=0x7f7f5201b620,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019a48,_skyfluxpersub=0x7f7f51808048,
 _nphotons=112.086,_skynphotons=0,_tt=[-0.00575283,-0.000259146],_lastvalidtt=
 [-0.00575283,-0.000259146],_upttcommand=[0,0],_refmes=0x7f7f5069f210,_tiprefv=
 0x7f7f5327d0a0,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f5327d980,_tiltrefvn=
 0x7f7f5327de00,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aff0,_jstart=0x7f7f5201aac8,_binindices=0x7f7f51197a30,
 _binxy=10,_centroidw=0x7f7f51111f50,_fimage=0x7f7f52064630,_fimage2=0x0,
 _imistart=0x7f7f52019c58,_imjstart=0x7f7f51808150,_imistart2=0x7f7f5201ade0,
 _imjstart2=0x7f7f52019b50,_unittip=0x7f7f50930a30,_unittilt=0x7f7f5093b230,
 _lgs_defocuses=0x7f7f51105630,_unitdefocus=0x10cadb030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5127a030,_flat=0x7f7f51276630,_domask=1,
 _submask=0x7f7f51264830,_kernel=0x7f7f5126ba30,_kernels=0x10c459030,_kerfftr=
 0x10c670030,_kerffti=0x10c95c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f52009e30,_x=0x7f7f532876b0,_y=0x7f7f53188510,_centroidgain=1,_rayleigh=
 0x7f7f5110e660,_bckgrdcalib=0x7f7f5126f430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc48,_ctrlden=0x7f7f51104a60,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b200,_xlast=0x7f7f51808990,_ylast=[0x7f7f533e12f0,
 0x7f7f533e12f0,0x7f7f533e12f0],_y0=0x7f7f533e0010,_signus=0x7f7f533e1e90,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f51808ba0,_y=
 0x7f7f51081810,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f51110038,_ey=
 0x7f7f520029f8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b410,
 _flat_command=0x0,_extrapcmat=0x7f7f509bf630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc80,_ctrlden=0x7f7f51104ec0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e970,_xlast=0x7f7f5110eac0,_ylast=[0x7f7f51113250,0x7f7f51113250,
 0x7f7f51113250],_y0=0x7f7f51112838,_signus=0x7f7f520022f8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002090,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f511049b8,yposition=
 0x7f7f520029c0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       77.9   0.091      268.1
Field Avg  1.65                     77.9   0.091      268.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f511120e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5100e908,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a7b0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f5201ade0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019b50,_skyfluxpersub=0x7f7f5201b620,
 _nphotons=112.086,_skynphotons=0,_tt=[0.00580059,0.00202341],_lastvalidtt=
 [0.00580059,0.00202341],_upttcommand=[0,0],_refmes=0x7f7f507ac1c0,_tiprefv=
 0x7f7f528b28e0,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f533e05e0,_tiltrefvn=
 0x7f7f506ada80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51022b80,_jstart=0x7f7f51808db0,_binindices=0x7f7f520a8630,
 _binxy=10,_centroidw=0x7f7f51111b10,_fimage=0x7f7f51199230,_fimage2=0x0,
 _imistart=0x7f7f52019a48,_imjstart=0x7f7f5201abd0,_imistart2=0x7f7f52019c58,
 _imjstart2=0x7f7f51808150,_unittip=0x7f7f52008630,_unittilt=0x7f7f5209d230,
 _lgs_defocuses=0x7f7f52002170,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51875c30,_flat=0x7f7f5180a030,_domask=1,
 _submask=0x7f7f51812030,_kernel=0x7f7f50935e30,_kernels=0x10c559030,_kerfftr=
 0x10c5f1030,_kerffti=0x10c399030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51264830,_x=0x7f7f507ac790,_y=0x7f7f507aecc0,_centroidgain=1,_rayleigh=
 0x7f7f51105630,_bckgrdcalib=0x7f7f51868030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fe08,_ctrlden=0x7f7f52001fb0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081810,_xlast=0x7f7f5201b200,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f5201a8b8,_y=
 0x7f7f51808ba0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bd06030,_ex=0x7f7f5110e4d8,_ey=
 0x7f7f5110fac0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808990,
 _flat_command=0x0,_extrapcmat=0x7f7f5181f630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fba0,_ctrlden=0x7f7f5110fcb8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104ec0,_xlast=0x7f7f5110fc48,_ylast=[0x7f7f51112a58,0x7f7f51112a58,
 0x7f7f51112a58],_y0=0x7f7f51112308,_signus=0x7f7f5110e970,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110eac0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f5110ebd8,yposition=
 0x7f7f520021e0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       52.5   0.221      247.9
Field Avg  1.65                     52.5   0.221      247.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51113828)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a9c0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518091d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c6ef030,_masks=0x0,_fluxpersub=0x7f7f52019c58,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808150,_skyfluxpersub=0x7f7f5201ade0,
 _nphotons=112.086,_skynphotons=0,_tt=[0.0188722,-0.000440428],_lastvalidtt=
 [0.0188722,-0.000440428],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f533e0250,_tiltrefv=0x7f7f533e0010,_tiprefvn=0x7f7f528b28e0,_tiltrefvn=
 0x7f7f533e0fc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a078,_jstart=0x7f7f5201a7b0,_binindices=0x7f7f509d5430,
 _binxy=10,_centroidw=0x7f7f51113250,_fimage=0x7f7f509d8e30,_fimage2=0x0,
 _imistart=0x7f7f52019b50,_imjstart=0x7f7f5201b518,_imistart2=0x7f7f52019a48,
 _imjstart2=0x7f7f5201abd0,_unittip=0x7f7f50957830,_unittilt=0x7f7f5095ce30,
 _lgs_defocuses=0x7f7f52001d10,_unitdefocus=0x10c243030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509ee830,_flat=0x7f7f509e3c30,_domask=1,
 _submask=0x7f7f50953030,_kernel=0x7f7f509e0230,_kernels=0x10c459030,_kerfftr=
 0x10c95c030,_kerffti=0x10c670030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509dc830,_x=0x7f7f532fb1f0,_y=0x7f7f5327d0a0,_centroidgain=1,_rayleigh=
 0x7f7f52002170,_bckgrdcalib=0x7f7f509e7630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001cd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e858,_ctrlden=0x7f7f52002250,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ba0,_xlast=0x7f7f51081810,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f52934b80,_signus=0x7f7f531022f0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d173030,_x=0x7f7f518090c8,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f511049b8,_ey=
 0x7f7f52002218,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b200,
 _flat_command=0x0,_extrapcmat=0x7f7f50935e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f51110000,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fcb8,_xlast=0x7f7f5110fe08,_ylast=[0x7f7f51111db8,0x7f7f51111db8,
 0x7f7f51111db8],_y0=0x7f7f5100b450,_signus=0x7f7f51104ec0,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd78030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fc48,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f52001d80,yposition=
 0x7f7f52002090,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       74.9   0.076      313.6
Field Avg  1.65                     74.9   0.076      313.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f511137a0,
 _layeralt=0x7f7f51113030)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002288,lgs_prof_alt=
 0x7f7f5110ff90,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b308,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808eb8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d132030,_masks=0x0,_fluxpersub=0x7f7f52019a48,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201abd0,_skyfluxpersub=0x7f7f52019c58,
 _nphotons=112.086,_skynphotons=0,_tt=[-0.00238354,-0.000731428],_lastvalidtt=
 [-0.00238354,-0.000731428],_upttcommand=[0,0],_refmes=0x7f7f533dfbf0,_tiprefv=
 0x7f7f533e0820,_tiltrefv=0x7f7f533e05e0,_tiprefvn=0x7f7f533e0a60,_tiltrefvn=
 0x7f7f533e0010,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808678,_jstart=0x7f7f518091d0,_binindices=0x7f7f51235430,
 _binxy=10,_centroidw=0x7f7f51112a58,_fimage=0x7f7f51270c30,_fimage2=0x0,
 _imistart=0x7f7f51808150,_imjstart=0x7f7f510814f8,_imistart2=0x7f7f52019b50,
 _imjstart2=0x7f7f5201b518,_unittip=0x7f7f51065a30,_unittilt=0x7f7f51066230,
 _lgs_defocuses=0x7f7f51107160,_unitdefocus=0x10c2ea030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509c4a30,_flat=0x7f7f509c1030,_domask=1,
 _submask=0x7f7f50a69c30,_kernel=0x7f7f50935e30,_kernels=0x10c559030,_kerfftr=
 0x10c399030,_kerffti=0x10c5f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50952c30,_x=0x7f7f533e1fa0,_y=0x7f7f533e3a50,_centroidgain=1,_rayleigh=
 0x7f7f52001d10,_bckgrdcalib=0x7f7f509caa30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001e60)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110faf8,_ctrlden=0x7f7f511055f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a8b8,_xlast=0x7f7f51808ba0,_ylast=[0x7f7f533e0fc0,
 0x7f7f533e0fc0,0x7f7f533e0fc0],_y0=0x7f7f533e0250,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10da7a030,_x=0x7f7f5201b410,_y=
 0x7f7f518090c8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c284030,_ex=0x7f7f5110ebd8,_ey=
 0x7f7f52002448,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511049b8,_ctrlden=0x7f7f5110fac0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51110000,_xlast=0x7f7f5110e858,_ylast=[0x7f7f511128c0,0x7f7f511128c0,
 0x7f7f511128c0],_y0=0x7f7f51113a48,_signus=0x7f7f5110fcb8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd52030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fe08,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001db8,xposition=0x7f7f51104e18,yposition=
 0x7f7f5110eac0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f520023d8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.029      328.8
Field Avg  1.65                    200.0   0.029      328.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f511121f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808eb8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201aee8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c36c030,_masks=0x0,_fluxpersub=0x7f7f51808678,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019c58,_skyfluxpersub=0x7f7f5201abd0,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00429292,-0.00627213],_lastvalidtt=
 [-0.00429292,-0.00627213],_upttcommand=[0,0],_refmes=0x7f7f5069f0d0,_tiprefv=
 0x7f7f507acf60,_tiltrefv=0x7f7f5327d480,_tiprefvn=0x7f7f507ad1a0,_tiltrefvn=
 0x7f7f52935ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808468,_jstart=0x7f7f51808150,_binindices=0x7f7f51203430,
 _binxy=10,_centroidw=0x7f7f51112948,_fimage=0x7f7f50a15430,_fimage2=0x0,
 _imistart=0x7f7f5201a6a8,_imjstart=0x7f7f510814f8,_imistart2=0x7f7f518091d0,
 _imjstart2=0x7f7f51808ca8,_unittip=0x7f7f51065a30,_unittilt=0x7f7f51066230,
 _lgs_defocuses=0x7f7f5110ea18,_unitdefocus=0x10c8f2030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511d5630,_flat=0x7f7f511caa30,_domask=1,
 _submask=0x7f7f511c7030,_kernel=0x7f7f50935e30,_kernels=0x10c972030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c44a030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509dd630,_x=0x7f7f5300fb60,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f52001c68,_bckgrdcalib=0x7f7f511ce430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002410,_ctrlden=0x7f7f5110fb30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b308,_xlast=0x7f7f51081810,_ylast=[0x7f7f507ad3e0,
 0x7f7f507ad3e0,0x7f7f507ad3e0],_y0=0x7f7f507ac650,_signus=0x7f7f507ad640,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f5201b200,_y=
 0x7f7f52019a48,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f52001d80,_ey=
 0x7f7f5110fc80,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081b28,
 _flat_command=0x0,_extrapcmat=0x7f7f52012030,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001cd8,_ctrlden=0x7f7f5110ec80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001e28,_xlast=0x7f7f51104b08,_ylast=[0x7f7f51111db8,0x7f7f51111db8,
 0x7f7f51111db8],_y0=0x7f7f51112f20,_signus=0x7f7f51110038,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110eba0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110ff90,yposition=
 0x7f7f51107160,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.0   0.356      192.2
Field Avg  1.65                     47.0   0.356      192.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113360)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518092d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b620,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10ca71030,_masks=0x0,_fluxpersub=0x7f7f518091d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808ca8,_skyfluxpersub=0x7f7f51808678,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00339523,0.000805532],_lastvalidtt=
 [-0.00339523,0.000805532],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f533e1830,_tiltrefv=0x7f7f533e15f0,_tiprefvn=0x7f7f533e1a70,_tiltrefvn=
 0x7f7f533e1ef0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51807e38,_jstart=0x7f7f5201aee8,_binindices=0x7f7f511dca30,
 _binxy=10,_centroidw=0x7f7f51112c78,_fimage=0x7f7f50a8a230,_fimage2=0x0,
 _imistart=0x7f7f52019c58,_imjstart=0x7f7f5201a9c0,_imistart2=0x7f7f5201a6a8,
 _imjstart2=0x7f7f510814f8,_unittip=0x7f7f51816230,_unittilt=0x7f7f51818a30,
 _lgs_defocuses=0x7f7f52002138,_unitdefocus=0x10c7bc030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51197c30,_flat=0x7f7f51194230,_domask=1,
 _submask=0x7f7f511e0430,_kernel=0x7f7f51190830,_kernels=0x10c548030,_kerfftr=
 0x10c44a030,_kerffti=0x10c972030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a58230,_x=0x7f7f506ae300,_y=0x7f7f506ae5c0,_centroidgain=1,_rayleigh=
 0x7f7f5110ea18,_bckgrdcalib=0x7f7f511e3e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511071d0,_ctrlden=0x7f7f5110ec10,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f52019a48,_xlast=0x7f7f5201b308,_ylast=[0x7f7f52935ab0,
 0x7f7f52935ab0,0x7f7f52935ab0],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f5201a078,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110fac0,_ey=
 0x7f7f5110ffc8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f50a10a30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001ca0,_ctrlden=0x7f7f5110ea50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ec80,_xlast=0x7f7f52002410,_ylast=[0x7f7f51111ca8,0x7f7f51111ca8,
 0x7f7f51111ca8],_y0=0x7f7f51111fd8,_signus=0x7f7f52001e28,_puppixoffset=[0,0],
 _nact=2,_def=0x10c16f030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51104b08,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110fd28,yposition=
 0x7f7f52002170,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.556      141.6
Field Avg  1.65                     44.5   0.556      141.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113938)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081600,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a8b8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c32b030,_masks=0x0,_fluxpersub=0x7f7f5201a6a8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f510814f8,_skyfluxpersub=0x7f7f518091d0,
 _nphotons=28154.7,_skynphotons=0,_tt=[0.000105401,-0.000408255],_lastvalidtt=
 [0.000105401,-0.000408255],_upttcommand=[0,0],_refmes=0x7f7f52935790,_tiprefv=
 0x7f7f532851e0,_tiltrefv=0x7f7f533e1830,_tiprefvn=0x7f7f53287460,_tiltrefvn=
 0x7f7f533e15f0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a498,_jstart=0x7f7f5201b620,_binindices=0x7f7f51194230,
 _binxy=10,_centroidw=0x7f7f51111db8,_fimage=0x7f7f50935e30,_fimage2=0x0,
 _imistart=0x7f7f51808ca8,_imjstart=0x7f7f518095f0,_imistart2=0x7f7f52019c58,
 _imjstart2=0x7f7f5201a9c0,_unittip=0x7f7f5114e830,_unittilt=0x7f7f5115b430,
 _lgs_defocuses=0x7f7f520029c0,_unitdefocus=0x10c807030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511d6c30,_flat=0x7f7f51190830,_domask=1,
 _submask=0x7f7f51207630,_kernel=0x7f7f511ec430,_kernels=0x10c4c9030,_kerfftr=
 0x10c972030,_kerffti=0x10c548030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509f5e30,_x=0x7f7f5300fb60,_y=0x7f7f533e1bd0,_centroidgain=1,_rayleigh=
 0x7f7f52002138,_bckgrdcalib=0x7f7f511da630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001cd8,_ctrlden=0x7f7f5110fb30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b200,_xlast=0x7f7f52019a48,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53187cc0,_signus=0x7f7f52934cc0,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f5100e908,_y=
 0x7f7f5201a078,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c65a030,_ex=0x7f7f5110ff90,_ey=
 0x7f7f5110ed60,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b308,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ebd8,_ctrlden=0x7f7f52001df0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ea50,_xlast=0x7f7f511071d0,_ylast=[0x7f7f511125b0,0x7f7f511125b0,
 0x7f7f511125b0],_y0=0x7f7f511131c8,_signus=0x7f7f5110ec80,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3fa030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002410,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f511048d8,yposition=
 0x7f7f5110eba0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       65.5   0.074      409.7
Field Avg  1.65                     65.5   0.074      409.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f511139c0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807f40,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518094e8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c850030,_masks=0x0,_fluxpersub=0x7f7f52019c58,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a9c0,_skyfluxpersub=0x7f7f5201a6a8,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.0245405,0.00267859],_lastvalidtt=
 [-0.0245405,0.00267859],_upttcommand=[0,0],_refmes=0x7f7f53281720,_tiprefv=
 0x7f7f5327d980,_tiltrefv=0x7f7f5327f0a0,_tiprefvn=0x7f7f532850a0,_tiltrefvn=
 0x7f7f53281930,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808360,_jstart=0x7f7f5201a8b8,_binindices=0x7f7f5200dc30,
 _binxy=10,_centroidw=0x7f7f51111ca8,_fimage=0x7f7f511cfa30,_fimage2=0x0,
 _imistart=0x7f7f510814f8,_imjstart=0x7f7f518096f8,_imistart2=0x7f7f51808ca8,
 _imjstart2=0x7f7f518095f0,_unittip=0x7f7f52008630,_unittilt=0x7f7f52067630,
 _lgs_defocuses=0x7f7f52001f08,_unitdefocus=0x10c002030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5209be30,_flat=0x7f7f52091230,_domask=1,
 _submask=0x7f7f5208d830,_kernel=0x7f7f52086830,_kernels=0x10c44a030,_kerfftr=
 0x10c548030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511d6a30,_x=0x7f7f507ac7b0,_y=0x7f7f507ac320,_centroidgain=1,_rayleigh=
 0x7f7f520029c0,_bckgrdcalib=0x7f7f52094c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002090,_ctrlden=0x7f7f5110ffc8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a078,_xlast=0x7f7f5201b200,_ylast=[0x7f7f533e1d20,
 0x7f7f533e1d20,0x7f7f533e1d20],_y0=0x7f7f533e0f80,_signus=0x7f7f533e2340,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f51081b28,_y=
 0x7f7f5100e908,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c7bc030,_ex=0x7f7f5110fd28,_ey=
 0x7f7f51107198,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52019a48,
 _flat_command=0x0,_extrapcmat=0x7f7f509bf630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001d48,_ctrlden=0x7f7f5110e660,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001df0,_xlast=0x7f7f52001cd8,_ylast=[0x7f7f51113f98,0x7f7f51113f98,
 0x7f7f51113f98],_y0=0x7f7f51112d88,_signus=0x7f7f5110ea50,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511071d0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f520021a8,yposition=
 0x7f7f51104b08,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      206.3   0.028      333.9
Field Avg  1.65                    206.3   0.028      333.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112bf0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081c30,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201abd0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cb1c030,_masks=0x0,_fluxpersub=0x7f7f51808ca8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518095f0,_skyfluxpersub=0x7f7f52019c58,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.0058042,-0.006661],_lastvalidtt=
 [-0.0058042,-0.006661],_upttcommand=[0,0],_refmes=0x7f7f531843c0,_tiprefv=
 0x7f7f507ad970,_tiltrefv=0x7f7f507ac300,_tiprefvn=0x7f7f507adbb0,_tiltrefvn=
 0x7f7f507ae030,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808db0,_jstart=0x7f7f518094e8,_binindices=0x7f7f511d8e30,
 _binxy=10,_centroidw=0x7f7f511125b0,_fimage=0x7f7f512ba030,_fimage2=0x0,
 _imistart=0x7f7f5201a9c0,_imjstart=0x7f7f52019f70,_imistart2=0x7f7f510814f8,
 _imjstart2=0x7f7f518096f8,_unittip=0x7f7f5181ce30,_unittilt=0x7f7f5180a030,
 _lgs_defocuses=0x7f7f51104ec0,_unitdefocus=0x10c730030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511f2230,_flat=0x7f7f511e7630,_domask=1,
 _submask=0x7f7f511e3c30,_kernel=0x7f7f511c7030,_kernels=0x10c4c9030,_kerfftr=
 0x10c972030,_kerffti=0x10c44a030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511df030,_x=0x7f7f506ad840,_y=0x7f7f506ade40,_centroidgain=1,_rayleigh=
 0x7f7f52001f08,_bckgrdcalib=0x7f7f511eb030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ecb8,_ctrlden=0x7f7f5110e740,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5100e908,_xlast=0x7f7f5201a078,_ylast=[0x7f7f533e0f80,
 0x7f7f533e0f80,0x7f7f533e0f80],_y0=0x7f7f533e2b40,_signus=0x7f7f533e3f50,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f51081810,_y=
 0x7f7f51081b28,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f511048d8,_ey=
 0x7f7f52001f40,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b200,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fb30,_ctrlden=0x7f7f51104980,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e660,_xlast=0x7f7f52002090,_ylast=[0x7f7f511129d0,0x7f7f511129d0,
 0x7f7f511129d0],_y0=0x7f7f51113250,_signus=0x7f7f52001df0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c16f030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001cd8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110e970,yposition=
 0x7f7f52002410,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.333      202.3
Field Avg  1.65                     47.3   0.333      202.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f511134f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a288,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808678,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c771030,_masks=0x0,_fluxpersub=0x7f7f510814f8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518096f8,_skyfluxpersub=0x7f7f51808ca8,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00376599,-0.00140823],_lastvalidtt=
 [-0.00376599,-0.00140823],_upttcommand=[0,0],_refmes=0x7f7f533df8a0,_tiprefv=
 0x7f7f506adf20,_tiltrefv=0x7f7f506adce0,_tiprefvn=0x7f7f506ae160,_tiltrefvn=
 0x7f7f506ae5e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a6a8,_jstart=0x7f7f5201abd0,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f51113f98,_fimage=0x7f7f509ec430,_fimage2=0x0,
 _imistart=0x7f7f518095f0,_imjstart=0x7f7f51807f40,_imistart2=0x7f7f5201a9c0,
 _imjstart2=0x7f7f52019f70,_unittip=0x7f7f51066230,_unittilt=0x7f7f51158030,
 _lgs_defocuses=0x7f7f5110fc80,_unitdefocus=0x10bd88030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51194030,_flat=0x7f7f511eea30,_domask=1,
 _submask=0x7f7f5128da30,_kernel=0x7f7f509d6a30,_kernels=0x10c44a030,_kerfftr=
 0x10c548030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509e1830,_x=0x7f7f533e0010,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f51104ec0,_bckgrdcalib=0x7f7f51197a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f5110ee08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081b28,_xlast=0x7f7f5100e908,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f5327daf0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f5201b308,_y=
 0x7f7f51081810,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c36c030,_ex=0x7f7f520021a8,_ey=
 0x7f7f520029f8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a078,
 _flat_command=0x0,_extrapcmat=0x7f7f5180a030,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e468,_ctrlden=0x7f7f51104ad0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104980,_xlast=0x7f7f5110ecb8,_ylast=[0x7f7f511133e8,0x7f7f511133e8,
 0x7f7f511133e8],_y0=0x7f7f51113690,_signus=0x7f7f5110e660,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3fa030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002090,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f511055c0,yposition=
 0x7f7f511071d0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.543      146.7
Field Avg  1.65                     44.5   0.543      146.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51111f50)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808fc0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518091d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c807030,_masks=0x0,_fluxpersub=0x7f7f5201a9c0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019f70,_skyfluxpersub=0x7f7f510814f8,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00221105,-0.000412897],_lastvalidtt=
 [-0.00221105,-0.000412897],_upttcommand=[0,0],_refmes=0x7f7f507ac440,_tiprefv=
 0x7f7f533e4490,_tiltrefv=0x7f7f533e0f80,_tiprefvn=0x7f7f533e46d0,_tiltrefvn=
 0x7f7f533e15f0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808780,_jstart=0x7f7f51808678,_binindices=0x7f7f51196a30,
 _binxy=10,_centroidw=0x7f7f511129d0,_fimage=0x7f7f50946030,_fimage2=0x0,
 _imistart=0x7f7f518096f8,_imjstart=0x7f7f51081600,_imistart2=0x7f7f518095f0,
 _imjstart2=0x7f7f51807f40,_unittip=0x7f7f5115b430,_unittilt=0x7f7f5114fa30,
 _lgs_defocuses=0x7f7f51107160,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f512a7830,_flat=0x7f7f5129cc30,_domask=1,
 _submask=0x7f7f51289430,_kernel=0x7f7f51193030,_kernels=0x10c4c9030,_kerfftr=
 0x10c972030,_kerffti=0x10c44a030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50935e30,_x=0x7f7f533e30f0,_y=0x7f7f533e3ed0,_centroidgain=1,_rayleigh=
 0x7f7f5110fc80,_bckgrdcalib=0x7f7f512a0630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001f40,_ctrlden=0x7f7f520023d8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081810,_xlast=0x7f7f51081b28,_ylast=[0x7f7f533e21f0,
 0x7f7f533e21f0,0x7f7f533e21f0],_y0=0x7f7f533e1830,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f51808ba0,_y=
 0x7f7f5201b308,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c65a030,_ex=0x7f7f5110e970,_ey=
 0x7f7f51104d00,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5100e908,
 _flat_command=0x0,_extrapcmat=0x7f7f5117c230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51105588,_ctrlden=0x7f7f5110fb30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104ad0,_xlast=0x7f7f52002a30,_ylast=[0x7f7f51112528,0x7f7f51112528,
 0x7f7f51112528],_y0=0x7f7f51113828,_signus=0x7f7f51104980,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110ecb8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110fd28,yposition=
 0x7f7f52001cd8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.325      217.5
Field Avg  1.65                     47.3   0.325      217.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113e88)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b0f8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808eb8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f518095f0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807f40,_skyfluxpersub=0x7f7f5201a9c0,
 _nphotons=1776.44,_skynphotons=0,_tt=[0.00578397,-0.000379907],_lastvalidtt=
 [0.00578397,-0.000379907],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f533e2690,_tiltrefv=0x7f7f533e2450,_tiprefvn=0x7f7f533e28d0,_tiltrefvn=
 0x7f7f533e0f80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a390,_jstart=0x7f7f518091d0,_binindices=0x7f7f51285a30,
 _binxy=10,_centroidw=0x7f7f511133e8,_fimage=0x7f7f50935e30,_fimage2=0x0,
 _imistart=0x7f7f52019f70,_imjstart=0x7f7f51809800,_imistart2=0x7f7f518096f8,
 _imjstart2=0x7f7f51081600,_unittip=0x7f7f52064630,_unittilt=0x7f7f52064e30,
 _lgs_defocuses=0x7f7f511048d8,_unitdefocus=0x10c607030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52094c30,_flat=0x7f7f52091230,_domask=1,
 _submask=0x7f7f5208d830,_kernel=0x7f7f51812830,_kernels=0x10c44a030,_kerfftr=
 0x10c548030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50946030,_x=0x7f7f507ac320,_y=0x7f7f507acbc0,_centroidgain=1,_rayleigh=
 0x7f7f51107160,_bckgrdcalib=0x7f7f5200ac30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fba0,_ctrlden=0x7f7f5110ea18,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b308,_xlast=0x7f7f51081810,_ylast=[0x7f7f53281aa0,
 0x7f7f53281aa0,0x7f7f53281aa0],_y0=0x7f7f531022f0,_signus=0x7f7f532850a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f5201b200,_y=
 0x7f7f51808ba0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f511055c0,_ey=
 0x7f7f5110e510,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081b28,
 _flat_command=0x0,_extrapcmat=0x7f7f5119ec30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f5110e468,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fb30,_xlast=0x7f7f52001f40,_ylast=[0x7f7f51113b58,0x7f7f51113b58,
 0x7f7f51113b58],_y0=0x7f7f511132d8,_signus=0x7f7f51104ad0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c16f030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002a30,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110fac0,yposition=
 0x7f7f52002090,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      250.7   0.021      369.3
Field Avg  1.65                    250.7   0.021      369.3
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113f10)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808258,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019c58,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c730030,_masks=0x0,_fluxpersub=0x7f7f518096f8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081600,_skyfluxpersub=0x7f7f518095f0,
 _nphotons=112.086,_skynphotons=0,_tt=[0.00145576,-0.0124906],_lastvalidtt=
 [0.00145576,-0.0124906],_upttcommand=[0,0],_refmes=0x7f7f506adce0,_tiprefv=
 0x7f7f507ac300,_tiltrefv=0x7f7f53281d00,_tiprefvn=0x7f7f507ad2a0,_tiltrefvn=
 0x7f7f52935ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a180,_jstart=0x7f7f51808eb8,_binindices=0x7f7f51197a30,
 _binxy=10,_centroidw=0x7f7f51112528,_fimage=0x7f7f512e3830,_fimage2=0x0,
 _imistart=0x7f7f51807f40,_imjstart=0x7f7f518092d8,_imistart2=0x7f7f52019f70,
 _imjstart2=0x7f7f51809800,_unittip=0x7f7f5114fa30,_unittilt=0x7f7f511d6230,
 _lgs_defocuses=0x7f7f5110bc30,_unitdefocus=0x10c1b8030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5121ae30,_flat=0x7f7f51210230,_domask=1,
 _submask=0x7f7f5120c830,_kernel=0x7f7f5118ce30,_kernels=0x10c972030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c44a030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f52088430,_x=0x7f7f533e1c50,_y=0x7f7f533e2970,_centroidgain=1,_rayleigh=
 0x7f7f511048d8,_bckgrdcalib=0x7f7f51213c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055c0,_ctrlden=0x7f7f52001ca0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ba0,_xlast=0x7f7f5201b308,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f5201a078,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110fd28,_ey=
 0x7f7f5110ff90,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081810,
 _flat_command=0x0,_extrapcmat=0x7f7f50921830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51105630,_ctrlden=0x7f7f520028a8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e468,_xlast=0x7f7f5110fba0,_ylast=[0x7f7f51112308,0x7f7f51112308,
 0x7f7f51112308],_y0=0x7f7f51113c68,_signus=0x7f7f5110fb30,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3fa030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001f40,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f52002218,yposition=
 0x7f7f5110ecb8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       79.8   0.091      268.1
Field Avg  1.65                     79.8   0.091      268.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112390)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019e68,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808ca8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bd88030,_masks=0x0,_fluxpersub=0x7f7f52019f70,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51809800,_skyfluxpersub=0x7f7f518096f8,
 _nphotons=112.086,_skynphotons=0,_tt=[0.000612503,-0.0137667],_lastvalidtt=
 [0.000612503,-0.0137667],_upttcommand=[0,0],_refmes=0x7f7f533df900,_tiprefv=
 0x7f7f5327d980,_tiltrefv=0x7f7f533e18d0,_tiprefvn=0x7f7f53188510,_tiltrefvn=
 0x7f7f533e1b10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a9c0,_jstart=0x7f7f52019c58,_binindices=0x7f7f51197a30,
 _binxy=10,_centroidw=0x7f7f51113b58,_fimage=0x7f7f509ce630,_fimage2=0x0,
 _imistart=0x7f7f51081600,_imjstart=0x7f7f5201b0f8,_imistart2=0x7f7f51807f40,
 _imjstart2=0x7f7f518092d8,_unittip=0x7f7f5115b430,_unittilt=0x7f7f51179830,
 _lgs_defocuses=0x7f7f51104e18,_unitdefocus=0x10c7bc030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509ad430,_flat=0x7f7f50943830,_domask=1,
 _submask=0x7f7f50935e30,_kernel=0x7f7f509d2230,_kernels=0x10c548030,_kerfftr=
 0x10c44a030,_kerffti=0x10c972030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a02e30,_x=0x7f7f530efc20,_y=0x7f7f533e2320,_centroidgain=1,_rayleigh=
 0x7f7f5110bc30,_bckgrdcalib=0x7f7f509c8430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104b78,_ctrlden=0x7f7f5110fc80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b200,_xlast=0x7f7f51808ba0,_ylast=[0x7f7f533e15f0,
 0x7f7f533e15f0,0x7f7f533e15f0],_y0=0x7f7f533e0f80,_signus=0x7f7f533e33f0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f5100e908,_y=
 0x7f7f5201a078,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c65a030,_ex=0x7f7f5110fac0,_ey=
 0x7f7f52001ed0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b308,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e740,_ctrlden=0x7f7f5110ea50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f520028a8,_xlast=0x7f7f511055c0,_ylast=[0x7f7f51111d30,0x7f7f51111d30,
 0x7f7f51111d30],_y0=0x7f7f51112e98,_signus=0x7f7f5110e468,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fba0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f5110fc48,yposition=
 0x7f7f52002a30,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       52.2   0.225      247.9
Field Avg  1.65                     52.2   0.225      247.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112418)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808150,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f510814f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c8b1030,_masks=0x0,_fluxpersub=0x7f7f51807f40,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518092d8,_skyfluxpersub=0x7f7f52019f70,
 _nphotons=112.086,_skynphotons=0,_tt=[0.0113942,-0.0118316],_lastvalidtt=
 [0.0113942,-0.0118316],_upttcommand=[0,0],_refmes=0x7f7f506a03d0,_tiprefv=
 0x7f7f533e2b00,_tiltrefv=0x7f7f5327d980,_tiprefvn=0x7f7f533e2d40,_tiltrefvn=
 0x7f7f53187cc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201acd8,_jstart=0x7f7f51808ca8,_binindices=0x7f7f509b7c30,
 _binxy=10,_centroidw=0x7f7f51112308,_fimage=0x7f7f5127e830,_fimage2=0x0,
 _imistart=0x7f7f51809800,_imjstart=0x7f7f51808fc0,_imistart2=0x7f7f51081600,
 _imjstart2=0x7f7f5201b0f8,_unittip=0x7f7f509d5a30,_unittilt=0x7f7f509cd830,
 _lgs_defocuses=0x7f7f52002410,_unitdefocus=0x10ca71030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50a33630,_flat=0x7f7f509d2030,_domask=1,
 _submask=0x7f7f509a9a30,_kernel=0x7f7f50a8e030,_kernels=0x10c4c9030,_kerfftr=
 0x10c972030,_kerffti=0x10c548030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511dea30,_x=0x7f7f52934b80,_y=0x7f7f532785e0,_centroidgain=1,_rayleigh=
 0x7f7f51104e18,_bckgrdcalib=0x7f7f50a2c430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52002058)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001db8,_ctrlden=0x7f7f51105630,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a078,_xlast=0x7f7f5201b200,_ylast=[0x7f7f52935ab0,
 0x7f7f52935ab0,0x7f7f52935ab0],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10dd79030,_x=0x7f7f5201aac8,_y=
 0x7f7f5100e908,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c1b8030,_ex=0x7f7f52002218,_ey=
 0x7f7f52001d48,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ba0,
 _flat_command=0x0,_extrapcmat=0x7f7f509bf630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002138,_ctrlden=0x7f7f51110038,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ea50,_xlast=0x7f7f51104b78,_ylast=[0x7f7f51112f20,0x7f7f51112f20,
 0x7f7f51112f20],_y0=0x7f7f51113cf0,_signus=0x7f7f520028a8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c16f030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511055c0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f51104b08,yposition=
 0x7f7f52001f40,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       74.7   0.077      313.6
Field Avg  1.65                     74.7   0.077      313.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511137a0,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112948)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520022f8,lgs_prof_alt=
 0x7f7f5110fcb8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201aee8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081c30,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c607030,_masks=0x0,_fluxpersub=0x7f7f51081600,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b0f8,_skyfluxpersub=0x7f7f51807f40,
 _nphotons=112.086,_skynphotons=0,_tt=[-0.0224047,0.0160256],_lastvalidtt=
 [-0.0224047,0.0160256],_upttcommand=[0,0],_refmes=0x7f7f53286880,_tiprefv=
 0x7f7f506ae770,_tiltrefv=0x7f7f507ac650,_tiprefvn=0x7f7f506ae9b0,_tiltrefvn=
 0x7f7f507aca60,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f510810d8,_jstart=0x7f7f510814f8,_binindices=0x7f7f511d9c30,
 _binxy=10,_centroidw=0x7f7f51111d30,_fimage=0x7f7f509b9c30,_fimage2=0x0,
 _imistart=0x7f7f518092d8,_imjstart=0x7f7f51809908,_imistart2=0x7f7f51809800,
 _imjstart2=0x7f7f51808fc0,_unittip=0x7f7f52008630,_unittilt=0x7f7f52064630,
 _lgs_defocuses=0x7f7f5110e4d8,_unitdefocus=0x10c32b030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52082e30,_flat=0x7f7f52078230,_domask=1,
 _submask=0x7f7f5200e630,_kernel=0x7f7f51812830,_kernels=0x10c548030,_kerfftr=
 0x10c44a030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5200ac30,_x=0x7f7f507ac320,_y=0x7f7f507ace00,_centroidgain=1,_rayleigh=
 0x7f7f52002410,_bckgrdcalib=0x7f7f52086830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e6d0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104ec0,_ctrlden=0x7f7f52001ed0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5100e908,_xlast=0x7f7f5201a078,_ylast=[0x7f7f506ae110,
 0x7f7f506ae110,0x7f7f506ae110],_y0=0x7f7f506af6a0,_signus=0x7f7f506adce0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d374030,_x=0x7f7f51081810,_y=
 0x7f7f5201aac8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110fc48,_ey=
 0x7f7f5110ffc8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b200,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001cd8,_ctrlden=0x7f7f520029f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51110038,_xlast=0x7f7f52001db8,_ylast=[0x7f7f51111fd8,0x7f7f51111fd8,
 0x7f7f51111fd8],_y0=0x7f7f51113718,_signus=0x7f7f5110ea50,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3fa030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51104b78,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002250,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e858,xposition=0x7f7f52002288,yposition=
 0x7f7f5110fba0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f511049b8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,ittime=
 0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,jumps2swapscreen=
 0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      207.4
Field Avg  1.65                     44.5   0.495      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f511132d8,winddir=0x7f7f51112b68,
 _layeralt=0x7f7f51112948)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fe08,lgs_prof_alt=
 0x7f7f5110ffc8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518091d0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019c58,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f52019d60,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807e38,_skyfluxpersub=0x7f7f51808780,
 _nphotons=14077.3,_skynphotons=0,_tt=[0.000881039,0.00116949],_lastvalidtt=
 [0.000881039,0.00116949],_upttcommand=[0,0],_refmes=0x7f7f506a03d0,_tiprefv=
 0x7f7f507ac650,_tiltrefv=0x7f7f533e0e20,_tiprefvn=0x7f7f507aca60,_tiltrefvn=
 0x7f7f533e1b80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808048,_jstart=0x7f7f5201b728,_binindices=0x7f7f5180a030,
 _binxy=10,_centroidw=0x7f7f51113828,_fimage=0x7f7f51197e30,_fimage2=0x0,
 _imistart=0x7f7f5201a9c0,_imjstart=0x7f7f51081708,_imistart2=0x7f7f518094e8,
 _imjstart2=0x7f7f5201b308,_unittip=0x7f7f52008630,_unittilt=0x7f7f52004c30,
 _lgs_defocuses=0x7f7f51104d00,_unitdefocus=0x10c548030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5188be30,_flat=0x7f7f51881230,_domask=1,
 _submask=0x7f7f5187d830,_kernel=0x7f7f51879e30,_kernels=0x10c0cb030,_kerfftr=
 0x10beea030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51191430,_x=0x7f7f507acca0,_y=0x7f7f507acf60,_centroidgain=1,_rayleigh=
 0x7f7f5110faf8,_bckgrdcalib=0x7f7f51884c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e4d8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002448,_ctrlden=0x7f7f5110f9a8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081b28,_xlast=0x7f7f5201aff0,_ylast=[0x7f7f533e2450,
 0x7f7f533e2450,0x7f7f533e2450],_y0=0x7f7f533e1dc0,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10ebc1030,_x=0x7f7f510811e0,_y=
 0x7f7f51808570,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c14c030,_ex=0x7f7f520029f8,_ey=
 0x7f7f51107198,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a6a8,
 _flat_command=0x0,_extrapcmat=0x7f7f5119fa30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029c0,_ctrlden=0x7f7f520020c8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fcb8,_xlast=0x7f7f52001f08,_ylast=[0x7f7f51113938,0x7f7f51113938,
 0x7f7f51113938],_y0=0x7f7f51111ca8,_signus=0x7f7f52002138,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fb68,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110eac0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511055f8,xposition=0x7f7f52002288,yposition=
 0x7f7f52001db8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e858,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      207.4
Field Avg  1.65                     44.5   0.495      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113828,winddir=0x7f7f51111ca8,
 _layeralt=0x7f7f511124a0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520029c0,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081708,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808ca8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c850030,_masks=0x0,_fluxpersub=0x7f7f518091d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a6a8,_skyfluxpersub=0x7f7f51808570,
 _nphotons=14077.3,_skynphotons=0,_tt=[0.000811381,0.000398611],_lastvalidtt=
 [0.000811381,0.000398611],_upttcommand=[0,0],_refmes=0x7f7f53281720,_tiprefv=
 0x7f7f507ac650,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f507acca0,_tiltrefvn=
 0x7f7f52935ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a9c0,_jstart=0x7f7f5201b728,_binindices=0x7f7f511c7030,
 _binxy=10,_centroidw=0x7f7f51111f50,_fimage=0x7f7f51191a30,_fimage2=0x0,
 _imistart=0x7f7f51808990,_imjstart=0x7f7f51807e38,_imistart2=0x7f7f52019d60,
 _imjstart2=0x7f7f52019c58,_unittip=0x7f7f50949030,_unittilt=0x7f7f50943e30,
 _lgs_defocuses=0x7f7f52001df0,_unitdefocus=0x10c807030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511e7630,_flat=0x7f7f511dca30,_domask=1,
 _submask=0x7f7f511d1e30,_kernel=0x7f7f511d9030,_kernels=0x10c04b030,_kerfftr=
 0x10beea030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511caa30,_x=0x7f7f5326d610,_y=0x7f7f532875f0,_centroidgain=1,_rayleigh=
 0x7f7f52001e60,_bckgrdcalib=0x7f7f511e0430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001db8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fa88,_ctrlden=0x7f7f511071d0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081b28,_xlast=0x7f7f5201aff0,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f5326e2e0,_signus=0x7f7f53281c60,
 _puppixoffset=[0,0],_nact=45,_def=0x10ebc1030,_x=0x7f7f5201ade0,_y=
 0x7f7f510811e0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f520028a8,_ey=
 0x7f7f52001f40,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a5a0,
 _flat_command=0x0,_extrapcmat=0x7f7f5181f630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001cd8,_ctrlden=0x7f7f52002100,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002288,_xlast=0x7f7f5110fbd8,_ylast=[0x7f7f51112390,0x7f7f51112390,
 0x7f7f51112390],_y0=0x7f7f511139c0,_signus=0x7f7f51104b08,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fc80,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110fcb8,xposition=0x7f7f52001fb0,yposition=
 0x7f7f511055f8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110fb68,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.510      182.1
Field Avg  1.65                     44.1   0.510      182.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113828,winddir=0x7f7f51111ca8,
 _layeralt=0x7f7f51113b58)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520029c0,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518092d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518096f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10be70030,_masks=0x0,_fluxpersub=0x7f7f52019d60,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019c58,_skyfluxpersub=0x7f7f518091d0,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.000657012,-0.000929224],_lastvalidtt=
 [-0.000657012,-0.000929224],_upttcommand=[0,0],_refmes=0x7f7f533e0010,_tiprefv=
 0x7f7f533e30a0,_tiltrefv=0x7f7f533e0150,_tiprefvn=0x7f7f533e32e0,_tiltrefvn=
 0x7f7f533e3760,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aac8,_jstart=0x7f7f51808ca8,_binindices=0x7f7f5180a030,
 _binxy=10,_centroidw=0x7f7f51112838,_fimage=0x7f7f511e0230,_fimage2=0x0,
 _imistart=0x7f7f5201a6a8,_imjstart=0x7f7f5201aee8,_imistart2=0x7f7f51808990,
 _imjstart2=0x7f7f51807e38,_unittip=0x7f7f509d9a30,_unittilt=0x7f7f50946e30,
 _lgs_defocuses=0x7f7f52001d80,_unitdefocus=0x10c2a0030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509c7030,_flat=0x7f7f509c1030,_domask=1,
 _submask=0x7f7f5118ce30,_kernel=0x7f7f51195430,_kernels=0x10c0cb030,_kerfftr=
 0x10c591030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511e4e30,_x=0x7f7f53102070,_y=0x7f7f531022f0,_centroidgain=1,_rayleigh=
 0x7f7f52001df0,_bckgrdcalib=0x7f7f50935e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51104980)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e5f0,_ctrlden=0x7f7f5110ea50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f510811e0,_xlast=0x7f7f51081b28,_ylast=[0x7f7f533e4000,
 0x7f7f533e4000,0x7f7f533e4000],_y0=0x7f7f533e05e0,_signus=0x7f7f533e3520,
 _puppixoffset=[0,0],_nact=45,_def=0x10d132030,_x=0x7f7f51808780,_y=
 0x7f7f5201ade0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110eac0,_ey=
 0x7f7f51104ec0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201aff0,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f5110f7b0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002100,_xlast=0x7f7f5110fa88,_ylast=[0x7f7f511128c0,0x7f7f511128c0,
 0x7f7f511128c0],_y0=0x7f7f51112280,_signus=0x7f7f52002288,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fbd8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110fcb8,xposition=0x7f7f52001c68,yposition=
 0x7f7f5110ebd8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110fb68,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.467      207.4
Field Avg  1.65                     44.5   0.467      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113828,winddir=0x7f7f51111ca8,
 _layeralt=0x7f7f511121f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f520029c0,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518093e0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808fc0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c32b030,_masks=0x0,_fluxpersub=0x7f7f51808990,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807e38,_skyfluxpersub=0x7f7f52019d60,
 _nphotons=70386.7,_skynphotons=0,_tt=[-0.00199955,-0.00057608],_lastvalidtt=
 [-0.00199955,-0.00057608],_upttcommand=[0,0],_refmes=0x7f7f533e0010,_tiprefv=
 0x7f7f533e1db0,_tiltrefv=0x7f7f533e4a20,_tiprefvn=0x7f7f533e1ff0,_tiltrefvn=
 0x7f7f533e0150,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808a98,_jstart=0x7f7f518096f8,_binindices=0x7f7f509c7030,
 _binxy=10,_centroidw=0x7f7f51112390,_fimage=0x7f7f50935e30,_fimage2=0x0,
 _imistart=0x7f7f52019c58,_imjstart=0x7f7f5100e908,_imistart2=0x7f7f5201a6a8,
 _imjstart2=0x7f7f5201aee8,_unittip=0x7f7f50932a30,_unittilt=0x7f7f509cbc30,
 _lgs_defocuses=0x7f7f5110fc10,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509f2c30,_flat=0x7f7f509e8030,_domask=1,
 _submask=0x7f7f509e4630,_kernel=0x7f7f509c1030,_kernels=0x10c610030,_kerfftr=
 0x10c4c9030,_kerffti=0x10beea030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509de630,_x=0x7f7f5327d980,_y=0x7f7f53102070,_centroidgain=1,_rayleigh=
 0x7f7f52001d80,_bckgrdcalib=0x7f7f509eba30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001db8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001cd8,_ctrlden=0x7f7f5110e858,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201ade0,_xlast=0x7f7f510811e0,_ylast=[0x7f7f533e05e0,
 0x7f7f533e05e0,0x7f7f533e05e0],_y0=0x7f7f533e2230,_signus=0x7f7f533e1920,
 _puppixoffset=[0,0],_nact=45,_def=0x10ebc1030,_x=0x7f7f51081c30,_y=
 0x7f7f51808780,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f52001fb0,_ey=
 0x7f7f52001e28,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081b28,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e9e0,_ctrlden=0x7f7f52001e60,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110f7b0,_xlast=0x7f7f5110e5f0,_ylast=[0x7f7f511125b0,0x7f7f511125b0,
 0x7f7f511125b0],_y0=0x7f7f51112e98,_signus=0x7f7f52002100,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fa88,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52002138,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110fcb8,xposition=0x7f7f5110e468,yposition=
 0x7f7f5110fc80,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110fb68,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      207.4
Field Avg  1.65                     44.5   0.495      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f51113250)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081600,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808570,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c690030,_masks=0x0,_fluxpersub=0x7f7f51081810,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518095f0,_skyfluxpersub=0x7f7f510811e0,
 _nphotons=14077.3,_skynphotons=0,_tt=[-0.000349005,0.00139446],_lastvalidtt=
 [-0.000349005,0.00139446],_upttcommand=[0,0],_refmes=0x7f7f507ac650,_tiprefv=
 0x7f7f507aca60,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f507acca0,_tiltrefvn=
 0x7f7f52935ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b518,_jstart=0x7f7f51807e38,_binindices=0x7f7f5207f430,
 _binxy=10,_centroidw=0x7f7f511125b0,_fimage=0x7f7f509d0630,_fimage2=0x0,
 _imistart=0x7f7f518096f8,_imjstart=0x7f7f51808990,_imistart2=0x7f7f5201aee8,
 _imjstart2=0x7f7f5201a6a8,_unittip=0x7f7f52008630,_unittilt=0x7f7f52004c30,
 _lgs_defocuses=0x7f7f51106fd8,_unitdefocus=0x10cb1c030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f520a6c30,_flat=0x7f7f5209c030,_domask=1,
 _submask=0x7f7f52098630,_kernel=0x7f7f52094c30,_kernels=0x10c04b030,_kerfftr=
 0x10c14c030,_kerffti=0x10c591030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50935e30,_x=0x7f7f507ac380,_y=0x7f7f507ad040,_centroidgain=1,_rayleigh=
 0x7f7f51106f68,_bckgrdcalib=0x7f7f5209fa30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110fbd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f938,_ctrlden=0x7f7f520022f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201ade0,_xlast=0x7f7f5201a5a0,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201aff0,_y=
 0x7f7f51081c30,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110e468,_ey=
 0x7f7f5110ec48,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808db0,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f9e0,_ctrlden=0x7f7f5110fc48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e970,_xlast=0x7f7f52001d10,_ylast=[0x7f7f51112f20,0x7f7f51112f20,
 0x7f7f51112f20],_y0=0x7f7f51111b10,_signus=0x7f7f52001d80,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110eb68,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f5110e4d8,yposition=
 0x7f7f5110fcb8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.509      182.1
Field Avg  1.65                     44.1   0.509      182.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f511131c8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808fc0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201abd0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c2a0030,_masks=0x0,_fluxpersub=0x7f7f5201aee8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a6a8,_skyfluxpersub=0x7f7f51081810,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.000728216,-0.00114225],_lastvalidtt=
 [-0.000728216,-0.00114225],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f533e1750,_tiltrefv=0x7f7f533e0010,_tiprefvn=0x7f7f533e1990,_tiltrefvn=
 0x7f7f533e1e10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019838,_jstart=0x7f7f51808570,_binindices=0x7f7f509f2e30,
 _binxy=10,_centroidw=0x7f7f511137a0,_fimage=0x7f7f50994a30,_fimage2=0x0,
 _imistart=0x7f7f518095f0,_imjstart=0x7f7f5201a078,_imistart2=0x7f7f518096f8,
 _imjstart2=0x7f7f51808990,_unittip=0x7f7f50938e30,_unittilt=0x7f7f50939630,
 _lgs_defocuses=0x7f7f51106ec0,_unitdefocus=0x10c25f030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50a0c230,_flat=0x7f7f50a01630,_domask=1,
 _submask=0x7f7f509fdc30,_kernel=0x7f7f509ef430,_kernels=0x10beb1030,_kerfftr=
 0x10c591030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509e5c30,_x=0x7f7f53102070,_y=0x7f7f531022f0,_centroidgain=1,_rayleigh=
 0x7f7f51106fd8,_bckgrdcalib=0x7f7f50a05030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ee08)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51107080,_ctrlden=0x7f7f5110fa18,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081c30,_xlast=0x7f7f5201ade0,_ylast=[0x7f7f533e4590,
 0x7f7f533e4590,0x7f7f533e4590],_y0=0x7f7f533e26a0,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d132030,_x=0x7f7f5201a8b8,_y=
 0x7f7f5201aff0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f52002138,_ey=
 0x7f7f5110e740,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a5a0,
 _flat_command=0x0,_extrapcmat=0x7f7f50949630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f900,_ctrlden=0x7f7f5110ebd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fc48,_xlast=0x7f7f5110f938,_ylast=[0x7f7f51113d78,0x7f7f51113d78,
 0x7f7f51113d78],_y0=0x7f7f51111d30,_signus=0x7f7f5110e970,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001d10,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f511055f8,yposition=
 0x7f7f511071d0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.467      207.4
Field Avg  1.65                     44.5   0.467      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f51112a58)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a498,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518091d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c730030,_masks=0x0,_fluxpersub=0x7f7f518096f8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808990,_skyfluxpersub=0x7f7f5201aee8,
 _nphotons=70386.7,_skynphotons=0,_tt=[-0.00180176,-0.000305884],_lastvalidtt=
 [-0.00180176,-0.000305884],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f533e2430,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f533e0250,_tiltrefvn=
 0x7f7f53280fa0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51081b28,_jstart=0x7f7f5201abd0,_binindices=0x7f7f5200ac30,
 _binxy=10,_centroidw=0x7f7f51112f20,_fimage=0x7f7f5118ce30,_fimage2=0x0,
 _imistart=0x7f7f5201a6a8,_imjstart=0x7f7f51081708,_imistart2=0x7f7f518095f0,
 _imjstart2=0x7f7f5201a078,_unittip=0x7f7f511ca030,_unittilt=0x7f7f511ce430,
 _lgs_defocuses=0x7f7f511048d8,_unitdefocus=0x10c002030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509d0630,_flat=0x7f7f509ccc30,_domask=1,
 _submask=0x7f7f509e4c30,_kernel=0x7f7f50935e30,_kernels=0x10c0cb030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50978630,_x=0x7f7f5300fb60,_y=0x7f7f533e15f0,_centroidgain=1,_rayleigh=
 0x7f7f51106ec0,_bckgrdcalib=0x7f7f509c1030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110fbd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e9e0,_ctrlden=0x7f7f5110ec48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201aff0,_xlast=0x7f7f51081c30,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51808360,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110e4d8,_ey=
 0x7f7f511070b8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201ade0,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e628,_ctrlden=0x7f7f52002988,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ebd8,_xlast=0x7f7f51107080,_ylast=[0x7f7f511132d8,0x7f7f511132d8,
 0x7f7f511132d8],_y0=0x7f7f51113cf0,_signus=0x7f7f5110fc48,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110f938,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f51110000,yposition=
 0x7f7f5110eb68,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.9   0.461      222.6
Field Avg  1.65                     44.9   0.461      222.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f511134f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019d60,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bf31030,_masks=0x0,_fluxpersub=0x7f7f518095f0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a078,_skyfluxpersub=0x7f7f518096f8,
 _nphotons=888.22,_skynphotons=0,_tt=[-0.00529282,-0.00864537],_lastvalidtt=
 [-0.00529282,-0.00864537],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f533e08c0,_tiltrefv=0x7f7f507ae350,_tiprefvn=0x7f7f533e0b00,_tiltrefvn=
 0x7f7f507ae590,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f510814f8,_jstart=0x7f7f518091d0,_binindices=0x7f7f50967c30,
 _binxy=10,_centroidw=0x7f7f51113d78,_fimage=0x7f7f51812830,_fimage2=0x0,
 _imistart=0x7f7f51808990,_imjstart=0x7f7f518092d8,_imistart2=0x7f7f5201a6a8,
 _imjstart2=0x7f7f51081708,_unittip=0x7f7f5114fa30,_unittilt=0x7f7f511a1030,
 _lgs_defocuses=0x7f7f5110e468,_unitdefocus=0x10c548030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50935e30,_flat=0x7f7f509e1830,_domask=1,
 _submask=0x7f7f50973830,_kernel=0x7f7f509dde30,_kernels=0x10c04b030,_kerfftr=
 0x10c14c030,_kerffti=0x10c591030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511d6230,_x=0x7f7f5300fb60,_y=0x7f7f533e15f0,_centroidgain=1,_rayleigh=
 0x7f7f511048d8,_bckgrdcalib=0x7f7f509e5230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ee08)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc80,_ctrlden=0x7f7f5110e740,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a8b8,_xlast=0x7f7f5201aff0,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f53287650,_signus=0x7f7f5327d980,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f51808db0,_y=
 0x7f7f51808360,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f511055f8,_ey=
 0x7f7f52001f78,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081c30,
 _flat_command=0x0,_extrapcmat=0x7f7f509bc830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001e28,_ctrlden=0x7f7f5110fa50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002988,_xlast=0x7f7f5110e9e0,_ylast=[0x7f7f51111f50,0x7f7f51111f50,
 0x7f7f51111f50],_y0=0x7f7f51112528,_signus=0x7f7f5110ebd8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51107080,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f511101c0,yposition=
 0x7f7f52001d10,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.493      187.2
Field Avg  1.65                     44.5   0.493      187.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f51112ae0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a9c0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f510811e0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cb1c030,_masks=0x0,_fluxpersub=0x7f7f5201a6a8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081708,_skyfluxpersub=0x7f7f518095f0,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00538028,-0.000706379],_lastvalidtt=
 [-0.00538028,-0.000706379],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f533e0250,_tiltrefv=0x7f7f507ac650,_tiprefvn=0x7f7f533e0810,_tiltrefvn=
 0x7f7f507aca60,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aee8,_jstart=0x7f7f52019d60,_binindices=0x7f7f5180a030,
 _binxy=10,_centroidw=0x7f7f511132d8,_fimage=0x7f7f511ce230,_fimage2=0x0,
 _imistart=0x7f7f5201a078,_imjstart=0x7f7f5201a498,_imistart2=0x7f7f51808990,
 _imjstart2=0x7f7f518092d8,_unittip=0x7f7f5181a030,_unittilt=0x7f7f5181a830,
 _lgs_defocuses=0x7f7f51105588,_unitdefocus=0x10c807030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509c4a30,_flat=0x7f7f51881230,_domask=1,
 _submask=0x7f7f509d6a30,_kernel=0x7f7f51879e30,_kernels=0x10beb1030,_kerfftr=
 0x10c591030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51194030,_x=0x7f7f506a2f10,_y=0x7f7f506ad840,_centroidgain=1,_rayleigh=
 0x7f7f5110e468,_bckgrdcalib=0x7f7f5187d830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110fbd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511070f0,_ctrlden=0x7f7f5110e628,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808360,_xlast=0x7f7f5201a8b8,_ylast=[0x7f7f53287650,
 0x7f7f53287650,0x7f7f53287650],_y0=0x7f7f52934b80,_signus=0x7f7f5327db30,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201a5a0,_y=
 0x7f7f51808db0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f51110000,_ey=
 0x7f7f51106f30,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201aff0,
 _flat_command=0x0,_extrapcmat=0x7f7f5207cc30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51106ef8,_ctrlden=0x7f7f511055f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fa50,_xlast=0x7f7f5110fc80,_ylast=[0x7f7f51113f10,0x7f7f51113f10,
 0x7f7f51113f10],_y0=0x7f7f51112838,_signus=0x7f7f52002988,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e9e0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f520028a8,yposition=
 0x7f7f5110f938,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.463      212.5
Field Avg  1.65                     44.5   0.463      212.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f51113e88)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808eb8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081810,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c25f030,_masks=0x0,_fluxpersub=0x7f7f51808990,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518092d8,_skyfluxpersub=0x7f7f5201a6a8,
 _nphotons=4441.1,_skynphotons=0,_tt=[-0.00342678,-0.00111373],_lastvalidtt=
 [-0.00342678,-0.00111373],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f507ac1c0,_tiltrefv=0x7f7f507ace60,_tiprefvn=0x7f7f507ad0a0,_tiltrefvn=
 0x7f7f507ac650,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808468,_jstart=0x7f7f510811e0,_binindices=0x7f7f52080c30,
 _binxy=10,_centroidw=0x7f7f51111f50,_fimage=0x7f7f5122f030,_fimage2=0x0,
 _imistart=0x7f7f51081708,_imjstart=0x7f7f51808fc0,_imistart2=0x7f7f5201a078,
 _imjstart2=0x7f7f5201a498,_unittip=0x7f7f52008630,_unittilt=0x7f7f52065e30,
 _lgs_defocuses=0x7f7f51107128,_unitdefocus=0x10c850030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511caa30,_flat=0x7f7f51190830,_domask=1,
 _submask=0x7f7f511c7030,_kernel=0x7f7f5118ce30,_kernels=0x10c0cb030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511dee30,_x=0x7f7f507aca60,_y=0x7f7f507ad2e0,_centroidgain=1,_rayleigh=
 0x7f7f51105588,_bckgrdcalib=0x7f7f51194230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ee08)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511048d8,_ctrlden=0x7f7f5110ec48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808db0,_xlast=0x7f7f51808360,_ylast=[0x7f7f533e22e0,
 0x7f7f533e22e0,0x7f7f533e22e0],_y0=0x7f7f533e0c40,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f5201b620,_y=
 0x7f7f5201a5a0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f511101c0,_ey=
 0x7f7f5110f8c8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a8b8,
 _flat_command=0x0,_extrapcmat=0x7f7f5181a830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001e28,_ctrlden=0x7f7f5110ff90,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511055f8,_xlast=0x7f7f511070f0,_ylast=[0x7f7f51112b68,0x7f7f51112b68,
 0x7f7f51112b68],_y0=0x7f7f511129d0,_signus=0x7f7f5110fa50,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fc80,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f5110fac0,yposition=
 0x7f7f51107080,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      737.7   0.001     1811.0
Field Avg  1.65                    737.7   0.001     1811.0
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f511133e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518090c8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518093e0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f5201a078,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a498,_skyfluxpersub=0x7f7f51808990,
 _nphotons=0.0353607,_skynphotons=0,_tt=[-0.00680433,0.0121775],_lastvalidtt=
 [-0.00680433,0.0121775],_upttcommand=[0,0],_refmes=0x7f7f507ad580,_tiprefv=
 0x7f7f507add40,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f507ac1c0,_tiltrefvn=
 0x7f7f506add60,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808a98,_jstart=0x7f7f51081810,_binindices=0x7f7f509c7030,
 _binxy=10,_centroidw=0x7f7f51113f10,_fimage=0x7f7f5118ce30,_fimage2=0x0,
 _imistart=0x7f7f518092d8,_imjstart=0x7f7f52019b50,_imistart2=0x7f7f51081708,
 _imjstart2=0x7f7f51808fc0,_unittip=0x7f7f50932230,_unittilt=0x7f7f50932a30,
 _lgs_defocuses=0x7f7f51110230,_unitdefocus=0x10be70030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50965630,_flat=0x7f7f509d0630,_domask=1,
 _submask=0x7f7f50961c30,_kernel=0x7f7f5095e230,_kernels=0x10c04b030,_kerfftr=
 0x10c14c030,_kerffti=0x10c591030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511d6230,_x=0x7f7f53102070,_y=0x7f7f52935ab0,_centroidgain=1,_rayleigh=
 0x7f7f51107128,_bckgrdcalib=0x7f7f509ddc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110fbd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e468,_ctrlden=0x7f7f51106f30,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a5a0,_xlast=0x7f7f51808db0,_ylast=[0x7f7f507afd80,
 0x7f7f507afd80,0x7f7f507afd80],_y0=0x7f7f507aed60,_signus=0x7f7f507acd90,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51081c30,_y=
 0x7f7f5201b620,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f520028a8,_ey=
 0x7f7f52001ca0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808360,
 _flat_command=0x0,_extrapcmat=0x7f7f50921830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511101c0,_ctrlden=0x7f7f52001d80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ff90,_xlast=0x7f7f511048d8,_ylast=[0x7f7f51112fa8,0x7f7f51112fa8,
 0x7f7f51112fa8],_y0=0x7f7f51113b58,_signus=0x7f7f511055f8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511070f0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f5110ec10,yposition=
 0x7f7f5110e9e0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      728.5   0.002     1639.0
Field Avg  1.65                    728.5   0.002     1639.0
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f511121f8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807f40,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518096f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c548030,_masks=0x0,_fluxpersub=0x7f7f51081708,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808fc0,_skyfluxpersub=0x7f7f5201a078,
 _nphotons=0.0707214,_skynphotons=0,_tt=[0.00720414,-0.00264945],_lastvalidtt=
 [0.00720414,-0.00264945],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f533e0170,_tiltrefv=0x7f7f533e0fd0,_tiprefvn=0x7f7f533e2190,_tiltrefvn=
 0x7f7f533e2610,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a6a8,_jstart=0x7f7f518093e0,_binindices=0x7f7f5208d830,
 _binxy=10,_centroidw=0x7f7f51112b68,_fimage=0x7f7f51198630,_fimage2=0x0,
 _imistart=0x7f7f5201a498,_imjstart=0x7f7f51808eb8,_imistart2=0x7f7f518092d8,
 _imjstart2=0x7f7f52019b50,_unittip=0x7f7f51819030,_unittilt=0x7f7f51812830,
 _lgs_defocuses=0x7f7f5110fb30,_unitdefocus=0x10c32b030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52078230,_flat=0x7f7f520a0830,_domask=1,
 _submask=0x7f7f509c7030,_kernel=0x7f7f509e8830,_kernels=0x10beb1030,_kerfftr=
 0x10c591030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5118ce30,_x=0x7f7f506ad840,_y=0x7f7f506adb00,_centroidgain=1,_rayleigh=
 0x7f7f51110230,_bckgrdcalib=0x7f7f5207bc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ee08)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f8c8,_ctrlden=0x7f7f5110fcb8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b620,_xlast=0x7f7f5201a5a0,_ylast=[0x7f7f507ac650,
 0x7f7f507ac650,0x7f7f507ac650],_y0=0x7f7f507aca60,_signus=0x7f7f507ac1c0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f5201aff0,_y=
 0x7f7f51081c30,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110fac0,_ey=
 0x7f7f5110f9e0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808db0,
 _flat_command=0x0,_extrapcmat=0x7f7f50932230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f890,_ctrlden=0x7f7f51106ec0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001d80,_xlast=0x7f7f5110e468,_ylast=[0x7f7f51113360,0x7f7f51113360,
 0x7f7f51113360],_y0=0x7f7f51113a48,_signus=0x7f7f5110ff90,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511048d8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f51107048,yposition=
 0x7f7f5110fc80,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      603.3   0.002     1537.8
Field Avg  1.65                    603.3   0.002     1537.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111e40,layerfrac=0x7f7f51111ec8,
 layerspeed=0x7f7f51113be0,layeralt=0x7f7f511128c0,winddir=0x7f7f51113690,
 _layeralt=0x7f7f51112060)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f52002410,lgs_prof_alt=
 0x7f7f52001c68,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a180,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518095f0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c807030,_masks=0x0,_fluxpersub=0x7f7f518092d8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019b50,_skyfluxpersub=0x7f7f51081708,
 _nphotons=0.176803,_skynphotons=0,_tt=[0.00438293,-0.00844032],_lastvalidtt=
 [0.00438293,-0.00844032],_upttcommand=[0,0],_refmes=0x7f7f531843c0,_tiprefv=
 0x7f7f507ad040,_tiltrefv=0x7f7f507accc0,_tiprefvn=0x7f7f507ad280,_tiltrefvn=
 0x7f7f507ad700,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019a48,_jstart=0x7f7f518096f8,_binindices=0x7f7f511f9830,
 _binxy=10,_centroidw=0x7f7f51112fa8,_fimage=0x7f7f5118ce30,_fimage2=0x0,
 _imistart=0x7f7f51808fc0,_imjstart=0x7f7f5201a9c0,_imistart2=0x7f7f5201a498,
 _imjstart2=0x7f7f51808eb8,_unittip=0x7f7f50949030,_unittilt=0x7f7f509ecc30,
 _lgs_defocuses=0x7f7f5110eb68,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51882c30,_flat=0x7f7f51815830,_domask=1,
 _submask=0x7f7f5188bc30,_kernel=0x7f7f511c7030,_kernels=0x10c0cb030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f518c7430,_x=0x7f7f533e18b0,_y=0x7f7f533e1a10,_centroidgain=1,_rayleigh=
 0x7f7f5110fb30,_bckgrdcalib=0x7f7f51886630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110fbd8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520028a8,_ctrlden=0x7f7f51106fa0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081c30,_xlast=0x7f7f5201b620,_ylast=[0x7f7f533e3dc0,
 0x7f7f533e3dc0,0x7f7f533e3dc0],_y0=0x7f7f533e2350,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51808ca8,_y=
 0x7f7f5201aff0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110ec10,_ey=
 0x7f7f5110fa18,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a5a0,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f820,_ctrlden=0x7f7f51106ef8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51106ec0,_xlast=0x7f7f5110f8c8,_ylast=[0x7f7f5100b450,0x7f7f5100b450,
 0x7f7f5100b450],_y0=0x7f7f51112d88,_signus=0x7f7f52001d80,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e468,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110f7b0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52001e60,xposition=0x7f7f5110ea50,yposition=
 0x7f7f511070f0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e5f0,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      207.4
Field Avg  1.65                     44.5   0.495      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f5100b450)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b728,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081600,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c850030,_masks=0x0,_fluxpersub=0x7f7f518095f0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a180,_skyfluxpersub=0x7f7f5201a5a0,
 _nphotons=14077.3,_skynphotons=0,_tt=[0.000476324,0.000676666],_lastvalidtt=
 [0.000476324,0.000676666],_upttcommand=[0,0],_refmes=0x7f7f507ad600,_tiprefv=
 0x7f7f507ac650,_tiltrefv=0x7f7f533e1c20,_tiprefvn=0x7f7f507aca60,_tiltrefvn=
 0x7f7f533e1e60,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a9c0,_jstart=0x7f7f51808fc0,_binindices=0x7f7f511c7030,
 _binxy=10,_centroidw=0x7f7f51113360,_fimage=0x7f7f509d0630,_fimage2=0x0,
 _imistart=0x7f7f51081a20,_imjstart=0x7f7f51081708,_imistart2=0x7f7f52019b50,
 _imjstart2=0x7f7f518092d8,_unittip=0x7f7f5115b430,_unittilt=0x7f7f51179830,
 _lgs_defocuses=0x7f7f5110fa88,_unitdefocus=0x10c690030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511fa030,_flat=0x7f7f511ef430,_domask=1,
 _submask=0x7f7f511eba30,_kernel=0x7f7f51193830,_kernels=0x10beb1030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509e5c30,_x=0x7f7f533df8e0,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f5110e4d8,_bckgrdcalib=0x7f7f511f2e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51106e88,_ctrlden=0x7f7f5110e5f0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b620,_xlast=0x7f7f51808ca8,_ylast=[0x7f7f507af840,
 0x7f7f507af840,0x7f7f507af840],_y0=0x7f7f507ae820,_signus=0x7f7f507acca0,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51808360,_y=
 0x7f7f5201aff0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f51107048,_ey=
 0x7f7f52001d10,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808990,
 _flat_command=0x0,_extrapcmat=0x7f7f51820c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002138,_ctrlden=0x7f7f511071d0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ea50,_xlast=0x7f7f52002918,_ylast=[0x7f7f51112838,0x7f7f51112838,
 0x7f7f51112838],_y0=0x7f7f51113d78,_signus=0x7f7f51110230,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fac0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f51104980,yposition=
 0x7f7f52001e60,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.510      182.1
Field Avg  1.65                     44.1   0.510      182.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51113140)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a6a8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808ba0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10be70030,_masks=0x0,_fluxpersub=0x7f7f52019b50,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518092d8,_skyfluxpersub=0x7f7f518095f0,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.000370115,-0.000968944],_lastvalidtt=
 [-0.000370115,-0.000968944],_upttcommand=[0,0],_refmes=0x7f7f533df340,_tiprefv=
 0x7f7f533e33a0,_tiltrefv=0x7f7f532850a0,_tiprefvn=0x7f7f533e35e0,_tiltrefvn=
 0x7f7f5327d980,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201ade0,_jstart=0x7f7f51081600,_binindices=0x7f7f509d0630,
 _binxy=10,_centroidw=0x7f7f51112280,_fimage=0x7f7f5118ce30,_fimage2=0x0,
 _imistart=0x7f7f5201a180,_imjstart=0x7f7f518091d0,_imistart2=0x7f7f51081a20,
 _imjstart2=0x7f7f51081708,_unittip=0x7f7f50932230,_unittilt=0x7f7f509d5a30,
 _lgs_defocuses=0x7f7f51110000,_unitdefocus=0x10c2a0030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511d1c30,_flat=0x7f7f511c7030,_domask=1,
 _submask=0x7f7f51197c30,_kernel=0x7f7f51194230,_kernels=0x10c5d2030,_kerfftr=
 0x10c14c030,_kerffti=0x10beb1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51190830,_x=0x7f7f5327dbc0,_y=0x7f7f53281c60,_centroidgain=1,_rayleigh=
 0x7f7f5110fa88,_bckgrdcalib=0x7f7f511caa30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51105588)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520021e0,_ctrlden=0x7f7f51107048,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201aff0,_xlast=0x7f7f5201b620,_ylast=[0x7f7f52935ab0,
 0x7f7f52935ab0,0x7f7f52935ab0],_y0=0x7f7f53187cc0,_signus=0x7f7f53280670,
 _puppixoffset=[0,0],_nact=45,_def=0x10d132030,_x=0x7f7f52019a48,_y=
 0x7f7f51808360,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f5110f7b0,_ey=
 0x7f7f5110f858,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f51816e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001df0,_ctrlden=0x7f7f51104b08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511071d0,_xlast=0x7f7f51106e88,_ylast=[0x7f7f51113b58,0x7f7f51113b58,
 0x7f7f51113b58],_y0=0x7f7f511121f8,_signus=0x7f7f5110ea50,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002918,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f51107128,yposition=
 0x7f7f52002100,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.466      207.4
Field Avg  1.65                     44.5   0.466      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51113608)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019c58,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b308,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c8b1030,_masks=0x0,_fluxpersub=0x7f7f51081a20,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081708,_skyfluxpersub=0x7f7f52019b50,
 _nphotons=70386.7,_skynphotons=0,_tt=[-0.00173727,3.07557e-05],_lastvalidtt=
 [-0.00173727,3.07557e-05],_upttcommand=[0,0],_refmes=0x7f7f533df340,_tiprefv=
 0x7f7f506a0290,_tiltrefv=0x7f7f533e1d60,_tiprefvn=0x7f7f506ada80,_tiltrefvn=
 0x7f7f533e1fa0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518093e0,_jstart=0x7f7f51808ba0,_binindices=0x7f7f51194230,
 _binxy=10,_centroidw=0x7f7f51112838,_fimage=0x7f7f51258430,_fimage2=0x0,
 _imistart=0x7f7f518092d8,_imjstart=0x7f7f51808678,_imistart2=0x7f7f5201a180,
 _imjstart2=0x7f7f518091d0,_unittip=0x7f7f5114da30,_unittilt=0x7f7f5114e230,
 _lgs_defocuses=0x7f7f52001ed0,_unitdefocus=0x10c730030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511fcc30,_flat=0x7f7f511f2030,_domask=1,
 _submask=0x7f7f51190830,_kernel=0x7f7f511d6230,_kernels=0x10beb1030,_kerfftr=
 0x10c04b030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511ec830,_x=0x7f7f533e03a0,_y=0x7f7f533df8a0,_centroidgain=1,_rayleigh=
 0x7f7f51110000,_bckgrdcalib=0x7f7f511f5a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511101c0,_ctrlden=0x7f7f5110fa50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808360,_xlast=0x7f7f5201aff0,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f53285210,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201b200,_y=
 0x7f7f52019a48,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f51104980,_ey=
 0x7f7f5110f938,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b620,
 _flat_command=0x0,_extrapcmat=0x7f7f51176630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fb68,_ctrlden=0x7f7f52002368,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104b08,_xlast=0x7f7f520021e0,_ylast=[0x7f7f511124a0,0x7f7f511124a0,
 0x7f7f511124a0],_y0=0x7f7f51112f20,_signus=0x7f7f511071d0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51106e88,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f52002288,yposition=
 0x7f7f5110fac0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       45.2   0.457      222.6
Field Avg  1.65                     45.2   0.457      222.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f511133e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b518,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518096f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c591030,_masks=0x0,_fluxpersub=0x7f7f5201a180,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518091d0,_skyfluxpersub=0x7f7f51081a20,
 _nphotons=888.22,_skynphotons=0,_tt=[0.00165337,-0.000287252],_lastvalidtt=
 [0.00165337,-0.000287252],_upttcommand=[0,0],_refmes=0x7f7f507acd20,_tiprefv=
 0x7f7f533e3dd0,_tiltrefv=0x7f7f506ad840,_tiprefvn=0x7f7f533e4010,_tiltrefvn=
 0x7f7f506ada80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51022b80,_jstart=0x7f7f5201b308,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f51113b58,_fimage=0x7f7f51192e30,_fimage2=0x0,
 _imistart=0x7f7f51081708,_imjstart=0x7f7f51807f40,_imistart2=0x7f7f518092d8,
 _imjstart2=0x7f7f51808678,_unittip=0x7f7f52006c30,_unittilt=0x7f7f5200ac30,
 _lgs_defocuses=0x7f7f5110fc80,_unitdefocus=0x10bf31030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509dde30,_flat=0x7f7f509da430,_domask=1,
 _submask=0x7f7f5095e230,_kernel=0x7f7f509d6a30,_kernels=0x10c5d2030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51196830,_x=0x7f7f507ac1c0,_y=0x7f7f507ace60,_centroidgain=1,_rayleigh=
 0x7f7f52001ed0,_bckgrdcalib=0x7f7f50961c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51105588)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51107080,_ctrlden=0x7f7f51107048,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f52019a48,_xlast=0x7f7f51808360,_ylast=[0x7f7f533e3180,
 0x7f7f533e3180,0x7f7f533e3180],_y0=0x7f7f533e48b0,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f51808990,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f51107128,_ey=
 0x7f7f5110e9e0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201aff0,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055f8,_ctrlden=0x7f7f5110ff90,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002368,_xlast=0x7f7f511101c0,_ylast=[0x7f7f51111d30,0x7f7f51111d30,
 0x7f7f51111d30],_y0=0x7f7f51113cf0,_signus=0x7f7f51104b08,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520021e0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f520022f8,yposition=
 0x7f7f52002918,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.494      187.2
Field Avg  1.65                     44.1   0.494      187.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51113470)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808a98,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a5a0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c690030,_masks=0x0,_fluxpersub=0x7f7f518092d8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808678,_skyfluxpersub=0x7f7f5201a180,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.00191627,0.00274383],_lastvalidtt=
 [-0.00191627,0.00274383],_upttcommand=[0,0],_refmes=0x7f7f506a0290,_tiprefv=
 0x7f7f533e1c20,_tiltrefv=0x7f7f507ac650,_tiprefvn=0x7f7f533e3ba0,_tiltrefvn=
 0x7f7f507acbc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019b50,_jstart=0x7f7f518096f8,_binindices=0x7f7f509d6a30,
 _binxy=10,_centroidw=0x7f7f511124a0,_fimage=0x7f7f509e8c30,_fimage2=0x0,
 _imistart=0x7f7f518091d0,_imjstart=0x7f7f52019c58,_imistart2=0x7f7f51081708,
 _imjstart2=0x7f7f51807f40,_unittip=0x7f7f51153030,_unittilt=0x7f7f51158030,
 _lgs_defocuses=0x7f7f5110e4d8,_unitdefocus=0x10cb1c030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52078230,_flat=0x7f7f509ef430,_domask=1,
 _submask=0x7f7f51196830,_kernel=0x7f7f509e1830,_kernels=0x10beb1030,_kerfftr=
 0x10c14c030,_kerffti=0x10c5d2030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5207bc30,_x=0x7f7f533e03a0,_y=0x7f7f533df8a0,_centroidgain=1,_rayleigh=
 0x7f7f5110fc80,_bckgrdcalib=0x7f7f509e5230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001df0,_ctrlden=0x7f7f5110f7b0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b200,_xlast=0x7f7f52019a48,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51808ca8,_y=
 0x7f7f51808990,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f52002288,_ey=
 0x7f7f51104e18,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808360,
 _flat_command=0x0,_extrapcmat=0x7f7f51817830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f938,_ctrlden=0x7f7f5110f890,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ff90,_xlast=0x7f7f51107080,_ylast=[0x7f7f51113f98,0x7f7f51113f98,
 0x7f7f51113f98],_y0=0x7f7f51113938,_signus=0x7f7f52002368,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f511101c0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f52001e98,yposition=
 0x7f7f51106e88,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.462      212.5
Field Avg  1.65                     44.5   0.462      212.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51112418)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f52019d60,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518095f0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c2a0030,_masks=0x0,_fluxpersub=0x7f7f51081708,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807f40,_skyfluxpersub=0x7f7f518092d8,
 _nphotons=4441.1,_skynphotons=0,_tt=[-0.00335902,-0.000501384],_lastvalidtt=
 [-0.00335902,-0.000501384],_upttcommand=[0,0],_refmes=0x7f7f52935790,_tiprefv=
 0x7f7f507ac320,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f507ad1a0,_tiltrefvn=
 0x7f7f506aee40,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808570,_jstart=0x7f7f5201a5a0,_binindices=0x7f7f50935e30,
 _binxy=10,_centroidw=0x7f7f51111d30,_fimage=0x7f7f51196630,_fimage2=0x0,
 _imistart=0x7f7f51808678,_imjstart=0x7f7f5201a6a8,_imistart2=0x7f7f518091d0,
 _imjstart2=0x7f7f52019c58,_unittip=0x7f7f5209f630,_unittilt=0x7f7f52088630,
 _lgs_defocuses=0x7f7f51106fd8,_unitdefocus=0x10c25f030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509dde30,_flat=0x7f7f509da430,_domask=1,
 _submask=0x7f7f509ef430,_kernel=0x7f7f509d6a30,_kernels=0x10c5d2030,_kerfftr=
 0x10c0cb030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5118ce30,_x=0x7f7f507ac650,_y=0x7f7f507aca60,_centroidgain=1,_rayleigh=
 0x7f7f5110e4d8,_bckgrdcalib=0x7f7f509f2e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51105588)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51110000,_ctrlden=0x7f7f5110e970,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808990,_xlast=0x7f7f5201b200,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f52934b80,_signus=0x7f7f532812d0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f5201b830,_y=
 0x7f7f51808ca8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f520022f8,_ey=
 0x7f7f511070b8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52019a48,
 _flat_command=0x0,_extrapcmat=0x7f7f51820c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055f8,_ctrlden=0x7f7f5110fb68,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110f890,_xlast=0x7f7f52001df0,_ylast=[0x7f7f511139c0,0x7f7f511139c0,
 0x7f7f511139c0],_y0=0x7f7f51112d00,_signus=0x7f7f5110ff90,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51107080,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f51107160,yposition=
 0x7f7f520021e0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      553.0   0.002     1740.1
Field Avg  1.65                    553.0   0.002     1740.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51112308)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081810,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a078,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c730030,_masks=0x0,_fluxpersub=0x7f7f518091d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019c58,_skyfluxpersub=0x7f7f51081708,
 _nphotons=0.0353607,_skynphotons=0,_tt=[-0.0248957,-0.00921525],_lastvalidtt=
 [-0.0248957,-0.00921525],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f507ac650,_tiltrefv=0x7f7f533e3ba0,_tiprefvn=0x7f7f507ac1c0,_tiltrefvn=
 0x7f7f533e0820,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aac8,_jstart=0x7f7f518095f0,_binindices=0x7f7f51259c30,
 _binxy=10,_centroidw=0x7f7f51113f98,_fimage=0x7f7f509b8830,_fimage2=0x0,
 _imistart=0x7f7f51807f40,_imjstart=0x7f7f518090c8,_imistart2=0x7f7f51808678,
 _imjstart2=0x7f7f5201a6a8,_unittip=0x7f7f50944e30,_unittilt=0x7f7f50945630,
 _lgs_defocuses=0x7f7f51106f30,_unitdefocus=0x10c807030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511e3a30,_flat=0x7f7f511d8e30,_domask=1,
 _submask=0x7f7f5118ce30,_kernel=0x7f7f511d5430,_kernels=0x10beb1030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50994a30,_x=0x7f7f53278910,_y=0x7f7f53280fa0,_centroidgain=1,_rayleigh=
 0x7f7f51106fd8,_bckgrdcalib=0x7f7f511dc830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f938,_ctrlden=0x7f7f51110230,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ca8,_xlast=0x7f7f51808990,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201aff0,_y=
 0x7f7f5201b830,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f52001e98,_ey=
 0x7f7f52002410,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b200,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001db8,_ctrlden=0x7f7f51104e18,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fb68,_xlast=0x7f7f51110000,_ylast=[0x7f7f51112528,0x7f7f51112528,
 0x7f7f51112528],_y0=0x7f7f51111b10,_signus=0x7f7f5110f890,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001df0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f520029f8,yposition=
 0x7f7f511101c0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      953.8   0.001     2028.5
Field Avg  1.65                    953.8   0.001     2028.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51113828)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f510810d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081a20,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bf31030,_masks=0x0,_fluxpersub=0x7f7f51808678,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a6a8,_skyfluxpersub=0x7f7f518091d0,
 _nphotons=0.0707214,_skynphotons=0,_tt=[-0.0149954,0.0058859],_lastvalidtt=
 [-0.0149954,0.0058859],_upttcommand=[0,0],_refmes=0x7f7f533df900,_tiprefv=
 0x7f7f533e0010,_tiltrefv=0x7f7f533e05e0,_tiprefvn=0x7f7f533e0250,_tiltrefvn=
 0x7f7f533e0ca0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518092d8,_jstart=0x7f7f5201a078,_binindices=0x7f7f51885630,
 _binxy=10,_centroidw=0x7f7f511139c0,_fimage=0x7f7f509db630,_fimage2=0x0,
 _imistart=0x7f7f52019c58,_imjstart=0x7f7f52019d60,_imistart2=0x7f7f51807f40,
 _imjstart2=0x7f7f518090c8,_unittip=0x7f7f51819030,_unittilt=0x7f7f5181a030,
 _lgs_defocuses=0x7f7f51104980,_unitdefocus=0x10c548030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5200ac30,_flat=0x7f7f52078230,_domask=1,
 _submask=0x7f7f511e7030,_kernel=0x7f7f511ce230,_kernels=0x10c5d2030,_kerfftr=
 0x10c14c030,_kerffti=0x10beb1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509e1c30,_x=0x7f7f506ada80,_y=0x7f7f506add40,_centroidgain=1,_rayleigh=
 0x7f7f51106f30,_bckgrdcalib=0x7f7f5207bc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f51105588)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002100,_ctrlden=0x7f7f52002288,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b830,_xlast=0x7f7f51808ca8,_ylast=[0x7f7f506a0290,
 0x7f7f506a0290,0x7f7f506a0290],_y0=0x7f7f533e09e0,_signus=0x7f7f5069f7e0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f51808360,_y=
 0x7f7f5201aff0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf7f030,_ex=0x7f7f51107160,_ey=
 0x7f7f52002138,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808990,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520022f8,_ctrlden=0x7f7f5110e4d8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104e18,_xlast=0x7f7f5110f938,_ylast=[0x7f7f511120e8,0x7f7f511120e8,
 0x7f7f511120e8],_y0=0x7f7f51112bf0,_signus=0x7f7f5110fb68,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd47030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51110000,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f52001ca0,yposition=
 0x7f7f51107080,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      433.6   0.001     2074.0
Field Avg  1.65                    433.6   0.001     2074.0
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51111ec8,layerfrac=0x7f7f51113be0,
 layerspeed=0x7f7f51111e40,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112d88,
 _layeralt=0x7f7f51111f50)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 20,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110f820,lgs_prof_alt=
 0x7f7f5110ec10,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807e38,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a180,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cb1c030,_masks=0x0,_fluxpersub=0x7f7f51807f40,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518090c8,_skyfluxpersub=0x7f7f51808678,
 _nphotons=0.176803,_skynphotons=0,_tt=[-0.0261404,-0.0221833],_lastvalidtt=
 [-0.0261404,-0.0221833],_upttcommand=[0,0],_refmes=0x7f7f507ac220,_tiprefv=
 0x7f7f53281d10,_tiltrefv=0x7f7f506adbc0,_tiprefvn=0x7f7f52935ab0,_tiltrefvn=
 0x7f7f506ade00,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f52019940,_jstart=0x7f7f51081a20,_binindices=0x7f7f509ccc30,
 _binxy=10,_centroidw=0x7f7f51112528,_fimage=0x7f7f509ef430,_fimage2=0x0,
 _imistart=0x7f7f5201a6a8,_imjstart=0x7f7f51808a98,_imistart2=0x7f7f52019c58,
 _imjstart2=0x7f7f52019d60,_unittip=0x7f7f5200c630,_unittilt=0x7f7f52010630,
 _lgs_defocuses=0x7f7f5110fac0,_unitdefocus=0x10c32b030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509f2e30,_flat=0x7f7f50935e30,_domask=1,
 _submask=0x7f7f509e1630,_kernel=0x7f7f509e8c30,_kernels=0x10beb1030,_kerfftr=
 0x10c04b030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509d0630,_x=0x7f7f507acd60,_y=0x7f7f507ad020,_centroidgain=1,_rayleigh=
 0x7f7f51104980,_bckgrdcalib=0x7f7f509f6830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055f8,_ctrlden=0x7f7f51106fd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201aff0,_xlast=0x7f7f5201b830,_ylast=[0x7f7f533e05e0,
 0x7f7f533e05e0,0x7f7f533e05e0],_y0=0x7f7f533e2370,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f510814f8,_y=
 0x7f7f51808360,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f520029f8,_ey=
 0x7f7f5110f900,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fa88,_ctrlden=0x7f7f5110ec48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e4d8,_xlast=0x7f7f52002100,_ylast=[0x7f7f51112c78,0x7f7f51112c78,
 0x7f7f51112c78],_y0=0x7f7f51112a58,_signus=0x7f7f51104e18,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110f938,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f52001d80,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f51106ec0,xposition=0x7f7f51106f68,yposition=
 0x7f7f52001df0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110e468,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      207.4
Field Avg  1.65                     44.5   0.495      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51112c78)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808db0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b728,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c25f030,_masks=0x0,_fluxpersub=0x7f7f5201a180,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807e38,_skyfluxpersub=0x7f7f51808ca8,
 _nphotons=14077.3,_skynphotons=0,_tt=[0.000139665,0.00146854],_lastvalidtt=
 [0.000139665,0.00146854],_upttcommand=[0,0],_refmes=0x7f7f507aca60,_tiprefv=
 0x7f7f507acd60,_tiltrefv=0x7f7f52935ab0,_tiprefvn=0x7f7f507acfa0,_tiltrefvn=
 0x7f7f53287320,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808a98,_jstart=0x7f7f5201a6a8,_binindices=0x7f7f509c1030,
 _binxy=10,_centroidw=0x7f7f511120e8,_fimage=0x7f7f50a29c30,_fimage2=0x0,
 _imistart=0x7f7f510811e0,_imjstart=0x7f7f51808678,_imistart2=0x7f7f518090c8,
 _imjstart2=0x7f7f51807f40,_unittip=0x7f7f5093a030,_unittilt=0x7f7f509e0030,
 _lgs_defocuses=0x7f7f52001cd8,_unitdefocus=0x10c850030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509aba30,_flat=0x7f7f509a8030,_domask=1,
 _submask=0x7f7f50964230,_kernel=0x7f7f509e5030,_kernels=0x10beb1030,_kerfftr=
 0x10c14c030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509e8a30,_x=0x7f7f531022f0,_y=0x7f7f532806e0,_centroidgain=1,_rayleigh=
 0x7f7f51107048,_bckgrdcalib=0x7f7f509af430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001df0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f9e0,_ctrlden=0x7f7f5110fb68,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b830,_xlast=0x7f7f510814f8,_ylast=[0x7f7f53287560,
 0x7f7f53287560,0x7f7f53287560],_y0=0x7f7f53187cc0,_signus=0x7f7f5327d980,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201b200,_y=
 0x7f7f51808360,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f52001ca0,_ey=
 0x7f7f52002918,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081708,
 _flat_command=0x0,_extrapcmat=0x7f7f50968e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ea50,_ctrlden=0x7f7f520022f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51106f68,_xlast=0x7f7f5110e5f0,_ylast=[0x7f7f51113938,0x7f7f51113938,
 0x7f7f51113938],_y0=0x7f7f51113b58,_signus=0x7f7f51106f30,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001db8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f5110fbd8,yposition=
 0x7f7f51106ec0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.510      182.1
Field Avg  1.65                     44.1   0.510      182.1
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51113250)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518092d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5100e908,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cb1c030,_masks=0x0,_fluxpersub=0x7f7f518090c8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807f40,_skyfluxpersub=0x7f7f5201a180,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.000886433,-0.00157184],_lastvalidtt=
 [-0.000886433,-0.00157184],_upttcommand=[0,0],_refmes=0x7f7f507aca60,_tiprefv=
 0x7f7f53281380,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f53280340,_tiltrefvn=
 0x7f7f52935ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b620,_jstart=0x7f7f5201b728,_binindices=0x7f7f511eee30,
 _binxy=10,_centroidw=0x7f7f51113c68,_fimage=0x7f7f509d1830,_fimage2=0x0,
 _imistart=0x7f7f51807e38,_imjstart=0x7f7f5201b308,_imistart2=0x7f7f510811e0,
 _imjstart2=0x7f7f51808678,_unittip=0x7f7f51263a30,_unittilt=0x7f7f51191830,
 _lgs_defocuses=0x7f7f5110e9e0,_unitdefocus=0x10be70030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51208230,_flat=0x7f7f511fd630,_domask=1,
 _submask=0x7f7f511f9c30,_kernel=0x7f7f511dd030,_kernels=0x10c5d2030,_kerfftr=
 0x10c4c9030,_kerffti=0x10beb1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a41e30,_x=0x7f7f533e2e90,_y=0x7f7f533e3150,_centroidgain=1,_rayleigh=
 0x7f7f52001cd8,_bckgrdcalib=0x7f7f51201030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001d10)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002988,_ctrlden=0x7f7f52001ed0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808360,_xlast=0x7f7f5201b830,_ylast=[0x7f7f533e0910,
 0x7f7f533e0910,0x7f7f533e0910],_y0=0x7f7f533e0010,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10d132030,_x=0x7f7f52019940,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f52001d80,_ey=
 0x7f7f5110eb68,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f510814f8,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001e28,_ctrlden=0x7f7f52002410,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f520022f8,_xlast=0x7f7f5110f9e0,_ylast=[0x7f7f51111b10,0x7f7f51111b10,
 0x7f7f51111b10],_y0=0x7f7f51113828,_signus=0x7f7f51106f68,_puppixoffset=[0,0],
 _nact=2,_def=0x10c1cb030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e5f0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f5110e858,yposition=
 0x7f7f5110fc48,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.467      207.4
Field Avg  1.65                     44.5   0.467      207.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f511131c8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a498,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b0f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c32b030,_masks=0x0,_fluxpersub=0x7f7f510811e0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808678,_skyfluxpersub=0x7f7f518090c8,
 _nphotons=70386.7,_skynphotons=0,_tt=[-0.00194721,-0.000325397],_lastvalidtt=
 [-0.00194721,-0.000325397],_upttcommand=[0,0],_refmes=0x7f7f506a03d0,_tiprefv=
 0x7f7f533e0b70,_tiltrefv=0x7f7f507ac300,_tiprefvn=0x7f7f533e0db0,_tiltrefvn=
 0x7f7f507aca60,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a078,_jstart=0x7f7f5100e908,_binindices=0x7f7f511c7030,
 _binxy=10,_centroidw=0x7f7f51113938,_fimage=0x7f7f511f7830,_fimage2=0x0,
 _imistart=0x7f7f51807f40,_imjstart=0x7f7f5201b518,_imistart2=0x7f7f51807e38,
 _imjstart2=0x7f7f5201b308,_unittip=0x7f7f50949030,_unittilt=0x7f7f50944e30,
 _lgs_defocuses=0x7f7f5110e468,_unitdefocus=0x10c8b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511e3c30,_flat=0x7f7f511d1e30,_domask=1,
 _submask=0x7f7f511fc230,_kernel=0x7f7f511d9030,_kernels=0x10beb1030,_kerfftr=
 0x10c0cb030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511caa30,_x=0x7f7f52934b80,_y=0x7f7f53281c60,_centroidgain=1,_rayleigh=
 0x7f7f5110e9e0,_bckgrdcalib=0x7f7f511dca30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001df0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51105588,_ctrlden=0x7f7f52001d80,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b200,_xlast=0x7f7f51808360,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f53287650,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f5201a8b8,_y=
 0x7f7f52019940,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f5110fbd8,_ey=
 0x7f7f51106e88,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b830,
 _flat_command=0x0,_extrapcmat=0x7f7f52011630,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f820,_ctrlden=0x7f7f5110fb68,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002410,_xlast=0x7f7f52002988,_ylast=[0x7f7f51113f10,0x7f7f51113f10,
 0x7f7f51113f10],_y0=0x7f7f51112838,_signus=0x7f7f520022f8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110f9e0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f51107010,yposition=
 0x7f7f52001db8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       45.2   0.458      222.6
Field Avg  1.65                     45.2   0.458      222.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51112308)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a9c0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51081a20,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c36c030,_masks=0x0,_fluxpersub=0x7f7f51807e38,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b308,_skyfluxpersub=0x7f7f510811e0,
 _nphotons=888.22,_skynphotons=0,_tt=[0.00349477,-0.00037343],_lastvalidtt=
 [0.00349477,-0.00037343],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f506adb00,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f506add40,_tiltrefvn=
 0x7f7f506ae1c0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51809908,_jstart=0x7f7f5201b0f8,_binindices=0x7f7f51288430,
 _binxy=10,_centroidw=0x7f7f51111b10,_fimage=0x7f7f511fd830,_fimage2=0x0,
 _imistart=0x7f7f51808678,_imjstart=0x7f7f510810d8,_imistart2=0x7f7f51807f40,
 _imjstart2=0x7f7f5201b518,_unittip=0x7f7f50944e30,_unittilt=0x7f7f50939e30,
 _lgs_defocuses=0x7f7f51107160,_unitdefocus=0x10c591030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5180a030,_flat=0x7f7f51815830,_domask=1,
 _submask=0x7f7f5188ca30,_kernel=0x7f7f5187e630,_kernels=0x10c5d2030,_kerfftr=
 0x10c14c030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51284a30,_x=0x7f7f52934b80,_y=0x7f7f532812d0,_centroidgain=1,_rayleigh=
 0x7f7f5110e468,_bckgrdcalib=0x7f7f5186f230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001d10)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fbd8,_ctrlden=0x7f7f52001e28,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f52019940,_xlast=0x7f7f5201b200,_ylast=[0x7f7f52935ab0,
 0x7f7f52935ab0,0x7f7f52935ab0],_y0=0x7f7f531022f0,_signus=0x7f7f53187cc0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f51081708,_y=
 0x7f7f5201a8b8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f5110e858,_ey=
 0x7f7f511101c0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808360,
 _flat_command=0x0,_extrapcmat=0x7f7f52009e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc10,_ctrlden=0x7f7f51106ef8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fb68,_xlast=0x7f7f51105588,_ylast=[0x7f7f511121f8,0x7f7f511121f8,
 0x7f7f511121f8],_y0=0x7f7f51112f20,_signus=0x7f7f52002410,_puppixoffset=[0,0],
 _nact=2,_def=0x10c1cb030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002988,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f5110fcb8,yposition=
 0x7f7f5110e5f0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.495      187.2
Field Avg  1.65                     44.5   0.495      187.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51112390)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201aac8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808ca8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c850030,_masks=0x0,_fluxpersub=0x7f7f51807f40,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b518,_skyfluxpersub=0x7f7f51807e38,
 _nphotons=1776.44,_skynphotons=0,_tt=[-1.71538e-05,-0.00147652],_lastvalidtt=
 [-1.71538e-05,-0.00147652],_upttcommand=[0,0],_refmes=0x7f7f507acbc0,_tiprefv=
 0x7f7f533e3ef0,_tiltrefv=0x7f7f507ace80,_tiprefvn=0x7f7f533e4130,_tiltrefvn=
 0x7f7f507ad340,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518090c8,_jstart=0x7f7f51081a20,_binindices=0x7f7f51197a30,
 _binxy=10,_centroidw=0x7f7f51113f10,_fimage=0x7f7f51190830,_fimage2=0x0,
 _imistart=0x7f7f5201b308,_imjstart=0x7f7f5201a498,_imistart2=0x7f7f51808678,
 _imjstart2=0x7f7f510810d8,_unittip=0x7f7f5119c830,_unittilt=0x7f7f5117a030,
 _lgs_defocuses=0x7f7f52002288,_unitdefocus=0x10c690030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f512a6630,_flat=0x7f7f5129ba30,_domask=1,
 _submask=0x7f7f51298030,_kernel=0x7f7f5118ce30,_kernels=0x10beb1030,_kerfftr=
 0x10c4c9030,_kerffti=0x10c5d2030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5128dc30,_x=0x7f7f533e2850,_y=0x7f7f533e1d90,_centroidgain=1,_rayleigh=
 0x7f7f51107160,_bckgrdcalib=0x7f7f5129f430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001df0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001ed0,_ctrlden=0x7f7f5110f858,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a8b8,_xlast=0x7f7f52019940,_ylast=[0x7f7f533e25f0,
 0x7f7f533e25f0,0x7f7f533e25f0],_y0=0x7f7f533e0fa0,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f510814f8,_y=
 0x7f7f51081708,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f51107010,_ey=
 0x7f7f52001f78,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b200,
 _flat_command=0x0,_extrapcmat=0x7f7f50921830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520028a8,_ctrlden=0x7f7f511071d0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51106ef8,_xlast=0x7f7f5110fbd8,_ylast=[0x7f7f51111ca8,0x7f7f51111ca8,
 0x7f7f51111ca8],_y0=0x7f7f511137a0,_signus=0x7f7f5110fb68,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51105588,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f52002170,yposition=
 0x7f7f5110f9e0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.463      212.5
Field Avg  1.65                     44.5   0.463      212.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51111db8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518096f8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a180,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10be70030,_masks=0x0,_fluxpersub=0x7f7f51808678,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f510810d8,_skyfluxpersub=0x7f7f51807f40,
 _nphotons=4441.1,_skynphotons=0,_tt=[0.00070099,-0.000611922],_lastvalidtt=
 [0.00070099,-0.000611922],_upttcommand=[0,0],_refmes=0x7f7f533df340,_tiprefv=
 0x7f7f533e45a0,_tiltrefv=0x7f7f533e3c10,_tiprefvn=0x7f7f533e3e50,_tiltrefvn=
 0x7f7f533e47e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51081600,_jstart=0x7f7f51808ca8,_binindices=0x7f7f509c4a30,
 _binxy=10,_centroidw=0x7f7f511121f8,_fimage=0x7f7f5118ce30,_fimage2=0x0,
 _imistart=0x7f7f5201b518,_imjstart=0x7f7f518092d8,_imistart2=0x7f7f5201b308,
 _imjstart2=0x7f7f5201a498,_unittip=0x7f7f50945630,_unittilt=0x7f7f50a46c30,
 _lgs_defocuses=0x7f7f5110eb68,_unitdefocus=0x10c2a0030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f52078230,_flat=0x7f7f5207bc30,_domask=1,
 _submask=0x7f7f51197630,_kernel=0x7f7f51190830,_kernels=0x10c5d2030,_kerfftr=
 0x10c04b030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5127a830,_x=0x7f7f53285250,_y=0x7f7f53281cd0,_centroidgain=1,_rayleigh=
 0x7f7f52002288,_bckgrdcalib=0x7f7f5207f630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001d10)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fc10,_ctrlden=0x7f7f5110e468,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081708,_xlast=0x7f7f5201a8b8,_ylast=[0x7f7f52935ab0,
 0x7f7f52935ab0,0x7f7f52935ab0],_y0=0x7f7f53187cc0,_signus=0x7f7f532850a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f51081b28,_y=
 0x7f7f510814f8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f5110fcb8,_ey=
 0x7f7f511048d8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52019940,
 _flat_command=0x0,_extrapcmat=0x7f7f52009e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51104b08,_ctrlden=0x7f7f5110e9e0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511071d0,_xlast=0x7f7f52001ed0,_ylast=[0x7f7f51113030,0x7f7f51113030,
 0x7f7f51113030],_y0=0x7f7f51112b68,_signus=0x7f7f51106ef8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c1cb030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fbd8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f520029c0,yposition=
 0x7f7f52002988,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       73.2   0.065      359.2
Field Avg  1.65                     73.2   0.065      359.2
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f511125b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518095f0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518091d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c8b1030,_masks=0x0,_fluxpersub=0x7f7f5201b308,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201a498,_skyfluxpersub=0x7f7f51808678,
 _nphotons=56.0429,_skynphotons=0,_tt=[0.0165673,0.0193419],_lastvalidtt=
 [0.0165673,0.0193419],_upttcommand=[0,0],_refmes=0x7f7f507ac650,_tiprefv=
 0x7f7f52934b80,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f5327d980,_tiltrefvn=
 0x7f7f53281b70,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a7b0,_jstart=0x7f7f5201a180,_binindices=0x7f7f51899a30,
 _binxy=10,_centroidw=0x7f7f51111ca8,_fimage=0x7f7f5127a830,_fimage2=0x0,
 _imistart=0x7f7f510810d8,_imjstart=0x7f7f51081810,_imistart2=0x7f7f5201b518,
 _imjstart2=0x7f7f518092d8,_unittip=0x7f7f51815830,_unittilt=0x7f7f51816030,
 _lgs_defocuses=0x7f7f52002918,_unitdefocus=0x10c730030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509dde30,_flat=0x7f7f509da430,_domask=1,
 _submask=0x7f7f509d6a30,_kernel=0x7f7f50935e30,_kernels=0x10beb1030,_kerfftr=
 0x10c14c030,_kerffti=0x10c4c9030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51194030,_x=0x7f7f5069f7e0,_y=0x7f7f506adbe0,_centroidgain=1,_rayleigh=
 0x7f7f5110eb68,_bckgrdcalib=0x7f7f509ccc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001df0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51106fa0,_ctrlden=0x7f7f520028a8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f510814f8,_xlast=0x7f7f51081708,_ylast=[0x7f7f533e0010,
 0x7f7f533e0010,0x7f7f533e0010],_y0=0x7f7f533e1a70,_signus=0x7f7f530efc20,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51808360,_y=
 0x7f7f51081b28,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f52002170,_ey=
 0x7f7f52001ca0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a8b8,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511055f8,_ctrlden=0x7f7f52001cd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110e9e0,_xlast=0x7f7f5110fc10,_ylast=[0x7f7f51113cf0,0x7f7f51113cf0,
 0x7f7f51113cf0],_y0=0x7f7f51113d78,_signus=0x7f7f511071d0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52001ed0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f52001c68,yposition=
 0x7f7f51105588,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.001,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       55.2   0.159      293.4
Field Avg  1.65                     55.2   0.159      293.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f511128c0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808780,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f510811e0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c591030,_masks=0x0,_fluxpersub=0x7f7f5201b518,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f518092d8,_skyfluxpersub=0x7f7f5201b308,
 _nphotons=112.086,_skynphotons=0,_tt=[0.00647267,0.0112446],_lastvalidtt=
 [0.00647267,0.0112446],_upttcommand=[0,0],_refmes=0x7f7f531843c0,_tiprefv=
 0x7f7f507ac650,_tiltrefv=0x7f7f53187cc0,_tiprefvn=0x7f7f507acbc0,_tiltrefvn=
 0x7f7f531022f0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51807f40,_jstart=0x7f7f518091d0,_binindices=0x7f7f5200ac30,
 _binxy=10,_centroidw=0x7f7f51113030,_fimage=0x7f7f51201230,_fimage2=0x0,
 _imistart=0x7f7f5201a498,_imjstart=0x7f7f518096f8,_imistart2=0x7f7f510810d8,
 _imjstart2=0x7f7f51081810,_unittip=0x7f7f512ef430,_unittilt=0x7f7f51190630,
 _lgs_defocuses=0x7f7f520021e0,_unitdefocus=0x10bf31030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5128fa30,_flat=0x7f7f512e9230,_domask=1,
 _submask=0x7f7f5127a830,_kernel=0x7f7f509ccc30,_kernels=0x10c5d2030,_kerfftr=
 0x10c4c9030,_kerffti=0x10beb1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f511c7030,_x=0x7f7f530efc20,_y=0x7f7f533e1e30,_centroidgain=1,_rayleigh=
 0x7f7f52002918,_bckgrdcalib=0x7f7f51192e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001d10)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e970,_ctrlden=0x7f7f52002288,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51081b28,_xlast=0x7f7f510814f8,_ylast=[0x7f7f533e1a70,
 0x7f7f533e1a70,0x7f7f533e1a70],_y0=0x7f7f533e3610,_signus=0x7f7f533e0910,
 _puppixoffset=[0,0],_nact=45,_def=0x10db79030,_x=0x7f7f5201b200,_y=
 0x7f7f51808360,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c46d030,_ex=0x7f7f520029c0,_ey=
 0x7f7f5110ea50,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51081708,
 _flat_command=0x0,_extrapcmat=0x7f7f51116830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51110000,_ctrlden=0x7f7f51106e88,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001cd8,_xlast=0x7f7f51106fa0,_ylast=[0x7f7f51113e88,0x7f7f51113e88,
 0x7f7f51113e88],_y0=0x7f7f51112ae0,_signus=0x7f7f5110e9e0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c1cb030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fc10,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f5110ee08,yposition=
 0x7f7f5110fbd8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 40.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       47.3   0.297      252.9
Field Avg  1.65                     47.3   0.297      252.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=40,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112528,winddir=0x7f7f51112a58,
 _layeralt=0x7f7f51111d30)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 12,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa88,lgs_prof_alt=
 0x7f7f520029f8,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808fc0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51807e38,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c690030,_masks=0x0,_fluxpersub=0x7f7f510810d8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081810,_skyfluxpersub=0x7f7f5201b518,
 _nphotons=280.214,_skynphotons=0,_tt=[-0.00255055,-0.0139202],_lastvalidtt=
 [-0.00255055,-0.0139202],_upttcommand=[0,0],_refmes=0x7f7f506a0290,_tiprefv=
 0x7f7f507ace00,_tiltrefv=0x7f7f506ada80,_tiprefvn=0x7f7f507ac650,_tiltrefvn=
 0x7f7f506adcc0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808468,_jstart=0x7f7f510811e0,_binindices=0x7f7f5118ce30,
 _binxy=10,_centroidw=0x7f7f51113cf0,_fimage=0x7f7f51197a30,_fimage2=0x0,
 _imistart=0x7f7f518092d8,_imjstart=0x7f7f5201aac8,_imistart2=0x7f7f5201a498,
 _imjstart2=0x7f7f518096f8,_unittip=0x7f7f51153830,_unittilt=0x7f7f5119c430,
 _lgs_defocuses=0x7f7f52001f78,_unitdefocus=0x10c807030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51295c30,_flat=0x7f7f5128b030,_domask=1,
 _submask=0x7f7f51287630,_kernel=0x7f7f5127a830,_kernels=0x10beb1030,_kerfftr=
 0x10c0cb030,_kerffti=0x10c14c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51280430,_x=0x7f7f533e0010,_y=0x7f7f533e1a70,_centroidgain=1,_rayleigh=
 0x7f7f520021e0,_bckgrdcalib=0x7f7f5128ea30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f52001df0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511049b8,_ctrlden=0x7f7f520029c0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808360,_xlast=0x7f7f51081b28,_ylast=[0x7f7f533e3080,
 0x7f7f533e3080,0x7f7f533e3080],_y0=0x7f7f533e2330,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10cd5e030,_x=0x7f7f51022b80,_y=
 0x7f7f5201b200,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c771030,_ex=0x7f7f52001c68,_ey=
 0x7f7f51107080,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f510814f8,
 _flat_command=0x0,_extrapcmat=0x7f7f5093de30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001ca0,_ctrlden=0x7f7f5110eaf8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51106e88,_xlast=0x7f7f5110e970,_ylast=[0x7f7f511134f8,0x7f7f511134f8,
 0x7f7f511134f8],_y0=0x7f7f51113608,_signus=0x7f7f52001cd8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51106fa0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f51104e18,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f5110e4d8,xposition=0x7f7f5110ff90,yposition=
 0x7f7f52001ed0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f5110f938,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.005,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      139.5   0.044      293.4
Field Avg  1.65                    139.5   0.044      293.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51113be0,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51112fa8,winddir=0x7f7f51112b68,
 _layeralt=0x7f7f51111f50)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110fa50,lgs_prof_alt=
 0x7f7f52002020,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201aee8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a078,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c002030,_masks=0x0,_fluxpersub=0x7f7f518093e0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b728,_skyfluxpersub=0x7f7f51808eb8,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00820065,0.000500017],_lastvalidtt=
 [-0.00820065,0.000500017],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f531022f0,_tiltrefv=0x7f7f52922690,_tiprefvn=0x7f7f532785e0,_tiltrefvn=
 0x7f7f53280fa0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a8b8,_jstart=0x7f7f51808570,_binindices=0x7f7f5095e230,
 _binxy=10,_centroidw=0x7f7f51113580,_fimage=0x7f7f5127a830,_fimage2=0x0,
 _imistart=0x7f7f51808db0,_imjstart=0x7f7f518092d8,_imistart2=0x7f7f52019940,
 _imjstart2=0x7f7f51081600,_unittip=0x7f7f5117a030,_unittilt=0x7f7f51152630,
 _lgs_defocuses=0x7f7f51104ad0,_unitdefocus=0x10c5d2030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51876630,_flat=0x7f7f5186ba30,_domask=1,
 _submask=0x7f7f51868030,_kernel=0x7f7f50965630,_kernels=0x10c61b030,_kerfftr=
 0x10c196030,_kerffti=0x10c117030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f5128f630,_x=0x7f7f5300fb60,_y=0x7f7f533df8a0,_centroidgain=1,_rayleigh=
 0x7f7f5110ee08,_bckgrdcalib=0x7f7f5186f430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f511070f0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520023a0,_ctrlden=0x7f7f5110fe08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808468,_xlast=0x7f7f51808ba0,_ylast=[0x7f7f5327f110,
 0x7f7f5327f110,0x7f7f5327f110],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x10f67f030,_x=0x7f7f52019a48,_y=
 0x7f7f5201aac8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c04b030,_ex=0x7f7f51107198,_ey=
 0x7f7f5110eaf8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f51072c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52001f40,_ctrlden=0x7f7f52002250,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f520020c8,_xlast=0x7f7f5110ffc8,_ylast=[0x7f7f51113938,0x7f7f51113938,
 0x7f7f51113938],_y0=0x7f7f51113e88,_signus=0x7f7f51106ef8,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110ecf0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110ec48,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f52002288,xposition=0x7f7f52001d10,yposition=
 0x7f7f5110fbd8,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52002170,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      139.5   0.044      293.4
Field Avg  1.65                    139.5   0.044      293.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113a48)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201aee8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51807e38,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bd47030,_masks=0x0,_fluxpersub=0x7f7f51808eb8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b728,_skyfluxpersub=0x7f7f518093e0,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00786115,0.000775805],_lastvalidtt=
 [-0.00786115,0.000775805],_upttcommand=[0,0],_refmes=0x7f7f507ac440,_tiprefv=
 0x7f7f533ef9e0,_tiltrefv=0x7f7f528b28e0,_tiprefvn=0x7f7f533efc20,_tiltrefvn=
 0x7f7f533f00a0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51809800,_jstart=0x7f7f5201a8b8,_binindices=0x7f7f511d0230,
 _binxy=10,_centroidw=0x7f7f51112bf0,_fimage=0x7f7f50a08c30,_fimage2=0x0,
 _imistart=0x7f7f51022b80,_imjstart=0x7f7f5201abd0,_imistart2=0x7f7f5201a6a8,
 _imjstart2=0x7f7f51808570,_unittip=0x7f7f509fd430,_unittilt=0x7f7f509c7e30,
 _lgs_defocuses=0x7f7f52002448,_unitdefocus=0x10c48c030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509ece30,_flat=0x7f7f509c2a30,_domask=1,
 _submask=0x7f7f509f9a30,_kernel=0x7f7f5207ea30,_kernels=0x10c50c030,_kerfftr=
 0x10c0ae030,_kerffti=0x10c02f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a22a30,_x=0x7f7f53102070,_y=0x7f7f531022f0,_centroidgain=1,_rayleigh=
 0x7f7f5110f820,_bckgrdcalib=0x7f7f509f0830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fe08,_ctrlden=0x7f7f511055f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ca8,_xlast=0x7f7f5201aac8,_ylast=[0x7f7f533f02e0,
 0x7f7f533f02e0,0x7f7f533f02e0],_y0=0x7f7f533f0970,_signus=0x7f7f533e4f60,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f51808db0,_y=
 0x7f7f5201a078,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c12d030,_ex=0x7f7f52001df0,_ey=
 0x7f7f5110e6d0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b620,
 _flat_command=0x0,_extrapcmat=0x7f7f52002c30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110fa50,_ctrlden=0x7f7f52002288,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110f970,_xlast=0x7f7f52002330,_ylast=[0x7f7f51111f50,0x7f7f51111f50,
 0x7f7f51111f50],_y0=0x7f7f511138b0,_signus=0x7f7f52002410,_puppixoffset=[0,0],
 _nact=2,_def=0x10bd90030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51105630,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110faf8,yposition=
 0x7f7f52002020,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.408      172.0
Field Avg  1.65                     44.5   0.408      172.0
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113608)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f510811e0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f510814f8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c32b030,_masks=0x0,_fluxpersub=0x7f7f5201a6a8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808570,_skyfluxpersub=0x7f7f51808eb8,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00992498,-0.00360036],_lastvalidtt=
 [-0.00992498,-0.00360036],_upttcommand=[0,0],_refmes=0x7f7f53286880,_tiprefv=
 0x7f7f507ac1c0,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f507ad1e0,_tiltrefvn=
 0x7f7f53280340,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808a98,_jstart=0x7f7f51807e38,_binindices=0x7f7f511cda30,
 _binxy=10,_centroidw=0x7f7f51112390,_fimage=0x7f7f509db630,_fimage2=0x0,
 _imistart=0x7f7f5201b728,_imjstart=0x7f7f5201b308,_imistart2=0x7f7f51022b80,
 _imjstart2=0x7f7f5201abd0,_unittip=0x7f7f511a0830,_unittilt=0x7f7f5127ea30,
 _lgs_defocuses=0x7f7f520023d8,_unitdefocus=0x10c443030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51203430,_flat=0x7f7f511dea30,_domask=1,
 _submask=0x7f7f511db030,_kernel=0x7f7f511ca030,_kernels=0x10c02f030,_kerfftr=
 0x10c25f030,_kerffti=0x10c50c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509abc30,_x=0x7f7f528afd30,_y=0x7f7f533e4f60,_centroidgain=1,_rayleigh=
 0x7f7f52002448,_bckgrdcalib=0x7f7f51206e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002918,_ctrlden=0x7f7f5110f938,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a078,_xlast=0x7f7f51808ca8,_ylast=[0x7f7f506ae340,
 0x7f7f506ae340,0x7f7f506ae340],_y0=0x7f7f506a0290,_signus=0x7f7f506a2f10,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f51808678,_y=
 0x7f7f51808db0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf17030,_ex=0x7f7f52002170,_ey=
 0x7f7f5110f6d0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201aac8,
 _flat_command=0x0,_extrapcmat=0x7f7f509c7230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f511071d0,_ctrlden=0x7f7f5110ec48,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002288,_xlast=0x7f7f5110fe08,_ylast=[0x7f7f51112e98,0x7f7f51112e98,
 0x7f7f51112e98],_y0=0x7f7f51113d78,_signus=0x7f7f5110f970,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002330,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110f900,yposition=
 0x7f7f5110f858,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.582      126.5
Field Avg  1.65                     44.5   0.582      126.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112f20)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081b28,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808048,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10be70030,_masks=0x0,_fluxpersub=0x7f7f51022b80,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201abd0,_skyfluxpersub=0x7f7f5201a6a8,
 _nphotons=28154.7,_skynphotons=0,_tt=[-0.00147692,-0.00216303],_lastvalidtt=
 [-0.00147692,-0.00216303],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f507ad420,_tiltrefv=0x7f7f506ae6e0,_tiprefvn=0x7f7f507ac1c0,_tiltrefvn=
 0x7f7f506aeba0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f518090c8,_jstart=0x7f7f510814f8,_binindices=0x7f7f509ece30,
 _binxy=10,_centroidw=0x7f7f51111f50,_fimage=0x7f7f511c7030,_fimage2=0x0,
 _imistart=0x7f7f51808570,_imjstart=0x7f7f5201b410,_imistart2=0x7f7f5201b728,
 _imjstart2=0x7f7f5201b308,_unittip=0x7f7f51815830,_unittilt=0x7f7f51816030,
 _lgs_defocuses=0x7f7f5110e938,_unitdefocus=0x10bf7d030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509fb630,_flat=0x7f7f509a4a30,_domask=1,
 _submask=0x7f7f509f7c30,_kernel=0x7f7f509f4230,_kernels=0x10c0ae030,_kerfftr=
 0x10c50c030,_kerffti=0x10c02f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51191630,_x=0x7f7f506ae920,_y=0x7f7f506ae340,_centroidgain=1,_rayleigh=
 0x7f7f520023d8,_bckgrdcalib=0x7f7f509a8430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110e6d0,_ctrlden=0x7f7f5110f7b0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808db0,_xlast=0x7f7f5201a078,_ylast=[0x7f7f533e55c0,
 0x7f7f533e55c0,0x7f7f533e55c0],_y0=0x7f7f528b28e0,_signus=0x7f7f533df8a0,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f51809908,_y=
 0x7f7f51808678,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c3f8030,_ex=0x7f7f5110faf8,_ey=
 0x7f7f52002100,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f5119fa30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51106e88,_ctrlden=0x7f7f5110f5b8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110ec48,_xlast=0x7f7f52002918,_ylast=[0x7f7f51111d30,0x7f7f51111d30,
 0x7f7f51111d30],_y0=0x7f7f51112280,_signus=0x7f7f52002288,_puppixoffset=[0,0],
 _nact=2,_def=0x10bdd0030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110fe08,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f52002a30,yposition=
 0x7f7f51105630,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       45.9   0.483      156.8
Field Avg  1.65                     45.9   0.483      156.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113b58)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=6,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807f40,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f52019d60,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c692030,_masks=0x0,_fluxpersub=0x7f7f5201b728,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b308,_skyfluxpersub=0x7f7f51022b80,
 _nphotons=28154.7,_skynphotons=0,_tt=[0.00229081,-0.00230494],_lastvalidtt=
 [0.00229081,-0.00230494],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f506ae340,_tiltrefv=0x7f7f506a0290,_tiprefvn=0x7f7f506aefa0,_tiltrefvn=
 0x7f7f506ae580,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a7b0,_jstart=0x7f7f51808048,_binindices=0x7f7f509ebe30,
 _binxy=10,_centroidw=0x7f7f51112e98,_fimage=0x7f7f5128f630,_fimage2=0x0,
 _imistart=0x7f7f5201abd0,_imjstart=0x7f7f52019b50,_imistart2=0x7f7f51808570,
 _imjstart2=0x7f7f5201b410,_unittip=0x7f7f50948630,_unittilt=0x7f7f50944e30,
 _lgs_defocuses=0x7f7f5110f580,_unitdefocus=0x10cb1c030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509e4e30,_flat=0x7f7f50965630,_domask=1,
 _submask=0x7f7f50961c30,_kernel=0x7f7f5095e230,_kernels=0x10c02f030,_kerfftr=
 0x10c25f030,_kerffti=0x10c0ae030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51296830,_x=0x7f7f531022f0,_y=0x7f7f52934ce0,_centroidgain=1,_rayleigh=
 0x7f7f5110e938,_bckgrdcalib=0x7f7f509ddc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51110000,_ctrlden=0x7f7f5110f7e8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808678,_xlast=0x7f7f51808db0,_ylast=[0x7f7f528b28e0,
 0x7f7f528b28e0,0x7f7f528b28e0],_y0=0x7f7f533e73c0,_signus=0x7f7f533e5e10,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f5201b620,_y=
 0x7f7f51809908,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c12d030,_ex=0x7f7f5110f900,_ey=
 0x7f7f5110fc10,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a078,
 _flat_command=0x0,_extrapcmat=0x7f7f50948e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110faf8,_ctrlden=0x7f7f5110f5f0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110f5b8,_xlast=0x7f7f5110e6d0,_ylast=[0x7f7f511121f8,0x7f7f511121f8,
 0x7f7f511121f8],_y0=0x7f7f51112170,_signus=0x7f7f5110ec48,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002918,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f520028e0,yposition=
 0x7f7f52002330,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.9,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      152.4   0.042      298.5
Field Avg  1.65                    152.4   0.042      298.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f5100b450)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51081a20,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f518093e0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c831030,_masks=0x0,_fluxpersub=0x7f7f51808570,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201b410,_skyfluxpersub=0x7f7f5201b728,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.0048358,0.00304337],_lastvalidtt=
 [-0.0048358,0.00304337],_upttcommand=[0,0],_refmes=0x7f7f531843c0,_tiprefv=
 0x7f7f533e6200,_tiltrefv=0x7f7f507ae4e0,_tiprefvn=0x7f7f533e6440,_tiltrefvn=
 0x7f7f507ae720,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f510810d8,_jstart=0x7f7f52019d60,_binindices=0x7f7f509e4e30,
 _binxy=10,_centroidw=0x7f7f51111d30,_fimage=0x7f7f518c1230,_fimage2=0x0,
 _imistart=0x7f7f5201b308,_imjstart=0x7f7f51808360,_imistart2=0x7f7f5201abd0,
 _imjstart2=0x7f7f52019b50,_unittip=0x7f7f5118f630,_unittilt=0x7f7f511a0830,
 _lgs_defocuses=0x7f7f5110ee08,_unitdefocus=0x10c591030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f5187b430,_flat=0x7f7f51877a30,_domask=1,
 _submask=0x7f7f51874030,_kernel=0x7f7f509ee830,_kernels=0x10c0ae030,_kerfftr=
 0x10c50c030,_kerffti=0x10c02f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f518c4c30,_x=0x7f7f533e73c0,_y=0x7f7f533e7680,_centroidgain=1,_rayleigh=
 0x7f7f5110f580,_bckgrdcalib=0x7f7f5186ce30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51106f30,_ctrlden=0x7f7f5110f900,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51809908,_xlast=0x7f7f51808678,_ylast=[0x7f7f533e7000,
 0x7f7f533e7000,0x7f7f533e7000],_y0=0x7f7f533e4f60,_signus=0x7f7f530efc20,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f5201aac8,_y=
 0x7f7f5201b620,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf17030,_ex=0x7f7f52002a30,_ey=
 0x7f7f5110ffc8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808db0,
 _flat_command=0x0,_extrapcmat=0x7f7f52009e30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002170,_ctrlden=0x7f7f51106e88,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110f5f0,_xlast=0x7f7f51110000,_ylast=[0x7f7f511134f8,0x7f7f511134f8,
 0x7f7f511134f8],_y0=0x7f7f511132d8,_signus=0x7f7f5110f5b8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bdd0030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110e6d0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110ec10,yposition=
 0x7f7f5110fe08,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       45.2   0.389      177.0
Field Avg  1.65                     45.2   0.389      177.0
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51111fd8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f518091d0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808eb8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c443030,_masks=0x0,_fluxpersub=0x7f7f5201abd0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f52019b50,_skyfluxpersub=0x7f7f51808570,
 _nphotons=1776.44,_skynphotons=0,_tt=[-0.0100406,-0.000829351],_lastvalidtt=
 [-0.0100406,-0.000829351],_upttcommand=[0,0],_refmes=0x7f7f533dfe00,_tiprefv=
 0x7f7f507ae160,_tiltrefv=0x7f7f531022f0,_tiprefvn=0x7f7f507af010,_tiltrefvn=
 0x7f7f52934b80,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51808468,_jstart=0x7f7f518093e0,_binindices=0x7f7f509e8c30,
 _binxy=10,_centroidw=0x7f7f511121f8,_fimage=0x7f7f5128b030,_fimage2=0x0,
 _imistart=0x7f7f5201b410,_imjstart=0x7f7f5201aee8,_imistart2=0x7f7f5201b308,
 _imjstart2=0x7f7f51808360,_unittip=0x7f7f51194630,_unittilt=0x7f7f5118f630,
 _lgs_defocuses=0x7f7f511048d8,_unitdefocus=0x10c36c030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509f3830,_flat=0x7f7f509d6a30,_domask=1,
 _submask=0x7f7f509c2a30,_kernel=0x7f7f50a05430,_kernels=0x10c25f030,_kerfftr=
 0x10c02f030,_kerffti=0x10c0ae030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51297030,_x=0x7f7f528afd30,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f5110ee08,_bckgrdcalib=0x7f7f509ec630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110eac0,_ctrlden=0x7f7f5110fc10,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201b620,_xlast=0x7f7f51809908,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f53285210,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f51808ca8,_y=
 0x7f7f5201aac8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c3f8030,_ex=0x7f7f520028e0,_ey=
 0x7f7f52002090,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808678,
 _flat_command=0x0,_extrapcmat=0x7f7f5119fa30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f51104ec0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51106e88,_xlast=0x7f7f51106f30,_ylast=[0x7f7f511139c0,0x7f7f511139c0,
 0x7f7f511139c0],_y0=0x7f7f51113ad0,_signus=0x7f7f5110f5f0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51110000,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110ea50,yposition=
 0x7f7f52002918,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.1   0.571      131.5
Field Avg  1.65                     44.1   0.571      131.5
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112948)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a390,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201a6a8,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10bf7d030,_masks=0x0,_fluxpersub=0x7f7f5201b308,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51808360,_skyfluxpersub=0x7f7f5201abd0,
 _nphotons=1776.44,_skynphotons=0,_tt=[0.00183784,-0.00604144],_lastvalidtt=
 [0.00183784,-0.00604144],_upttcommand=[0,0],_refmes=0x7f7f5069f7e0,_tiprefv=
 0x7f7f506a0290,_tiltrefv=0x7f7f506ae340,_tiprefvn=0x7f7f506ae580,_tiltrefvn=
 0x7f7f506aeb40,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b830,_jstart=0x7f7f51808eb8,_binindices=0x7f7f50965430,
 _binxy=10,_centroidw=0x7f7f511134f8,_fimage=0x7f7f509fb430,_fimage2=0x0,
 _imistart=0x7f7f52019b50,_imjstart=0x7f7f510811e0,_imistart2=0x7f7f5201b410,
 _imjstart2=0x7f7f5201aee8,_unittip=0x7f7f509c6430,_unittilt=0x7f7f509c6c30,
 _lgs_defocuses=0x7f7f520023d8,_unitdefocus=0x10be08030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50977430,_flat=0x7f7f5096c830,_domask=1,
 _submask=0x7f7f509dfa30,_kernel=0x7f7f509c2a30,_kernels=0x10c0ae030,_kerfftr=
 0x10c50c030,_kerffti=0x10c25f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50968e30,_x=0x7f7f52935790,_y=0x7f7f5327bf90,_centroidgain=1,_rayleigh=
 0x7f7f511048d8,_bckgrdcalib=0x7f7f50970230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110ff90,_ctrlden=0x7f7f511055f8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201aac8,_xlast=0x7f7f5201b620,_ylast=[0x7f7f53285210,
 0x7f7f53285210,0x7f7f53285210],_y0=0x7f7f52934b80,_signus=0x7f7f53271470,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f5201a078,_y=
 0x7f7f51808ca8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c12d030,_ex=0x7f7f5110ec10,_ey=
 0x7f7f520029f8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51809908,
 _flat_command=0x0,_extrapcmat=0x7f7f50946830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f51110038,_ctrlden=0x7f7f52001e28,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f51104ec0,_xlast=0x7f7f5110eac0,_ylast=[0x7f7f511129d0,0x7f7f511129d0,
 0x7f7f511129d0],_y0=0x7f7f51113030,_signus=0x7f7f51106e88,_puppixoffset=[0,0],
 _nact=2,_def=0x10bdd0030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51106f30,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110f628,yposition=
 0x7f7f5110e6d0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       45.9   0.470      161.9
Field Avg  1.65                     45.9   0.470      161.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112060)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=9,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201ade0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51022b80,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cb1c030,_masks=0x0,_fluxpersub=0x7f7f5201b410,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f5201aee8,_skyfluxpersub=0x7f7f5201b308,
 _nphotons=1776.44,_skynphotons=0,_tt=[0.00495519,-0.00393356],_lastvalidtt=
 [0.00495519,-0.00393356],_upttcommand=[0,0],_refmes=0x7f7f507ac440,_tiprefv=
 0x7f7f533e4f60,_tiltrefv=0x7f7f528b28e0,_tiprefvn=0x7f7f533e51a0,_tiltrefvn=
 0x7f7f533e5620,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a180,_jstart=0x7f7f5201a6a8,_binindices=0x7f7f51198830,
 _binxy=10,_centroidw=0x7f7f511139c0,_fimage=0x7f7f51191630,_fimage2=0x0,
 _imistart=0x7f7f51808360,_imjstart=0x7f7f51081b28,_imistart2=0x7f7f52019b50,
 _imjstart2=0x7f7f510811e0,_unittip=0x7f7f5118f630,_unittilt=0x7f7f5127ea30,
 _lgs_defocuses=0x7f7f5110fa50,_unitdefocus=0x10beb1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511d9030,_flat=0x7f7f511ce430,_domask=1,
 _submask=0x7f7f511caa30,_kernel=0x7f7f511c7030,_kernels=0x10c25f030,_kerfftr=
 0x10c02f030,_kerffti=0x10c0ae030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51292230,_x=0x7f7f5300fb60,_y=0x7f7f533e5860,_centroidgain=1,_rayleigh=
 0x7f7f520023d8,_bckgrdcalib=0x7f7f511d1e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002020,_ctrlden=0x7f7f5110f970,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808ca8,_xlast=0x7f7f5201aac8,_ylast=[0x7f7f52934b80,
 0x7f7f52934b80,0x7f7f52934b80],_y0=0x7f7f531022f0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f51808db0,_y=
 0x7f7f5201a078,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf17030,_ex=0x7f7f5110ea50,_ey=
 0x7f7f51106ec0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201b620,
 _flat_command=0x0,_extrapcmat=0x7f7f5114ec30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002170,_ctrlden=0x7f7f511071d0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52001e28,_xlast=0x7f7f5110ff90,_ylast=[0x7f7f51112308,0x7f7f51112308,
 0x7f7f51112308],_y0=0x7f7f51113cf0,_signus=0x7f7f51104ec0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110eac0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f51106fd8,yposition=
 0x7f7f51110000,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.9,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      200.0   0.031      338.9
Field Avg  1.65                    200.0   0.031      338.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112d88)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 50,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201b200,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b728,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c591030,_masks=0x0,_fluxpersub=0x7f7f52019b50,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f510811e0,_skyfluxpersub=0x7f7f5201b410,
 _nphotons=7.07214e-14,_skynphotons=0,_tt=[0.0164663,-0.00262527],_lastvalidtt=
 [0.0164663,-0.00262527],_upttcommand=[0,0],_refmes=0x7f7f507ac440,_tiprefv=
 0x7f7f506ae580,_tiltrefv=0x7f7f53280fa0,_tiprefvn=0x7f7f53187cc0,_tiltrefvn=
 0x7f7f53280340,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201b0f8,_jstart=0x7f7f51022b80,_binindices=0x7f7f5186ce30,
 _binxy=10,_centroidw=0x7f7f511129d0,_fimage=0x7f7f50a2fe30,_fimage2=0x0,
 _imistart=0x7f7f5201aee8,_imjstart=0x7f7f51807f40,_imistart2=0x7f7f51808360,
 _imjstart2=0x7f7f51081b28,_unittip=0x7f7f51194630,_unittilt=0x7f7f511a0830,
 _lgs_defocuses=0x7f7f520028e0,_unitdefocus=0x10bd47030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f51893630,_flat=0x7f7f51873030,_domask=1,
 _submask=0x7f7f5188fc30,_kernel=0x7f7f5188c230,_kernels=0x10c50c030,_kerfftr=
 0x10c0ae030,_kerffti=0x10c25f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f509c2a30,_x=0x7f7f528afd30,_y=0x7f7f530efc20,_centroidgain=1,_rayleigh=
 0x7f7f5110fa50,_bckgrdcalib=0x7f7f51897030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520029f8,_ctrlden=0x7f7f5110ffc8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f5201a078,_xlast=0x7f7f51808ca8,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53272310,_signus=0x7f7f532754e0,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f51808678,_y=
 0x7f7f51808db0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c3f8030,_ex=0x7f7f5110f628,_ey=
 0x7f7f5110f6d0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201aac8,
 _flat_command=0x0,_extrapcmat=0x7f7f51819230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520023a0,_ctrlden=0x7f7f511048d8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511071d0,_xlast=0x7f7f52002020,_ylast=[0x7f7f51113690,0x7f7f51113690,
 0x7f7f51113690],_y0=0x7f7f51111db8,_signus=0x7f7f52001e28,_puppixoffset=[0,0],
 _nact=2,_def=0x10bdd0030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5110ff90,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110f778,yposition=
 0x7f7f51106f30,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.01,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      299.7   0.014      485.6
Field Avg  1.65                    299.7   0.014      485.6
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51113470)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 50,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51808fc0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f51808570,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c36c030,_masks=0x0,_fluxpersub=0x7f7f51808360,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081b28,_skyfluxpersub=0x7f7f52019b50,
 _nphotons=7.07214e-14,_skynphotons=0,_tt=[0.00863264,0.00179357],_lastvalidtt=
 [0.00863264,0.00179357],_upttcommand=[0,0],_refmes=0x7f7f507ad4a0,_tiprefv=
 0x7f7f533e4f60,_tiltrefv=0x7f7f528b28e0,_tiprefvn=0x7f7f533e51a0,_tiltrefvn=
 0x7f7f533e68d0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201a498,_jstart=0x7f7f5201b728,_binindices=0x7f7f51280430,
 _binxy=10,_centroidw=0x7f7f51112308,_fimage=0x7f7f509d6a30,_fimage2=0x0,
 _imistart=0x7f7f510811e0,_imjstart=0x7f7f51081a20,_imistart2=0x7f7f5201aee8,
 _imjstart2=0x7f7f51807f40,_unittip=0x7f7f52089430,_unittilt=0x7f7f52079630,
 _lgs_defocuses=0x7f7f51107160,_unitdefocus=0x10c872030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f511dca30,_flat=0x7f7f511d1e30,_domask=1,
 _submask=0x7f7f511ce430,_kernel=0x7f7f51191630,_kernels=0x10c25f030,_kerfftr=
 0x10c02f030,_kerffti=0x10c50c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a48030,_x=0x7f7f507acb70,_y=0x7f7f507ac1c0,_centroidgain=1,_rayleigh=
 0x7f7f520028e0,_bckgrdcalib=0x7f7f511d5830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f520023d8,_ctrlden=0x7f7f5110ee08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808db0,_xlast=0x7f7f5201a078,_ylast=[0x7f7f5327bf90,
 0x7f7f5327bf90,0x7f7f5327bf90],_y0=0x7f7f53187cc0,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f51809908,_y=
 0x7f7f51808678,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c12d030,_ex=0x7f7f51106fd8,_ey=
 0x7f7f52002100,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808ca8,
 _flat_command=0x0,_extrapcmat=0x7f7f50946830,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002a30,_ctrlden=0x7f7f52002288,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f511048d8,_xlast=0x7f7f520029f8,_ylast=[0x7f7f51112a58,0x7f7f51112a58,
 0x7f7f51112a58],_y0=0x7f7f511128c0,_signus=0x7f7f511071d0,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f52002020,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f5110f820,yposition=
 0x7f7f5110eac0,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.1,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0      589.0   0.002     1502.4
Field Avg  1.65                    589.0   0.002     1502.4
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f511124a0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 50,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f5201a8b8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201abd0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10be08030,_masks=0x0,_fluxpersub=0x7f7f5201aee8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51807f40,_skyfluxpersub=0x7f7f51808360,
 _nphotons=7.07214e-14,_skynphotons=0,_tt=[0.0153725,0.0227463],_lastvalidtt=
 [0.0153725,0.0227463],_upttcommand=[0,0],_refmes=0x7f7f507acb70,_tiprefv=
 0x7f7f5327bc60,_tiltrefv=0x7f7f533e51a0,_tiprefvn=0x7f7f532850a0,_tiltrefvn=
 0x7f7f528b28e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f5201aff0,_jstart=0x7f7f51808570,_binindices=0x7f7f50a5ac30,
 _binxy=10,_centroidw=0x7f7f51113690,_fimage=0x7f7f50a5e630,_fimage2=0x0,
 _imistart=0x7f7f51081b28,_imjstart=0x7f7f518091d0,_imistart2=0x7f7f510811e0,
 _imjstart2=0x7f7f51081a20,_unittip=0x7f7f50937e30,_unittilt=0x7f7f509c7e30,
 _lgs_defocuses=0x7f7f5110fe08,_unitdefocus=0x10c32b030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f50a6cc30,_flat=0x7f7f50a69230,_domask=1,
 _submask=0x7f7f50a48030,_kernel=0x7f7f509c2a30,_kernels=0x10c50c030,_kerfftr=
 0x10c0ae030,_kerffti=0x10c25f030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f50a33630,_x=0x7f7f53102070,_y=0x7f7f52934b80,_centroidgain=1,_rayleigh=
 0x7f7f51107160,_bckgrdcalib=0x7f7f50a62030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110e9e0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f7e8,_ctrlden=0x7f7f5110fcb8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51808678,_xlast=0x7f7f51808db0,_ylast=[0x7f7f53187cc0,
 0x7f7f53187cc0,0x7f7f53187cc0],_y0=0x7f7f531022f0,_signus=0x7f7f5326f040,
 _puppixoffset=[0,0],_nact=45,_def=0x10eb7b030,_x=0x7f7f5201b620,_y=
 0x7f7f51809908,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10bf17030,_ex=0x7f7f5110f778,_ey=
 0x7f7f5110e938,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f5201a078,
 _flat_command=0x0,_extrapcmat=0x7f7f5117c230,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110eaf8,_ctrlden=0x7f7f5110fa50,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f52002288,_xlast=0x7f7f520023d8,_ylast=[0x7f7f511138b0,0x7f7f511138b0,
 0x7f7f511138b0],_y0=0x7f7f51111ca8,_signus=0x7f7f511048d8,_puppixoffset=[0,0],
 _nact=2,_def=0x10bdd0030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520029f8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f52001f78,yposition=
 0x7f7f5110ff90,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.5,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0     1046.0   0.001     2584.9
Field Avg  1.65                   1046.0   0.001     2584.9
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	       = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	   = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	       = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	       = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	       = 7;
 dm(n).pitch	       = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	       = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt  = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	       = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	       = 0.6;
 loop.framedelay    = 1;
 loop.niter	       = 5000;
 loop.ittime	       = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=35,screen=0x7f7f51112b68,layerfrac=0x7f7f51111e40,
 layerspeed=0x7f7f51111ec8,layeralt=0x7f7f51113938,winddir=0x7f7f51112fa8,
 _layeralt=0x7f7f51112bf0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=
 50,skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f7f5110e468,lgs_prof_alt=
 0x7f7f5110f890,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f7f51807e38,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f7f5201b308,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10beb1030,_masks=0x0,_fluxpersub=0x7f7f510811e0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f7f51081a20,_skyfluxpersub=0x7f7f5201aee8,
 _nphotons=7.07214e-14,_skynphotons=0,_tt=[0.00661545,-0.0162035],_lastvalidtt=
 [0.00661545,-0.0162035],_upttcommand=[0,0],_refmes=0x7f7f506a03d0,_tiprefv=
 0x7f7f533e53e0,_tiltrefv=0x7f7f533e4f60,_tiprefvn=0x7f7f533e5620,_tiltrefvn=
 0x7f7f533e51a0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f7f51081810,_jstart=0x7f7f5201abd0,_binindices=0x7f7f50a42830,
 _binxy=10,_centroidw=0x7f7f51112a58,_fimage=0x7f7f51191630,_fimage2=0x0,
 _imistart=0x7f7f51807f40,_imjstart=0x7f7f5201a390,_imistart2=0x7f7f51081b28,
 _imjstart2=0x7f7f518091d0,_unittip=0x7f7f50937630,_unittilt=0x7f7f509c7c30,
 _lgs_defocuses=0x7f7f52002918,_unitdefocus=0x10be70030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f7f509da430,_flat=0x7f7f50a22030,_domask=1,
 _submask=0x7f7f509d6a30,_kernel=0x7f7f509c2a30,_kernels=0x10c25f030,_kerfftr=
 0x10c02f030,_kerffti=0x10c50c030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f7f51195030,_x=0x7f7f52934b80,_y=0x7f7f532754e0,_centroidgain=1,_rayleigh=
 0x7f7f5110fe08,_bckgrdcalib=0x7f7f509dde30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7f7f5110ec80)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f52002330,_ctrlden=0x7f7f51107198,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7f7f51809908,_xlast=0x7f7f51808678,_ylast=[0x7f7f531022f0,
 0x7f7f531022f0,0x7f7f531022f0],_y0=0x7f7f53285210,_signus=0x7f7f53102070,
 _puppixoffset=[0,0],_nact=45,_def=0x1103a4030,_x=0x7f7f5201aac8,_y=
 0x7f7f5201b620,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,
 _eiffile="sh6x6-if1-ext.fits",_edef=0x10c3f8030,_ex=0x7f7f5110f820,_ey=
 0x7f7f52002448,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f51808db0,
 _flat_command=0x0,_extrapcmat=0x7f7f5114ec30,_eltdefsize=0,_regmatrix=0x0,
 _fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,
 iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,
 unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f7f5110f778,_ctrlden=0x7f7f5110faf8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=
 0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],
 _x0=0x7f7f5110fa50,_xlast=0x7f7f5110f7e8,_ylast=[0x7f7f51113d78,0x7f7f51113d78,
 0x7f7f51113d78],_y0=0x7f7f51112838,_signus=0x7f7f52002288,_puppixoffset=[0,0],
 _nact=2,_def=0x10c3d2030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7f7f520023d8,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f7f5110fbd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f7f511070f0,xposition=0x7f7f52001f40,yposition=
 0x7f7f52002020,xspeed=0x0,yspeed=0x0,dispzoom=0x7f7f52001e98,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.9,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=500,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 35.0; 500 iterations
