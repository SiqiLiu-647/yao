=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0636  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fd3c280fd10,layerfrac=0x7fd3c280f490,
 layerspeed=0x7fd3c280fd98,layeralt=0x7fd3c30d8278,winddir=0x7fd3c30d7ec0,
 _layeralt=0x7fd3c280ffb8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=2,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fd3c30eee70,
 lgs_prof_alt=0x7fd3c30eedc8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=1,_svipc_subok=0x7fd3c303f898,_fork_subs=0x7fd3c1e2ed50,
 _fork_subs2=0x7fd3c1e31fb0,_validsubs=0x7fd3c281a528,_origpixsize=0.2,
 _rebinfactor=6,_gsalt=0,_gsdepth=0,_nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,
 _nsind=0x0,_cxdef=0x0,_sxdef=0x0,_tiltsh=0x103442030,_masks=0x0,_fluxpersub=
 0x7fd3c303f370,_rayleighflux=0x0,_sodiumflux=0x0,_raylfluxpersub=
 0x7fd3c303f478,_skyfluxpersub=0x7fd3c303f160,_nphotons=70721.4,_skynphotons=0,
 _tt=[0.00126719,-0.000856056],_lastvalidtt=[0.00126719,-0.000856056],
 _upttcommand=[0,0],_refmes=0x7fd3c1c422f0,_tiprefv=0x7fd3c1c43230,_tiltrefv=
 0x7fd3c1d0bad0,_tiprefvn=0x7fd3c1c43470,_tiltrefvn=0x7fd3c1d0bd10,_reordervec=
 0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,_istart=0x7fd3c2819ce8,
 _jstart=0x7fd3c2819ef8,_binindices=0x7fd3c286dc30,_binxy=10,_centroidw=
 0x7fd3c30d7f48,_fimage=0x7fd3c21b2e30,_fimage2=0x0,_imistart=0x7fd3c303f580,
 _imjstart=0x7fd3c303ee48,_imistart2=0x7fd3c28193a0,_imjstart2=0x7fd3c303ed40,
 _unittip=0x7fd3c20a2a30,_unittilt=0x7fd3c214d430,_lgs_defocuses=0x7fd3c30f19b8,
 _unitdefocus=0x1040a6030,_fimnx=60,_fimny=60,_fimny2=0x7fd3c31796d8,_yoffset=
 0x7fd3c3179940,_bias=0x7fd3c313d830,_flat=0x7fd3c31a1630,_domask=1,_submask=
 0x7fd3c284e030,_kernel=0x7fd3c2140230,_kernels=0x103fe2030,_kerfftr=
 0x103792030,_kerffti=0x103692030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fd3c21bea30,_x=0x7fd3c1d03e90,_y=0x7fd3c1d0b890,_centroidgain=1,_rayleigh=
 0x7fd3c30f1980,_bckgrdcalib=0x7fd3c31a5030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fd3c31799b0,_ctrlden=0x7fd3c3172ae0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fd3c303f790,_xlast=0x7fd3c303f268,_ylast=[0x7fd3c1e34d40,0x7fd3c1e34d40,
 0x7fd3c1e34d40],_y0=0x7fd3c1e2a830,_signus=0x7fd3c1e34fa0,_puppixoffset=[0,0],
 _nact=45,_def=0x10f33e030,_x=0x7fd3c281a000,_y=0x7fd3c303f688,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x103914030,_ex=0x7fd3c30eefc0,_ey=0x7fd3c3179898,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7fd3c2818c68,_flat_command=0x0,_extrapcmat=
 0x7fd3c315f430,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7fd3c30f1b78,_ctrlden=0x7fd3c30f1b08,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7fd3c30eeee0,_xlast=0x7fd3c3172b18,_ylast=
 [0x7fd3c30d88d8,0x7fd3c30d88d8,0x7fd3c30d88d8],_y0=0x7fd3c30d8f38,_signus=
 0x7fd3c30ef030,_puppixoffset=[0,0],_nact=2,_def=0x103e17030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fd3c30f1910,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fd3c30ee9a0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fd3c30eeff8,xposition=0x7fd3c30f1868,yposition=
 0x7fd3c30f1cc8,dispzoom=0x7fd3c30d28d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d10,layerfrac=0x7f8a15870c88,
 layerspeed=0x7f8a15870d98,layeralt=0x7f8a158df2e0,winddir=0x7f8a158df0c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14012e88,
 lgs_prof_alt=0x7f8a14845660,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956990,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cddc030,_masks=0x0,_fluxpersub=0x7f8a1595f3b0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15956258,_skyfluxpersub=0x7f8a15956780,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000734853,-0.000802187],_lastvalidtt=
 [0.000734853,-0.000802187],_upttcommand=[0,0],_refmes=0x7f8a13c0fe60,_tiprefv=
 0x7f8a13c13870,_tiltrefv=0x7f8a13c14060,_tiprefvn=0x7f8a13c142a0,_tiltrefvn=
 0x7f8a13c144e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a14810908,_jstart=0x7f8a1595ff08,_binindices=0x7f8a15995030,
 _binxy=10,_centroidw=0x7f8a158df3f0,_fimage=0x7f8a15a11c30,_fimage2=0x0,
 _imistart=0x7f8a1595f8d8,_imjstart=0x7f8a15955f40,_imistart2=0x7f8a15956468,
 _imjstart2=0x7f8a15084bf0,_unittip=0x7f8a15981430,_unittilt=0x7f8a15976030,
 _lgs_defocuses=0x7f8a14845548,_unitdefocus=0x10da3d030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a1501ee30,_flat=0x7f8a140d3c30,_domask=1,
 _submask=0x7f8a15010830,_kernel=0x7f8a15a0e230,_kernels=0x10cb39030,_kerfftr=
 0x10d9af030,_kerffti=0x10dad1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a1598de30,_x=0x7f8a13f54fd0,_y=0x7f8a13f55940,_centroidgain=1,_rayleigh=
 0x7f8a148454a0,_bckgrdcalib=0x7f8a14108e30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a148455f0,_ctrlden=0x7f8a14013588,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15956048,_xlast=0x7f8a1595fbf0,_ylast=[0x7f8a13d0cca0,0x7f8a13d0cca0,
 0x7f8a13d0cca0],_y0=0x7f8a13d0d6f0,_signus=0x7f8a13d0cf00,_puppixoffset=[0,0],
 _nact=45,_def=0x10fe1f030,_x=0x7f8a15960220,_y=0x7f8a15960118,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d45c030,_ex=0x7f8a140131d0,_ey=0x7f8a148454d8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a1595fae8,_flat_command=0x0,_extrapcmat=
 0x7f8a1403ac30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a148459a8,_ctrlden=0x7f8a158d3af8,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a14845580,_xlast=0x7f8a14013550,_ylast=
 [0x7f8a158c9d28,0x7f8a158c9d28,0x7f8a158c9d28],_y0=0x7f8a158e01c0,_signus=
 0x7f8a140134a8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a158f6c80,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a158d9c60,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158de180,xposition=0x7f8a14845858,yposition=
 0x7f8a158d3b68,dispzoom=0x7f8a14013320,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870c88,layerfrac=0x7f8a15870d98,
 layerspeed=0x7f8a15870d10,layeralt=0x7f8a158df3f0,winddir=0x7f8a158e01c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a140131d0,
 lgs_prof_alt=0x7f8a148454d8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a14810908,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a1595f7d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10cd9b030,_masks=0x0,_fluxpersub=0x7f8a1595fae8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15960118,_skyfluxpersub=0x7f8a15960220,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00111353,-0.00089309],_lastvalidtt=
 [0.00111353,-0.00089309],_upttcommand=[0,0],_refmes=0x7f8a13e04e60,_tiprefv=
 0x7f8a13f549c0,_tiltrefv=0x7f8a13d0cca0,_tiprefvn=0x7f8a13f55e10,_tiltrefvn=
 0x7f8a13d0cee0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a1595f8d8,_jstart=0x7f8a1595ff08,_binindices=0x7f8a159f3630,
 _binxy=10,_centroidw=0x7f8a158e08a8,_fimage=0x7f8a159f7030,_fimage2=0x0,
 _imistart=0x7f8a1595f1a0,_imjstart=0x7f8a1595f3b0,_imistart2=0x7f8a15956990,
 _imjstart2=0x7f8a15956678,_unittip=0x7f8a14034430,_unittilt=0x7f8a14061830,
 _lgs_defocuses=0x7f8a14845468,_unitdefocus=0x10d675030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a148a4a30,_flat=0x7f8a1487c630,_domask=1,
 _submask=0x7f8a148a1030,_kernel=0x7f8a159faa30,_kernels=0x10d8c2030,_kerfftr=
 0x10dad1030,_kerffti=0x10ceb4030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a1597a030,_x=0x7f8a13c11540,_y=0x7f8a13c11800,_centroidgain=1,_rayleigh=
 0x7f8a148455b8,_bckgrdcalib=0x7f8a14880030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845698,_ctrlden=0x7f8a158d9b10,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595ea68,_xlast=0x7f8a15956048,_ylast=[0x7f8a13c13160,0x7f8a13c13160,
 0x7f8a13c13160],_y0=0x7f8a13c12570,_signus=0x7f8a13c133c0,_puppixoffset=[0,0],
 _nact=45,_def=0x10fe1f030,_x=0x7f8a15960328,_y=0x7f8a1595fbf0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x118f62030,_ex=0x7f8a148456d0,_ey=0x7f8a158d3a88,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15960010,_flat_command=0x0,_extrapcmat=
 0x7f8a14890a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14012fd8,_ctrlden=0x7f8a14845740,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a140132e8,_xlast=0x7f8a148459a8,_ylast=
 [0x7f8a158dfb60,0x7f8a158dfb60,0x7f8a158dfb60],_y0=0x7f8a158dfe08,_signus=
 0x7f8a158d9bb8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a158f6d60,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14013550,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158d3af8,xposition=0x7f8a14845580,yposition=
 0x7f8a14013518,dispzoom=0x7f8a140134a8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d10,layerfrac=0x7f8a15870c88,
 layerspeed=0x7f8a15870d98,layeralt=0x7f8a158df148,winddir=0x7f8a158e01c0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a158d9bb8,
 lgs_prof_alt=0x7f8a140132e8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a1595f8d8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956048,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d4b1030,_masks=0x0,_fluxpersub=0x7f8a15956258,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15956990,_skyfluxpersub=0x7f8a1595f3b0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000479749,-0.000697791],_lastvalidtt=
 [0.000479749,-0.000697791],_upttcommand=[0,0],_refmes=0x7f8a13c12b60,_tiprefv=
 0x7f8a13c16e60,_tiltrefv=0x7f8a13f561a0,_tiprefvn=0x7f8a13c13160,_tiltrefvn=
 0x7f8a13f563e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15956678,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a15979830,
 _binxy=10,_centroidw=0x7f8a158dfe08,_fimage=0x7f8a15998a30,_fimage2=0x0,
 _imistart=0x7f8a1595ff08,_imjstart=0x7f8a15956fc0,_imistart2=0x7f8a159570c8,
 _imjstart2=0x7f8a1595ea68,_unittip=0x7f8a15980230,_unittilt=0x7f8a1592c430,
 _lgs_defocuses=0x7f8a14013518,_unitdefocus=0x10d7b1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a140dae30,_flat=0x7f8a140bdc30,_domask=1,
 _submask=0x7f8a140fde30,_kernel=0x7f8a15995030,_kernels=0x10d666030,_kerfftr=
 0x10dad1030,_kerffti=0x10d863030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a140e2230,_x=0x7f8a13f55b40,_y=0x7f8a13f54e70,_centroidgain=1,_rayleigh=
 0x7f8a148457b0,_bckgrdcalib=0x7f8a140d3c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845660,_ctrlden=0x7f8a14012fd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15960220,_xlast=0x7f8a15960118,_ylast=[0x7f8a13c169c0,0x7f8a13c169c0,
 0x7f8a13c169c0],_y0=0x7f8a13c16760,_signus=0x7f8a13c16c20,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a1595fae8,_y=0x7f8a1595f1a0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a14012f30,_ey=0x7f8a14012e88,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15956468,_flat_command=0x0,_extrapcmat=
 0x7f8a1403ac30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14093990,_ctrlden=0x7f8a14093958,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a148454a0,_xlast=0x7f8a158d9c60,_ylast=
 [0x7f8a158e03e0,0x7f8a158e03e0,0x7f8a158e03e0],_y0=0x7f8a158e04f0,_signus=
 0x7f8a14013588,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14845b30,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14012ef8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a158d9b10,xposition=0x7f8a148455f0,yposition=
 0x7f8a14845628,dispzoom=0x7f8a148456d0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868e28,layerfrac=0x7ffb4c868c08,
 layerspeed=0x7ffb4c8689e8,layeralt=0x7ffb4c868c90,winddir=0x7ffb4c869158,
 _layeralt=0x7ffb4c868fc0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0cf508,
 lgs_prof_alt=0x7ffb4c0cf578,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84b108,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c01fb80,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c9b4030,_masks=0x0,_fluxpersub=0x7ffb4c155438,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c155540,_skyfluxpersub=0x7ffb4c155648,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000807999,-0.000672297],_lastvalidtt=
 [0.000807999,-0.000672297],_upttcommand=[0,0],_refmes=0x7ffb4bc3e0a0,_tiprefv=
 0x7ffb4bc42480,_tiltrefv=0x7ffb4bd1f9a0,_tiprefvn=0x7ffb4bc426c0,_tiltrefvn=
 0x7ffb4bd1fbe0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c84aef8,_jstart=0x7ffb4c84b000,_binindices=0x7ffb4c1be830,
 _binxy=10,_centroidw=0x7ffb4c869400,_fimage=0x7ffb4c14e030,_fimage2=0x0,
 _imistart=0x7ffb4c155d80,_imjstart=0x7ffb4c84b420,_imistart2=0x7ffb4c84b528,
 _imjstart2=0x7ffb4c84b630,_unittip=0x7ffb4c82d430,_unittilt=0x7ffb4c86ec30,
 _lgs_defocuses=0x7ffb4c0cfe38,_unitdefocus=0x10d271030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c17fa30,_flat=0x7ffb4c174c30,_domask=1,
 _submask=0x7ffb4c17c030,_kernel=0x7ffb4c178630,_kernels=0x10d371030,_kerfftr=
 0x10ccac030,_kerffti=0x10c871030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c13fc30,_x=0x7ffb4bc42a60,_y=0x7ffb4bc42bc0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cfe70,_bckgrdcalib=0x7ffb4c125430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c0cfa10,_ctrlden=0x7ffb4c0cff88,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c155960,_xlast=0x7ffb4c155a68,_ylast=[0x7ffb4bd1ec90,0x7ffb4bd1ec90,
 0x7ffb4bd1ec90],_y0=0x7ffb4bd1f470,_signus=0x7ffb4bd1eef0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b210,_y=0x7ffb4c155750,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10dc7c030,_ex=0x7ffb4c0cfa80,_ey=0x7ffb4c0cfce8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c155b70,_flat_command=0x0,_extrapcmat=
 0x7ffb4d842a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4d847878,_ctrlden=0x7ffb4c0cf3f0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cfc40,_xlast=0x7ffb4c0cf658,_ylast=
 [0x7ffb4c869b70,0x7ffb4c869b70,0x7ffb4c869b70],_y0=0x7ffb4c0d13d0,_signus=
 0x7ffb4c0cf8c0,_puppixoffset=[0,0],_nact=2,_def=0x10da9d030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cfcb0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cf540,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c89d2f8,xposition=0x7ffb4c0cf380,yposition=
 0x7ffb4c89d368,dispzoom=0x7ffb4c0cf690,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870c88,layerfrac=0x7f8a15870d98,
 layerspeed=0x7f8a15870d10,layeralt=0x7f8a158dfe08,winddir=0x7f8a158e04f0,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14012f30,
 lgs_prof_alt=0x7f8a14012e88,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15084bf0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d12f030,_masks=0x0,_fluxpersub=0x7f8a15956468,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a1595f1a0,_skyfluxpersub=0x7f8a1595fae8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000708901,-0.000301518],_lastvalidtt=
 [0.000708901,-0.000301518],_upttcommand=[0,0],_refmes=0x7f8a13e05570,_tiprefv=
 0x7f8a13c13160,_tiltrefv=0x7f8a13f54e70,_tiprefvn=0x7f8a13c14340,_tiltrefvn=
 0x7f8a13f55a20,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a1595ff08,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a140ea430,
 _binxy=10,_centroidw=0x7f8a15870af0,_fimage=0x7f8a15979830,_fimage2=0x0,
 _imistart=0x7f8a15960010,_imjstart=0x7f8a15956258,_imistart2=0x7f8a15956048,
 _imjstart2=0x7f8a1595f8d8,_unittip=0x7f8a1488ae30,_unittilt=0x7f8a1484e830,
 _lgs_defocuses=0x7f8a140134a8,_unitdefocus=0x10ce64030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a1598de30,_flat=0x7f8a15a33a30,_domask=1,
 _submask=0x7f8a15a08c30,_kernel=0x7f8a140f5230,_kernels=0x10d0ae030,_kerfftr=
 0x10d863030,_kerffti=0x10dad1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a15995030,_x=0x7f8a13f56230,_y=0x7f8a13f56390,_centroidgain=1,_rayleigh=
 0x7f8a14093a38,_bckgrdcalib=0x7f8a1597d230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14012ef8,_ctrlden=0x7f8a14012fd8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a15956eb8,_xlast=0x7f8a15960220,_ylast=[0x7f8a13e14240,0x7f8a13e14240,
 0x7f8a13e14240],_y0=0x7f8a13e13fe0,_signus=0x7f8a13e144a0,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a1595fbf0,_y=0x7f8a15960118,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d4b1030,_ex=0x7f8a14845740,_ey=0x7f8a14093a70,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a15956ca8,_flat_command=0x0,_extrapcmat=
 0x7f8a15073830,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a158d3a88,_ctrlden=0x7f8a140133c8,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a14845580,_xlast=0x7f8a14093990,_ylast=
 [0x7f8a158df258,0x7f8a158df258,0x7f8a158df258],_y0=0x7f8a15870fb8,_signus=
 0x7f8a14093aa8,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14013128,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a158d9c60,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a14093958,xposition=0x7f8a148454a0,yposition=
 0x7f8a148455b8,dispzoom=0x7f8a14013588,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868c08,layerfrac=0x7ffb4c8689e8,
 layerspeed=0x7ffb4c868e28,layeralt=0x7ffb4c869400,winddir=0x7ffb4c0d13d0,
 _layeralt=0x7ffb4c868fc0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0cfa80,
 lgs_prof_alt=0x7ffb4c0cfce8,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84aef8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c155c78,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c973030,_masks=0x0,_fluxpersub=0x7ffb4c155b70,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c155750,_skyfluxpersub=0x7ffb4c84b210,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00077367,-0.00053507],_lastvalidtt=
 [0.00077367,-0.00053507],_upttcommand=[0,0],_refmes=0x7ffb4bf07940,_tiprefv=
 0x7ffb4bd1ec90,_tiltrefv=0x7ffb4bc42290,_tiprefvn=0x7ffb4bd1f9a0,_tiltrefvn=
 0x7ffb4bc424d0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c155d80,_jstart=0x7ffb4c84b000,_binindices=0x7ffb4c146e30,
 _binxy=10,_centroidw=0x7ffb4c0d1810,_fimage=0x7ffb4c14e030,_fimage2=0x0,
 _imistart=0x7ffb4c155e88,_imjstart=0x7ffb4c155438,_imistart2=0x7ffb4c01fb80,
 _imjstart2=0x7ffb4c84b108,_unittip=0x7ffb4c8cc030,_unittilt=0x7ffb4c815430,
 _lgs_defocuses=0x7ffb4c0cfab8,_unitdefocus=0x10d2f1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c8d5230,_flat=0x7ffb4c810830,_domask=1,
 _submask=0x7ffb4c92c630,_kernel=0x7ffb4c12c630,_kernels=0x10cdaa030,_kerfftr=
 0x10cd2b030,_kerffti=0x10ccac030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c130030,_x=0x7ffb4bd0ebd0,_y=0x7ffb4bd1aac0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cfaf0,_bckgrdcalib=0x7ffb4c8ce030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4d847958,_ctrlden=0x7ffb4c0cfc08,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84aad8,_xlast=0x7ffb4c155960,_ylast=[0x7ffb4bd1fe70,0x7ffb4bd1fe70,
 0x7ffb4bd1fe70],_y0=0x7ffb4bd1f420,_signus=0x7ffb4bd1fbe0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b318,_y=0x7ffb4c155a68,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10dc2e030,_ex=0x7ffb4c0cf460,_ey=0x7ffb4c0cf968,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c84abe0,_flat_command=0x0,_extrapcmat=
 0x7ffb4c86ee30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cfee0,_ctrlden=0x7ffb4d847b50,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf818,_xlast=0x7ffb4d847878,_ylast=
 [0x7ffb4c8699d8,0x7ffb4c8699d8,0x7ffb4c8699d8],_y0=0x7ffb4c0d1a30,_signus=
 0x7ffb4c0cf9d8,_puppixoffset=[0,0],_nact=2,_def=0x10da9d030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cf850,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cf658,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cf3f0,xposition=0x7ffb4c0cfc40,yposition=
 0x7ffb4c0cf4d0,dispzoom=0x7ffb4c0cf8c0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c8689e8,layerfrac=0x7ffb4c868e28,
 layerspeed=0x7ffb4c868c08,layeralt=0x7ffb4c89fc98,winddir=0x7ffb4c0d1a30,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c8bb538,
 lgs_prof_alt=0x7ffb4d847920,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c155c78,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c84a9d0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c9b4030,_masks=0x0,_fluxpersub=0x7ffb4c155540,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84aef8,_skyfluxpersub=0x7ffb4c155960,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00101712,-0.000568743],_lastvalidtt=
 [0.00101712,-0.000568743],_upttcommand=[0,0],_refmes=0x7ffb4bd05c60,_tiprefv=
 0x7ffb4bd1fe60,_tiltrefv=0x7ffb4bc441a0,_tiprefvn=0x7ffb4bd30970,_tiltrefvn=
 0x7ffb4bc443e0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4d039838,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c950830,
 _binxy=10,_centroidw=0x7ffb4c869d08,_fimage=0x7ffb4c828030,_fimage2=0x0,
 _imistart=0x7ffb4c84b000,_imjstart=0x7ffb4c156f08,_imistart2=0x7ffb4c84b210,
 _imjstart2=0x7ffb4c84abe0,_unittip=0x7ffb4c141630,_unittilt=0x7ffb4c149a30,
 _lgs_defocuses=0x7ffb4c0cffc0,_unitdefocus=0x10cc34030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c1c8230,_flat=0x7ffb4c1c4830,_domask=1,
 _submask=0x7ffb4c12c630,_kernel=0x7ffb4c8e7430,_kernels=0x10cdaa030,_kerfftr=
 0x10cd2b030,_kerffti=0x10d2f1030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c95da30,_x=0x7ffb4bc43160,_y=0x7ffb4bc499e0,_centroidgain=1,_rayleigh=
 0x7ffb4c89d2c0,_bckgrdcalib=0x7ffb4c17d230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c0cf7a8,_ctrlden=0x7ffb4c8bb768,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84b528,_xlast=0x7ffb4c84b630,_ylast=[0x7ffb4bc447e0,0x7ffb4bc447e0,
 0x7ffb4bc447e0],_y0=0x7ffb4bc42bb0,_signus=0x7ffb4bc44a40,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c157118,_y=0x7ffb4c84aad8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4c0d0030,_ey=0x7ffb4c0cf7e0,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c157328,_flat_command=0x0,_extrapcmat=
 0x7ffb4c157630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cfb98,_ctrlden=0x7ffb4c0cfbd0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf5b0,_xlast=0x7ffb4c0cfee0,_ylast=
 [0x7ffb4c8a00d8,0x7ffb4c8a00d8,0x7ffb4c8a00d8],_y0=0x7ffb4c8a0738,_signus=
 0x7ffb4d8478b0,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c8bb7a0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4d847878,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4d847b50,xposition=0x7ffb4c0cf818,yposition=
 0x7ffb4c0cfc40,dispzoom=0x7ffb4c0cf9d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868e28,layerfrac=0x7ffb4c868c08,
 layerspeed=0x7ffb4c8689e8,layeralt=0x7ffb4c869d08,winddir=0x7ffb4c8a0738,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4c0d0030,
 lgs_prof_alt=0x7ffb4c0cf7e0,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4d039838,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4d039e68,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10dd6d030,_masks=0x0,_fluxpersub=0x7ffb4c157328,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84aad8,_skyfluxpersub=0x7ffb4c157118,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00103852,-0.000994034],_lastvalidtt=
 [0.00103852,-0.000994034],_upttcommand=[0,0],_refmes=0x7ffb4be09b40,_tiprefv=
 0x7ffb4bf062c0,_tiltrefv=0x7ffb4bc49510,_tiprefvn=0x7ffb4bf06500,_tiltrefvn=
 0x7ffb4bc49750,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c84b000,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c14e030,
 _binxy=10,_centroidw=0x7ffb4c8a0b78,_fimage=0x7ffb4c8e7430,_fimage2=0x0,
 _imistart=0x7ffb4c155e88,_imjstart=0x7ffb4c155540,_imistart2=0x7ffb4c84a9d0,
 _imjstart2=0x7ffb4c155c78,_unittip=0x7ffb4c0e8230,_unittilt=0x7ffb4c0e4a30,
 _lgs_defocuses=0x7ffb4c8bb5e0,_unitdefocus=0x10cb59030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c1bc830,_flat=0x7ffb4c1ebc30,_domask=1,
 _submask=0x7ffb4c144430,_kernel=0x7ffb4c8ce030,_kernels=0x10c8f2030,_kerfftr=
 0x10d2f1030,_kerffti=0x10cd2b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4c950830,_x=0x7ffb4bc47870,_y=0x7ffb4bc47b30,_centroidgain=1,_rayleigh=
 0x7ffb4c0cf460,_bckgrdcalib=0x7ffb4c1c0230,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c8bb8f0,_ctrlden=0x7ffb4c0cfce8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c01fb80,_xlast=0x7ffb4c84b528,_ylast=[0x7ffb4bc49990,0x7ffb4bc49990,
 0x7ffb4bc49990],_y0=0x7ffb4bc42bb0,_signus=0x7ffb4bc49bf0,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84b108,_y=0x7ffb4c84b630,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4d847958,_ey=0x7ffb4c0cfaf0,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c155438,_flat_command=0x0,_extrapcmat=
 0x7ffb4c0e8a30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cf850,_ctrlden=0x7ffb4c0cfa80,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cf6c8,_xlast=0x7ffb4c0cfb98,_ylast=
 [0x7ffb4c89fb88,0x7ffb4c89fb88,0x7ffb4c89fb88],_y0=0x7ffb4c8a02f8,_signus=
 0x7ffb4c8b87c0,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c0cfe70,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cfee0,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cfbd0,xposition=0x7ffb4c0cf5b0,yposition=
 0x7ffb4c0cff18,dispzoom=0x7ffb4d8478b0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffb4c868c08,layerfrac=0x7ffb4c8689e8,
 layerspeed=0x7ffb4c868e28,layeralt=0x7ffb4c8a0b78,winddir=0x7ffb4c8a02f8,
 _layeralt=0x7ffb4c0d15f0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffb4d847958,
 lgs_prof_alt=0x7ffb4c0cfaf0,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffb4c84b000,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffb4c84b318,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10c830030,_masks=0x0,_fluxpersub=0x7ffb4c155438,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffb4c84b630,_skyfluxpersub=0x7ffb4c84b108,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000433113,-0.00100216],_lastvalidtt=
 [0.000433113,-0.00100216],_upttcommand=[0,0],_refmes=0x7ffb4bd05df0,_tiprefv=
 0x7ffb4bc42bb0,_tiltrefv=0x7ffb4bc42290,_tiprefvn=0x7ffb4bc42880,_tiltrefvn=
 0x7ffb4bc45b10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffb4c155e88,_jstart=0x7ffb4c155d80,_binindices=0x7ffb4c8ce030,
 _binxy=10,_centroidw=0x7ffb4c8a09e0,_fimage=0x7ffb4d026c30,_fimage2=0x0,
 _imistart=0x7ffb4d039d60,_imjstart=0x7ffb4c157328,_imistart2=0x7ffb4d039e68,
 _imjstart2=0x7ffb4d039838,_unittip=0x7ffb4c808430,_unittilt=0x7ffb4c86d230,
 _lgs_defocuses=0x7ffb4c0cffc0,_unitdefocus=0x10dcd1030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffb4c982430,_flat=0x7ffb4d86f630,_domask=1,
 _submask=0x7ffb4c977830,_kernel=0x7ffb4c810830,_kernels=0x10c7af030,_kerfftr=
 0x10d2f1030,_kerffti=0x10cd2b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffb4d01fa30,_x=0x7ffb4bd0ebd0,_y=0x7ffb4bd2e1b0,_centroidgain=1,_rayleigh=
 0x7ffb4c0cf3f0,_bckgrdcalib=0x7ffb4d851030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffb4c8b87f8,_ctrlden=0x7ffb4c8bb7a0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffb4c84abe0,_xlast=0x7ffb4c01fb80,_ylast=[0x7ffb4bd1ec90,0x7ffb4bd1ec90,
 0x7ffb4bd1ec90],_y0=0x7ffb4bd1f9a0,_signus=0x7ffb4bd2f740,_puppixoffset=[0,0],
 _nact=45,_def=0x10cf2c030,_x=0x7ffb4c84aef8,_y=0x7ffb4c84b528,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10db41030,_ex=0x7ffb4c0cf7a8,_ey=0x7ffb4c0cfa10,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7ffb4c84b210,_flat_command=0x0,_extrapcmat=
 0x7ffb4c8cc630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffb4c0cf8f8,_ctrlden=0x7ffb4c0cf658,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7ffb4c0cfe38,_xlast=0x7ffb4c0cf850,_ylast=
 [0x7ffb4c8a0958,0x7ffb4c8a0958,0x7ffb4c8a0958],_y0=0x7ffb4c8a0848,_signus=
 0x7ffb4c8bb570,_puppixoffset=[0,0],_nact=2,_def=0x10daf3030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ffb4c8bb730,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffb4c0cfb98,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffb4c0cfa80,xposition=0x7ffb4c0cf6c8,yposition=
 0x7ffb4d847920,dispzoom=0x7ffb4c8b87c0,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d98,layerfrac=0x7f8a15870d10,
 layerspeed=0x7f8a15870c88,layeralt=0x7f8a15870af0,winddir=0x7f8a15870fb8,
 _layeralt=0x7f8a158e00b0)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14845740,
 lgs_prof_alt=0x7f8a14093a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a1595ff08,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956ba0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d271030,_masks=0x0,_fluxpersub=0x7f8a15956ca8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a15960118,_skyfluxpersub=0x7f8a1595fbf0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000608085,-0.000781249],_lastvalidtt=
 [0.000608085,-0.000781249],_upttcommand=[0,0],_refmes=0x7f8a13f54e70,_tiprefv=
 0x7f8a13d0de30,_tiltrefv=0x7f8a13c17320,_tiprefvn=0x7f8a13d0e070,_tiltrefvn=
 0x7f8a13c17560,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15960010,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a140c5830,
 _binxy=10,_centroidw=0x7f8a158df940,_fimage=0x7f8a15a24430,_fimage2=0x0,
 _imistart=0x7f8a15955f40,_imjstart=0x7f8a15956468,_imistart2=0x7f8a15084bf0,
 _imjstart2=0x7f8a15956678,_unittip=0x7f8a15998030,_unittilt=0x7f8a1599f430,
 _lgs_defocuses=0x7f8a14013518,_unitdefocus=0x10d063030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a159fe630,_flat=0x7f8a1598de30,_domask=1,
 _submask=0x7f8a159f3630,_kernel=0x7f8a14113830,_kernels=0x118f62030,_kerfftr=
 0x10dad1030,_kerffti=0x10d863030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a15a05a30,_x=0x7f8a13f54fb0,_y=0x7f8a13f56120,_centroidgain=1,_rayleigh=
 0x7f8a158d3af8,_bckgrdcalib=0x7f8a15a02030,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a140938e8,_ctrlden=0x7f8a14093648,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595ea68,_xlast=0x7f8a15956eb8,_ylast=[0x7f8a13f55a40,0x7f8a13f55a40,
 0x7f8a13f55a40],_y0=0x7f8a13f557e0,_signus=0x7f8a13f55e10,_puppixoffset=[0,0],
 _nact=45,_def=0x10fb5d030,_x=0x7f8a15956990,_y=0x7f8a15960220,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a14845660,_ey=0x7f8a14845820,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a159570c8,_flat_command=0x0,_extrapcmat=
 0x7f8a15976230,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a14013400,_ctrlden=0x7f8a14845a18,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a158f6c80,_xlast=0x7f8a158d3a88,_ylast=
 [0x7f8a158711d8,0x7f8a158711d8,0x7f8a158711d8],_y0=0x7f8a158dfd80,_signus=
 0x7f8a14013550,_puppixoffset=[0,0],_nact=2,_def=0x10cbfb030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14013320,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14093990,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a140133c8,xposition=0x7f8a14845580,yposition=
 0x7f8a140132e8,dispzoom=0x7f8a14093aa8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7f8a15870d98,layerfrac=0x7f8a15870d10,
 layerspeed=0x7f8a15870c88,layeralt=0x7f8a15870af0,winddir=0x7f8a15870fb8,
 _layeralt=0x7f8a158df830)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7f8a14845740,
 lgs_prof_alt=0x7f8a14093a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7f8a15956eb8,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7f8a15956150,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x10d271030,_masks=0x0,_fluxpersub=0x7f8a15956ca8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7f8a1595ff08,_skyfluxpersub=0x7f8a15960328,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00045132,-0.000505076],_lastvalidtt=
 [0.00045132,-0.000505076],_upttcommand=[0,0],_refmes=0x7f8a13d046b0,_tiprefv=
 0x7f8a13c159f0,_tiltrefv=0x7f8a13c12b10,_tiprefvn=0x7f8a13c133c0,_tiltrefvn=
 0x7f8a13c12570,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7f8a15956570,_jstart=0x7f8a1595f7d0,_binindices=0x7f8a148c1630,
 _binxy=10,_centroidw=0x7f8a158df500,_fimage=0x7f8a14117030,_fimage2=0x0,
 _imistart=0x7f8a15960220,_imjstart=0x7f8a15956258,_imistart2=0x7f8a14810908,
 _imjstart2=0x7f8a15956a98,_unittip=0x7f8a15082430,_unittilt=0x7f8a15055430,
 _lgs_defocuses=0x7f8a148457b0,_unitdefocus=0x10ce64030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7f8a159f3630,_flat=0x7f8a15a06830,_domask=1,
 _submask=0x7f8a15979830,_kernel=0x7f8a15022a30,_kernels=0x10dad1030,_kerfftr=
 0x10d8e2030,_kerffti=0x10d1a7030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7f8a140c1e30,_x=0x7f8a13e03730,_y=0x7f8a13e05540,_centroidgain=1,_rayleigh=
 0x7f8a14093878,_bckgrdcalib=0x7f8a15995630,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7f8a14845820,_ctrlden=0x7f8a140134e0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7f8a1595f1a0,_xlast=0x7f8a15956990,_ylast=[0x7f8a13c13160,0x7f8a13c13160,
 0x7f8a13c13160],_y0=0x7f8a13c15400,_signus=0x7f8a13c14060,_puppixoffset=[0,0],
 _nact=45,_def=0x1107a5030,_x=0x7f8a15956360,_y=0x7f8a1595fbf0,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile="sh6x6-if1-ext.fits",_edef=
 0x10d2df030,_ex=0x7f8a158d3a88,_ey=0x7f8a148454d8,_enact=4,_n1=60,_n2=197,
 _pupil=0x0,_command=0x7f8a1595ea68,_flat_command=0x0,_extrapcmat=
 0x7f8a1404e030,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(type=
 "tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=
 0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,
 gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7f8a158f6d60,_ctrlden=0x7f8a148454a0,
 misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=
 0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,
 nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=
 0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,
 elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,
 fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,
 0.63,0.89],_w=[0.2,0.35,0.45],_x0=0x7f8a140939c8,_xlast=0x7f8a14013400,_ylast=
 [0x7f8a158e0468,0x7f8a158e0468,0x7f8a158e0468],_y0=0x7f8a158df2e0,_signus=
 0x7f8a14845a18,_puppixoffset=[0,0],_nact=2,_def=0x10cdf8030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7f8a14012e88,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7f8a14093990,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7f8a140133c8,xposition=0x7f8a148456d0,yposition=
 0x7f8a14093760,dispzoom=0x7f8a14093aa8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077998,layerfrac=0x7ffe9d077910,
 layerspeed=0x7ffe9d077888,layeralt=0x7ffe9d077bb8,winddir=0x7ffe9d0776f0,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=0,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d863798,
 lgs_prof_alt=0x7ffe9d863760,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d896d18,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d896c10,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110799030,_masks=0x0,_fluxpersub=0x7ffe9d8963d0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d8964d8,_skyfluxpersub=0x7ffe9d8965e0,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000759772,-0.000268126],_lastvalidtt=
 [0.000759772,-0.000268126],_upttcommand=[0,0],_refmes=0x7ffe9bf09640,_tiprefv=
 0x7ffe9bc40630,_tiltrefv=0x7ffe9bc40870,_tiprefvn=0x7ffe9bc40af0,_tiltrefvn=
 0x7ffe9bc410b0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9d895b90,_jstart=0x7ffe9d895c98,_binindices=0x7ffe9c14e630,
 _binxy=10,_centroidw=0x7ffe9d84e278,_fimage=0x7ffe9d0c4230,_fimage2=0x0,
 _imistart=0x7ffe9d895980,_imjstart=0x7ffe9d8960b8,_imistart2=0x7ffe9d8961c0,
 _imjstart2=0x7ffe9d8962c8,_unittip=0x7ffe9c0e5230,_unittilt=0x7ffe9c157430,
 _lgs_defocuses=0x7ffe9d8667b0,_unitdefocus=0x104358030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9c847a30,_flat=0x7ffe9c826430,_domask=1,
 _submask=0x7ffe9c80aa30,_kernel=0x7ffe9c175230,_kernels=0x104f7a030,_kerfftr=
 0x104467030,_kerffti=0x110656030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9d0f8a30,_x=0x7ffe9bc415b0,_y=0x7ffe9bc41870,_centroidgain=1,_rayleigh=
 0x7ffe9d8667e8,_bckgrdcalib=0x7ffe9c81dc30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866a18,_ctrlden=0x7ffe9d8639c8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d8967f0,_xlast=0x7ffe9d041048,_ylast=[0x7ffe9bd0dcc0,0x7ffe9bd0dcc0,
 0x7ffe9bd0dcc0],_y0=0x7ffe9bd0e6b0,_signus=0x7ffe9bd08970,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d896e20,_y=0x7ffe9d895ea8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bc42030,_indext=0x7ffe9d84e300,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x104200030,_ex=0x7ffe9d863b50,_ey=0x7ffe9d863a70,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d895fb0,_flat_command=0x0,
 _extrapcmat=0x7ffe9c10c230,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d8404f8,_ctrlden=
 0x7ffe9d863990,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d866510,_xlast=0x7ffe9d846698,_ylast=[0x7ffe9d84df48,0x7ffe9d84df48,
 0x7ffe9d84df48],_y0=0x7ffe9d84e388,_signus=0x7ffe9d863920,_puppixoffset=[0,0],
 _nact=2,_def=0x1114ad030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d846510,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d846660,xposition=0x7ffe9d863530,yposition=
 0x7ffe9d863680,dispzoom=0x7ffe9d8464d8,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077910,layerfrac=0x7ffe9d077888,
 layerspeed=0x7ffe9d077998,layeralt=0x7ffe9d84e278,winddir=0x7ffe9d84e388,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d863b50,
 lgs_prof_alt=0x7ffe9d863a70,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d041678,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d896a00,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110758030,_masks=0x0,_fluxpersub=0x7ffe9d041db0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d041468,_skyfluxpersub=0x7ffe9d8966e8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000376457,2.21453e-05],_lastvalidtt=
 [0.000376457,2.21453e-05],_upttcommand=[0,0],_refmes=0x7ffe9bc24c90,_tiprefv=
 0x7ffe9bc44340,_tiltrefv=0x7ffe9bc40230,_tiprefvn=0x7ffe9bc40630,_tiltrefvn=
 0x7ffe9bc40ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9c80a308,_jstart=0x7ffe9d041ca8,_binindices=0x7ffe9c826430,
 _binxy=10,_centroidw=0x7ffe9d84dec0,_fimage=0x7ffe9c86f830,_fimage2=0x0,
 _imistart=0x7ffe9d0424e8,_imjstart=0x7ffe9d041888,_imistart2=0x7ffe9d041150,
 _imjstart2=0x7ffe9d0420c8,_unittip=0x7ffe9c81aa30,_unittilt=0x7ffe9c83e630,
 _lgs_defocuses=0x7ffe9d8665b8,_unitdefocus=0x104efa030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9c8c8e30,_flat=0x7ffe9c868430,_domask=1,
 _submask=0x7ffe9c864a30,_kernel=0x7ffe9c861030,_kernels=0x104296030,_kerfftr=
 0x1044e6030,_kerffti=0x104467030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9c847a30,_x=0x7ffe9bd08470,_y=0x7ffe9bd08730,_centroidgain=1,_rayleigh=
 0x7ffe9d8465b8,_bckgrdcalib=0x7ffe9c86be30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866468,_ctrlden=0x7ffe9d8635a0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d041a98,_xlast=0x7ffe9d896c10,_ylast=[0x7ffe9bf1bad0,0x7ffe9bf1bad0,
 0x7ffe9bf1bad0],_y0=0x7ffe9bf1c820,_signus=0x7ffe9bf1ac60,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d895c98,_y=0x7ffe9d896b08,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bc41f60,_indext=0x7ffe9d84de38,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x1041b2030,_ex=0x7ffe9d866858,_ey=0x7ffe9d863958,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d041570,_flat_command=0x0,
 _extrapcmat=0x7ffe9c855630,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d863c30,_ctrlden=
 0x7ffe9d866938,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d863728,_xlast=0x7ffe9d8404f8,_ylast=[0x7ffe9d077800,0x7ffe9d077800,
 0x7ffe9d077800],_y0=0x7ffe9d84ec90,_signus=0x7ffe9d846660,_puppixoffset=[0,0],
 _nact=2,_def=0x104db8030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d846698,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d863990,xposition=0x7ffe9d866510,yposition=
 0x7ffe9d866820,dispzoom=0x7ffe9d863920,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ffe9d077888,layerfrac=0x7ffe9d077998,
 layerspeed=0x7ffe9d077910,layeralt=0x7ffe9d84dec0,winddir=0x7ffe9d84ec90,
 _layeralt=0x7ffe9d077090)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=1,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ffe9d866858,
 lgs_prof_alt=0x7ffe9d863958,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ffe9d041048,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ffe9d895980,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x110615030,_masks=0x0,_fluxpersub=0x7ffe9d0423e0,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ffe9d895ea8,_skyfluxpersub=0x7ffe9d897030,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000591495,-0.000439936],_lastvalidtt=
 [0.000591495,-0.000439936],_upttcommand=[0,0],_refmes=0x7ffe9bf191d0,_tiprefv=
 0x7ffe9bf1ca30,_tiltrefv=0x7ffe9bc40870,_tiprefvn=0x7ffe9bf1cc70,_tiltrefvn=
 0x7ffe9bc40ab0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ffe9d8963d0,_jstart=0x7ffe9d895da0,_binindices=0x7ffe9c834a30,
 _binxy=10,_centroidw=0x7ffe9d84e300,_fimage=0x7ffe9c188830,_fimage2=0x0,
 _imistart=0x7ffe9d041258,_imjstart=0x7ffe9d05d1f0,_imistart2=0x7ffe9d895b90,
 _imjstart2=0x7ffe9d0426f8,_unittip=0x7ffe9c83e630,_unittilt=0x7ffe9c81aa30,
 _lgs_defocuses=0x7ffe9d863bf8,_unitdefocus=0x104317030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ffe9d0d1630,_flat=0x7ffe9d0cdc30,_domask=1,
 _submask=0x7ffe9d046a30,_kernel=0x7ffe9c882c30,_kernels=0x110656030,_kerfftr=
 0x104467030,_kerffti=0x1044e6030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ffe9c129030,_x=0x7ffe9bd07bc0,_y=0x7ffe9bd07e80,_centroidgain=1,_rayleigh=
 0x7ffe9d8667e8,_bckgrdcalib=0x7ffe9d037830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ffe9d866510,_ctrlden=0x7ffe9d8668c8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d896f28,_xlast=0x7ffe9d896a00,_ylast=[0x7ffe9bf1b470,0x7ffe9bf1b470,
 0x7ffe9bf1b470],_y0=0x7ffe9bf1ef50,_signus=0x7ffe9bf1ac60,_puppixoffset=[0,0],
 _nact=45,_def=0x104768030,_x=0x7ffe9d041ca8,_y=0x7ffe9d041eb8,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7ffe9bd0db90,_indext=0x7ffe9d84e6b8,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x1041b2030,_ex=0x7ffe9d866778,_ey=0x7ffe9d8669a8,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d896e20,_flat_command=0x0,
 _extrapcmat=0x7ffe9d099030,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7ffe9d863798,_ctrlden=
 0x7ffe9d866740,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7ffe9d866548,_xlast=0x7ffe9d863c30,_ylast=[0x7ffe9d077bb8,0x7ffe9d077bb8,
 0x7ffe9d077bb8],_y0=0x7ffe9d84eaf8,_signus=0x7ffe9d863990,_puppixoffset=[0,0],
 _nact=2,_def=0x104b1e030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7ffe9d866580,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ffe9d8404f8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ffe9d866938,xposition=0x7ffe9d863728,yposition=
 0x7ffe9d863760,dispzoom=0x7ffe9d846660,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 1000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fa46c034f98,layerfrac=0x7fa46c034f10,
 layerspeed=0x7fa46c034e88,layeralt=0x7fa46c0351b8,winddir=0x7fa46c034cf0,
 _layeralt=0x7fa46b8c3898)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,skymag=0,
 filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,disjointpup=
 0,svipc=0,zeropoint=0,ncpdm=0,nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,
 rout=0x0,fieldstopdiam=0,pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,
 pyr_padding=0,pyr_mod_loc=0x0,pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,
 pixsize=0.190931,npixels=10,spotpitch=10,extfield=1.90931,pupoffset=[0,0],
 shthmethod=1,shthreshold=0,shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,
 fsname=0x0,fstop="square",fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=
 1,fracIllum=0.5,centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,
 LLT1overe2diam=0,rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fa46b8daf60,
 lgs_prof_alt=0x7fa46b8bde98,nzer=0,ndh=0,ndhfiltered=0,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fa46a84d298,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fa46a84e528,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x115e10030,_masks=0x0,_fluxpersub=0x7fa46a84d6b8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fa46a84d7c0,_skyfluxpersub=0x7fa46a84d8c8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000770909,-0.00045811],_lastvalidtt=
 [0.000770909,-0.00045811],_upttcommand=[0,0],_refmes=0x7fa46a506520,_tiprefv=
 0x7fa46a7161f0,_tiltrefv=0x7fa46a51f710,_tiprefvn=0x7fa46a716430,_tiltrefvn=
 0x7fa46a51f4d0,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fa46a84d3a0,_jstart=0x7fa46a84def8,_binindices=0x7fa46c082c30,
 _binxy=10,_centroidw=0x7fa46b8c3348,_fimage=0x7fa46b0b2e30,_fimage2=0x0,
 _imistart=0x7fa46a84e420,_imjstart=0x7fa46b906570,_imistart2=0x7fa46a811508,
 _imjstart2=0x7fa46a84d4a8,_unittip=0x7fa46a877030,_unittilt=0x7fa46a84e830,
 _lgs_defocuses=0x7fa46b8ddd80,_unitdefocus=0x10a5b2030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fa46b957230,_flat=0x7fa46b927830,_domask=1,
 _submask=0x7fa46b902430,_kernel=0x7fa46a86b430,_kernels=0x10a6b3030,_kerfftr=
 0x115d8f030,_kerffti=0x109a10030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fa46b106e30,_x=0x7fa46a413db0,_y=0x7fa46a4083c0,_centroidgain=1,_rayleigh=
 0x7fa46b8ddd10,_bckgrdcalib=0x7fa46b909430,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fa46b8db270,_ctrlden=0x7fa46b8de2c0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=
 0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,coupling=0.2,
 ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,
 nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,regtype=0x0,
 regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fa46a84d5b0,_xlast=0x7fa46a84cf80,_ylast=[0x7fa46a715c90,0x7fa46a715c90,
 0x7fa46a715c90],_y0=0x7fa46a716840,_signus=0x7fa46a7154c0,_puppixoffset=[0,0],
 _nact=45,_def=0x10a222030,_x=0x7fa46a84e000,_y=0x7fa46a84e318,_i1=0x0,_j1=0x0,
 _ei1=0x0,_ej1=0x0,_indval=0x7fa46a520720,_indext=0x7fa46b8c3700,_eiffile=
 "sh6x6-if1-ext.fits",_edef=0x10986a030,_ex=0x7fa46b8db3c0,_ey=0x7fa46b8db238,
 _enact=4,_n1=60,_n2=197,_pupil=0x0,_command=0x7fa46b906258,_flat_command=0x0,
 _extrapcmat=0x7fa46c02da30,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0),dm_struct(
 type="tiptilt",subsystem=1,virtual=0,dmfit_which=0x0,iffile="sh6x6-if2.fits",
 pitch=0,alt=0,hyst=0,push4imat=400,thresholdresp=0.3,unitpervolt=0.0005,
 maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=0x7fa46b8de1a8,_ctrlden=
 0x7fa46b8de090,misreg=[0,0],xflip=0,yflip=0,pupoffset=[0,0],disjointpup=0,
 pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=0,use_def_of=0,
 ifunrot=0,xscale=0,nelperring=0x0,angleoffset=0x0,rint=0x0,rout=0x0,
 supportRadius=0,supportOffset=0,nxact=0,pitchMargin=0,coupling=0.2,ecmatfile=
 "sh6x6-ecmat2.fits",noextrap=0,elt=0,irexp=0,irfact=0,filtertilt=0,nzer=0,
 minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=0,regtype=0x0,regmatrix=0x0,
 _alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,0.35,0.45],_x0=
 0x7fa46b8ddf40,_xlast=0x7fa46b8db3f8,_ylast=[0x7fa46b8c4910,0x7fa46b8c4910,
 0x7fa46b8c4910],_y0=0x7fa46b8c44d0,_signus=0x7fa46b8ddc68,_puppixoffset=[0,0],
 _nact=2,_def=0x10a1fc030,_x=0x0,_y=0x0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,
 _indval=0x0,_indext=0x0,_eiffile="sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=
 0x0,_enact=0,_n1=60,_n2=197,_pupil=0x0,_command=0x7fa46b8dafd0,_flat_command=
 0x0,_extrapcmat=0x0,_eltdefsize=0,_regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fa46b8bdcd8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fa46b8dad30,xposition=0x7fa46b8de0c8,yposition=
 0x7fa46b8b7d68,dispzoom=0x7fa46b8bdd80,ncpdm=0x0,_ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.469      232.7
Field Avg  1.65                     44.5   0.469      232.7
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7ff52b011420,layerfrac=0x7ff52b011398,
 layerspeed=0x7ff52b011310,layeralt=0x7ff52b011640,winddir=0x7ff52b011178,
 _layeralt=0x7ff52b0107e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7ff52c0af148,lgs_prof_alt=
 0x7ff52c0af730,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7ff52a840c10,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7ff52c148a38,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x117dfa030,_masks=0x0,_fluxpersub=0x7ff52a8402c8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7ff52a8403d0,_skyfluxpersub=0x7ff52a8404d8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00093676,8.45903e-05],_lastvalidtt=
 [0.00093676,8.45903e-05],_upttcommand=[0,0],_refmes=0x7ff52a501440,_tiprefv=
 0x7ff52a704520,_tiltrefv=0x7ff52a631610,_tiprefvn=0x7ff52a704760,_tiltrefvn=
 0x7ff52a631850,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7ff52a83fb90,_jstart=0x7ff52a83fc98,_binindices=0x7ff52c0fa630,
 _binxy=10,_centroidw=0x7ff52a917348,_fimage=0x7ff52aa20c30,_fimage2=0x0,
 _imistart=0x7ff52a840e20,_imjstart=0x7ff52a83fea8,_imistart2=0x7ff52a8400b8,
 _imjstart2=0x7ff52a8401c0,_unittip=0x7ff52c0b9830,_unittilt=0x7ff52c110030,
 _lgs_defocuses=0x7ff52a9065e8,_unitdefocus=0x10beb6030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7ff52aa14c30,_flat=0x7ff52c0f3430,_domask=1,
 _submask=0x7ff52c128e30,_kernel=0x7ff52c141c30,_kernels=0x10bc31030,_kerfftr=
 0x118ab5030,_kerffti=0x117cb7030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7ff52aa2ec30,_x=0x7ff52a6303c0,_y=0x7ff52a61c690,_centroidgain=1,_rayleigh=
 0x7ff52a906620,_bckgrdcalib=0x7ff52c107830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7ff52c0af538)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7ff52a906968,_ctrlden=0x7ff52a906850,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7ff52c148b40,_xlast=0x7ff52a8406e8,_ylast=[0x7ff52a44c440,
 0x7ff52a44c440,0x7ff52a44c440],_y0=0x7ff52a44b9e0,_signus=0x7ff52a44c100,
 _puppixoffset=[0,0],_nact=45,_def=0x10b7cc030,_x=0x7ff52a840d18,_y=
 0x7ff52a83ffb0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7ff52a44bd90,
 _indext=0x7ff52a917788,_eiffile="sh6x6-if1-ext.fits",_edef=0x117bf5030,_ex=
 0x7ff52a905f50,_ey=0x7ff52a905ea8,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7ff52a8405e0,_flat_command=0x0,_extrapcmat=0x7ff52a96c630,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7ff52a9066c8,_ctrlden=0x7ff52a9069a0,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7ff52c0af500,_xlast=0x7ff52a906348,_ylast=
 [0x7ff52a9173d0,0x7ff52a9173d0,0x7ff52a9173d0],_y0=0x7ff52a917810,_signus=
 0x7ff52c0af768,_puppixoffset=[0,0],_nact=2,_def=0x118ddd030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7ff52a906578,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7ff52a8f0588,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7ff52c0af4c8,xposition=0x7ff52c0b3e10,yposition=
 0x7ff52c0c1950,xspeed=0x0,yspeed=0x0,dispzoom=0x7ff52a8f0630,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=1000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=1,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fedfd051910,layerfrac=0x7fedfd051a20,
 layerspeed=0x7fedfd051888,layeralt=0x7fedfc84dd40,winddir=0x7fedfc84e758,
 _layeralt=0x7fedfc84da10)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fedfc866aa0,lgs_prof_alt=
 0x7fedfc866d40,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fedfc1e7688,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fedfc1e7058,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x1022e4030,_masks=0x0,_fluxpersub=0x7fedfd083ae8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fedfd0836c8,_skyfluxpersub=0x7fedfd084010,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00061392,-0.000956741],_lastvalidtt=
 [0.00061392,-0.000956741],_upttcommand=[0,0],_refmes=0x7fedfbc36410,_tiprefv=
 0x7fedfbc36a40,_tiltrefv=0x7fedfbe3d970,_tiprefvn=0x7fedfbc36c80,_tiltrefvn=
 0x7fedfbe4ba10,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fedfd0835c0,_jstart=0x7fedfd0831a0,_binindices=0x7fedfd0d7430,
 _binxy=10,_centroidw=0x7fedfc84df60,_fimage=0x7fedfd0dbe30,_fimage2=0x0,
 _imistart=0x7fedfd083f08,_imjstart=0x7fedfd084430,_imistart2=0x7fedfc1e7580,
 _imjstart2=0x7fedfc1e6f50,_unittip=0x7fedfc04e030,_unittilt=0x7fedfc168630,
 _lgs_defocuses=0x7fedfc8401c0,_unitdefocus=0x102515030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fedfd0e2230,_flat=0x7fedfc125c30,_domask=1,
 _submask=0x7fedfc179c30,_kernel=0x7fedfd0c3e30,_kernels=0x102615030,_kerfftr=
 0x102347030,_kerffti=0x10281b030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fedfd0d0230,_x=0x7fedfbc352c0,_y=0x7fedfbc2e590,_centroidgain=1,_rayleigh=
 0x7fedfc845f00,_bckgrdcalib=0x7fedfc118a30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fedfc866e20)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fedfc866ec8,_ctrlden=0x7fedfc8667c0,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fedfd083e00,_xlast=0x7fedfc1e7370,_ylast=[0x7fedfbe42720,
 0x7fedfbe42720,0x7fedfbe42720],_y0=0x7fedfbe45270,_signus=0x7fedfbe4b540,
 _puppixoffset=[0,0],_nact=45,_def=0x105767030,_x=0x7fedfd083098,_y=
 0x7fedfc1e7160,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fedfbc35780,
 _indext=0x7fedfc84d7f0,_eiffile="sh6x6-if1-ext.fits",_edef=0x102787030,_ex=
 0x7fedfc866d78,_ey=0x7fedfc866db0,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fedfc1e6c38,_flat_command=0x0,_extrapcmat=0x7fedfc88b630,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fedfc866de8,_ctrlden=0x7fedfc846130,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fedfc866c28,_xlast=0x7fedfc866b48,_ylast=
 [0x7fedfc84dba8,0x7fedfc84dba8,0x7fedfc84dba8],_y0=0x7fedfc84d6e0,_signus=
 0x7fedfc866718,_puppixoffset=[0,0],_nact=2,_def=0x101dea030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fedfc83c7c0,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fedfc866c98,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fedfc8460f8,xposition=0x7fedfc866670,yposition=
 0x7fedfc866f70,xspeed=0x0,yspeed=0x0,dispzoom=0x7fedfc866bb8,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fedfd051888,layerfrac=0x7fedfd051910,
 layerspeed=0x7fedfd051a20,layeralt=0x7fedfc84d7f0,winddir=0x7fedfd051228,
 _layeralt=0x7fedfc84da10)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fedfc866b48,lgs_prof_alt=
 0x7fedfc866d40,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fedfc1e7fd0,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fedfd084010,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x1023e9030,_masks=0x0,_fluxpersub=0x7fedfd0832a8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fedfc1e7478,_skyfluxpersub=0x7fedfd084328,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.00109655,-0.000205848],_lastvalidtt=
 [0.00109655,-0.000205848],_upttcommand=[0,0],_refmes=0x7fedfbc3b160,_tiprefv=
 0x7fedfbd08b70,_tiltrefv=0x7fedfbd0e650,_tiprefvn=0x7fedfbd0e890,_tiltrefvn=
 0x7fedfbd0ee50,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fedfd0835c0,_jstart=0x7fedfd084430,_binindices=0x7fedfc118a30,
 _binxy=10,_centroidw=0x7fedfc84dba8,_fimage=0x7fedfd0c3e30,_fimage2=0x0,
 _imistart=0x7fedfc1e7aa8,_imjstart=0x7fedfd084220,_imistart2=0x7fedfd083ae8,
 _imjstart2=0x7fedfc1e81e0,_unittip=0x7fedfd0d7830,_unittilt=0x7fedfd0f8630,
 _lgs_defocuses=0x7fedfc866750,_unitdefocus=0x102515030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fedfc130a30,_flat=0x7fedfc12d030,_domask=1,
 _submask=0x7fedfc1e8e30,_kernel=0x7fedfc129630,_kernels=0x10281b030,_kerfftr=
 0x102695030,_kerffti=0x102595030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fedfd0ebc30,_x=0x7fedfbe4bc90,_y=0x7fedfbe4dfa0,_centroidgain=1,_rayleigh=
 0x7fedfc867210,_bckgrdcalib=0x7fedfc1ec830,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fedfc8667f8)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fedfc866e90,_ctrlden=0x7fedfc866718,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fedfd082a68,_xlast=0x7fedfc1e80d8,_ylast=[0x7fedfbe42720,
 0x7fedfbe42720,0x7fedfbe42720],_y0=0x7fedfbe4ba30,_signus=0x7fedfbe4be80,
 _puppixoffset=[0,0],_nact=45,_def=0x10566e030,_x=0x7fedfd083098,_y=
 0x7fedfd0833b0,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fedfbc36410,
 _indext=0x7fedfc84d988,_eiffile="sh6x6-if1-ext.fits",_edef=0x10273c030,_ex=
 0x7fedfc8670c0,_ey=0x7fedfc866f70,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fedfc1e7688,_flat_command=0x0,_extrapcmat=0x7fedfd0d8e30,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fedfc845f00,_ctrlden=0x7fedfc866c60,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fedfc866b80,_xlast=0x7fedfc867050,_ylast=
 [0x7fedfc84e758,0x7fedfc84e758,0x7fedfc84e758],_y0=0x7fedfc84e538,_signus=
 0x7fedfc866f00,_puppixoffset=[0,0],_nact=2,_def=0x101d38030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fedfc867130,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fedfc866d78,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fedfc866fa8,xposition=0x7fedfc8672b8,yposition=
 0x7fedfc846130,xspeed=0x0,yspeed=0x0,dispzoom=0x7fedfc867398,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
WFS# |     Pixel sizes        | Subaperture size | Numb of pixels | #photons
      | Desired Quantum Actual | Max  Actual Extd | Desired Actual | /sub/iter
 1      0.1909  0.0318  0.1909   2.04  1.91  1.91   10x10   10x10    70721.4
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations
=============================
SH6x6 w/ TT mirror and WFS, full diffraction WFS
 
Summary:
Mirror #1, stackarray, 45 actuators, conjugated @ 0 m
Mirror #2, tiptilt, 2 actuators, conjugated @ 0 m
WFS # 1, hartmann (meth. 2), 32 subap., offaxis (+0.0",+0.0"), noise enabled
D/r0 (500nm) = 42.4; 5000 iterations

         lambda   XPos   YPos  FWHM[mas]  Strehl  E50d[mas]
Star# 1     1.65    0.0   0.0       44.5   0.450      242.8
Field Avg  1.65                     44.5   0.450      242.8
Field rms  1.65                      0.0   0.000        0.0

Average images written in sh6x6-imav.fits
Some other graphics in sh6x6.ps

Original parameter file: sh6x6.par:
 // YAO parameter file
 //-------------------------------
 sim.name           = "SH6x6 w/ TT mirror and WFS, full diffraction WFS";
 sim.pupildiam      = 120;
 sim.debug          = 0;
 sim.verbose        = 0;
 
 //-------------------------------
 atm.dr0at05mic     = 42.44;  // this is r0=0.166 at 550 nm
 atm.screen	    = &("~/.yorick/data/screen"+["1","2","3","4"]+".fits");
 atm.layerfrac      = &([0.4,0.2,0.3,0.1]);
 atm.layerspeed     = &([11.,20,29,35]);
 atm.layeralt	    = &([0.,400,6000,9000]);
 atm.winddir        = &([0,0,0,0]);
 
 //-------------------------------
 nwfs               = 1; // number of WFSs (>1 if e.g. mcao)
 wfs = array(wfss,nwfs);
 
 n   = 1;
 wfs(n).type	   = "hartmann";
 wfs(n).lambda	   = 0.65;
 wfs(n).gspos       = [0.,0.];
 wfs(n).gsalt       = 0.;
 wfs(n).gsmag       = 5.;
 wfs(n).shmethod	   = 2;
 wfs(n).shnxsub	   = 6;
 wfs(n).pixsize     = 0.2;
 wfs(n).npixels     = 10;
 wfs(n).noise       = 1;
 wfs(n).ron         = 3.5;
 wfs(n).shthreshold = 0.;
 wfs(n).nintegcycles= 1;
 
 //-------------------------------
 ndm                = 2;
 dm = array(dms,ndm);
 
 n  =1;
 dm(n).type	   = "stackarray";
 dm(n).iffile	   = "";
 dm(n).nxact	   = 7;
 dm(n).pitch	   = 20;
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.01;
 dm(n).push4imat    = 100;
 
 n  =2;
 dm(n).type	   = "tiptilt";
 dm(n).iffile	   = "";
 dm(n).alt          = 0.;
 dm(n).unitpervolt   = 0.0005;
 dm(n).push4imat    = 400;
 
 //-------------------------------
 mat.condition      = &([15.]);
 mat.file	   = "";
 
 //-------------------------------
 tel.diam	   = 7.9;
 tel.cobs	   = 0.1125;
 
 //-------------------------------
 target.lambda	   = &([1.65]);
 target.xposition   = &([0.]);
 target.yposition   = &([0]);
 target.dispzoom    = &([1.]);
 
 //-------------------------------
 gs.zeropoint	   = 1e11;
 
 //-------------------------------
 loop.gain	   = 0.6;
 loop.framedelay    = 1;
 loop.niter	   = 5000;
 loop.ittime	   = 2e-3;
 loop.startskip     = 10;
 loop.skipevery     = 10000;
 loop.skipby        = 10000;
 loop.modalgainfile = "simulModeGains.fits";
 
 //-------------------------------
 
==== dump of structures ====
 sim_struct(name="SH6x6 w/ TT mirror and WFS, full diffraction WFS",pupildiam=
 120,pupilapod=0,debug=0,verbose=0,svipc=0,svipc_wfs_nfork=0,svipc_wfs_forknb=
 0x0,shmkey=0,semkey=0,_size=256,_cent=128.5)
 atm_struct(dr0at05mic=42.44,screen=0x7fee59873310,layerfrac=0x7fee59873288,
 layerspeed=0x7fee59873398,layeralt=0x7fee598728f8,winddir=0x7fee59873200,
 _layeralt=0x7fee598727e8)
 [wfs_struct(type="hartmann",subsystem=1,lambda=0.65,noise=1,ron=3.5,
 darkcurrent=0,excessnoise=1,gspos=[0,0],gsalt=0,gsdepth=0,laserpower=0,gsmag=5,
 skymag=0,filtertilt=0,correctUpTT=0,uplinkgain=0,dispzoom=1,optthroughput=1,
 disjointpup=0,svipc=0,zeropoint=0,ncpdm=0,dmnotinpath=0x0,framedelay=-1,
 nsubperring=0x0,angleoffset=0x0,l=0,rint=0x0,rout=0x0,fieldstopdiam=0,
 pyr_mod_ampl=0,pyr_mod_npts=0,pyr_mod_pos=0x0,pyr_padding=0,pyr_mod_loc=0x0,
 pyr_denom=0x0,shmethod=2,shnxsub=6,npixpersub=0,pixsize=0.190931,npixels=10,
 spotpitch=10,extfield=1.90931,pupoffset=[0,0],shthmethod=1,shthreshold=0,
 shcalibseeing=0.667,biasrmserror=0,flatrmserror=0,fsname=0x0,fstop="square",
 fssize=1.90931,fsoffset=[0,0],kernel=0,nintegcycles=1,fracIllum=0.5,
 centGainOpt=0,LLTxy=[0,0],LLT_uplink_turb=0,LLTr0=0,LLTdiam=0,LLT1overe2diam=0,
 rayleighflag=0,lgs_focus_alt=0,lgs_prof_amp=0x7fee5916bdb8,lgs_prof_alt=
 0x7fee5916b800,nzer=0,ndh=0,ndhfiltered=0,_framedelay=1,_initkernels=0,
 _svipc_init_done=0,_svipc_subok=0x7fee591fc620,_fork_subs=0x0,_fork_subs2=0x0,
 _validsubs=0x7fee591fb9c0,_origpixsize=0.2,_rebinfactor=6,_gsalt=0,_gsdepth=0,
 _nsub=32,_nsub4disp=36,_nmes=64,_sind=0x0,_nsind=0x0,_cxdef=0x0,_sxdef=0x0,
 _tiltsh=0x11e5d9030,_masks=0x0,_fluxpersub=0x7fee591fb8b8,_rayleighflux=0x0,
 _sodiumflux=0x0,_raylfluxpersub=0x7fee591fbac8,_skyfluxpersub=0x7fee591fbcd8,
 _nphotons=70721.4,_skynphotons=0,_tt=[0.000724527,-0.000834329],_lastvalidtt=
 [0.000724527,-0.000834329],_upttcommand=[0,0],_refmes=0x7fee58f029d0,_tiprefv=
 0x7fee58f06760,_tiltrefv=0x7fee58c56d70,_tiprefvn=0x7fee58f03fc0,_tiltrefvn=
 0x7fee58c5cb20,_reordervec=0x0,_npixels=10,_npb=0,_sdim=64,_nx=60,_nx4fft=60,
 _istart=0x7fee591fbbd0,_jstart=0x7fee591fc410,_binindices=0x7fee598f9e30,
 _binxy=10,_centroidw=0x7fee591541e8,_fimage=0x7fee59901630,_fimage2=0x0,
 _imistart=0x7fee591fc200,_imjstart=0x7fee591fc830,_imistart2=0x7fee591fc518,
 _imjstart2=0x7fee591fc0f8,_unittip=0x7fee59278030,_unittilt=0x7fee59278830,
 _lgs_defocuses=0x7fee5916b8a8,_unitdefocus=0x10f11a030,_fimnx=60,_fimny=60,
 _fimny2=0x0,_yoffset=0x0,_bias=0x7fee59928e30,_flat=0x7fee5991e230,_domask=1,
 _submask=0x7fee5991a830,_kernel=0x7fee59916e30,_kernels=0x10f3ac030,_kerfftr=
 0x10eccf030,_kerffti=0x1125dd030,_kernelconv=0,_cyclecounter=1,_dispimage=
 0x7fee59908830,_x=0x7fee58c57370,_y=0x7fee58c57630,_centroidgain=1,_rayleigh=
 0x7fee5914c3a0,_bckgrdcalib=0x7fee59921c30,_bckgrdinit=0,_bckgrdsub=1,
 _meashist=0x0,_zeropoint=1e+11,_pha2dhc=0x0,_wpha2dhc=0x0,_n12=[0,0],_LLT_use=
 0,_LLT_pscreen_name=0x0,_LLT_pscreen=0x0,_LLT_pos=[0,0],_LLT_pupil=0x0,
 _LLT_phase=0x0,_LLT_kernel=0x0,_nkernels=1,_dmnotinpath=0x7fee5916bfb0)]
 [dm_struct(type="stackarray",subsystem=1,virtual=0,dmfit_which=0x0,iffile=
 "sh6x6-if1.fits",pitch=20,alt=0,hyst=0,push4imat=100,thresholdresp=0.3,
 unitpervolt=0.01,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,_ctrlnum=
 0x7fee5914c0c8,_ctrlden=0x7fee5916bfe8,misreg=[0,0],xflip=0,yflip=0,pupoffset=
 [0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,ncpfit_which=
 0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,angleoffset=
 0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=7,pitchMargin=0,
 coupling=0.2,ecmatfile="sh6x6-ecmat1.fits",noextrap=0,elt=0,irexp=0,irfact=0,
 filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,regparam=1e-05,
 regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],_w=[0.2,
 0.35,0.45],_x0=0x7fee591fb5a0,_xlast=0x7fee591fbff0,_ylast=[0x7fee58c56fb0,
 0x7fee58c56fb0,0x7fee58c56fb0],_y0=0x7fee58c564a0,_signus=0x7fee58c50a70,
 _puppixoffset=[0,0],_nact=45,_def=0x114227030,_x=0x7fee591fb498,_y=
 0x7fee591fbee8,_i1=0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x7fee58f04200,
 _indext=0x7fee59153748,_eiffile="sh6x6-if1-ext.fits",_edef=0x10eee9030,_ex=
 0x7fee5916c330,_ey=0x7fee5916c250,_enact=4,_n1=60,_n2=197,_pupil=0x0,_command=
 0x7fee591fb180,_flat_command=0x0,_extrapcmat=0x7fee598b8030,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0),dm_struct(type="tiptilt",subsystem=1,virtual=0,
 dmfit_which=0x0,iffile="sh6x6-if2.fits",pitch=0,alt=0,hyst=0,push4imat=400,
 thresholdresp=0.3,unitpervolt=0.0005,maxvolt=0,gain=1,ctrlnum=0x0,ctrlden=0x0,
 _ctrlnum=0x7fee5916b790,_ctrlden=0x7fee591429c0,misreg=[0,0],xflip=0,yflip=0,
 pupoffset=[0,0],disjointpup=0,pegged=0x0,epegged=0x0,ncp=0,ncpfit_type=0x0,
 ncpfit_which=0,use_def_of=0,ifunrot=0,xscale=0,actlocfile=0x0,nelperring=0x0,
 angleoffset=0x0,rint=0x0,rout=0x0,supportRadius=0,supportOffset=0,nxact=0,
 pitchMargin=0,coupling=0.2,ecmatfile="sh6x6-ecmat2.fits",noextrap=0,elt=0,
 irexp=0,irfact=0,filtertilt=0,nzer=0,minzer=1,ndh=0,nkl=0,nxseg=0,fradius=0,
 regparam=0,regtype=0x0,regmatrix=0x0,_alpha=[0.01,0.2,4],_beta=[0.4,0.63,0.89],
 _w=[0.2,0.35,0.45],_x0=0x7fee5916bd48,_xlast=0x7fee5914c218,_ylast=
 [0x7fee59154408,0x7fee59154408,0x7fee59154408],_y0=0x7fee59154518,_signus=
 0x7fee5916c448,_puppixoffset=[0,0],_nact=2,_def=0x10f03a030,_x=0x0,_y=0x0,_i1=
 0x0,_j1=0x0,_ei1=0x0,_ej1=0x0,_indval=0x0,_indext=0x0,_eiffile=
 "sh6x6-if2-ext.fits",_edef=0x0,_ex=0x0,_ey=0x0,_enact=0,_n1=60,_n2=197,_pupil=
 0x0,_command=0x7fee5914c100,_flat_command=0x0,_extrapcmat=0x0,_eltdefsize=0,
 _regmatrix=0x0,_fMat=0x0)]
 mat_struct(method="svd",condition=0x7fee5916c2f8,sparse_MR=10000,sparse_MN=
 200000,sparse_thresh=1e-08,sparse_pcgtol=1e-06,file="sh6x6-mat.fits",
 fit_simple=0,fit_subsamp=1,fit_type="target",fit_which=1,fit_minval=0.01)
 tel_struct(diam=7.9,cobs=0.1125,tipvib_white_rms=0,tipvib_1overf_rms=0,
 tipvib_peaks=0x0,tipvib_peaks_rms=0x0,tipvib_peaks_width=0x0,tiltvib_white_rms=
 0,tiltvib_1overf_rms=0,tiltvib_peaks=0x0,tiltvib_peaks_rms=0x0,
 tiltvib_peaks_width=0x0)
 target_struct(lambda=0x7fee5914c2f8,xposition=0x7fee5914c410,yposition=
 0x7fee5916bd80,xspeed=0x0,yspeed=0x0,dispzoom=0x7fee5916c480,ncpdm=0x0,
 _ntarget=1,_nlambda=1)
 gs_struct(zeropoint=1e+11,zenithangle=0,lgsreturnperwatt=0)
 loop_struct(gain=0.6,leak=0,gainho=0x0,leakho=0x0,framedelay=1,niter=5000,
 ittime=0.002,startskip=10,skipevery=10000,skipby=10000,stats_every=4,
 jumps2swapscreen=0,modalgainfile="simulModeGains.fits",method="closed-loop")
